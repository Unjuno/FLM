# FLM - 完全タスクリスト（ロール別）

## 📋 エージェントロール定義

| ロールID | ロール名 | 略称 | 主な担当領域 |
|---------|---------|------|------------|
| **ARCH** | アーキテクト/設計エージェント | アーキテクト | アーキテクチャ設計、技術選定、インターフェース定義 |
| **FE** | フロントエンド開発エージェント | フロントエンド | React/TypeScript UI実装、IPCクライアント実装 |
| **BE** | バックエンド開発エージェント | バックエンド | Rust/Tauri実装、プロセス管理、IPCサーバー実装 |
| **DB** | データベースエージェント | データベース | SQLite設計・実装、Repository実装、マイグレーション |
| **AUTH** | 認証・セキュリティエージェント | 認証 | 認証プロキシ実装、APIキー管理、セキュリティ機能 |
| **QA** | テスト・品質保証エージェント | QA | テスト実装・実行、品質チェック、コードレビュー |
| **DOC** | ドキュメントエージェント | ドキュメント | ドキュメント作成、UX検証、ユーザーガイド |

---

## 📋 使用方法

### タスク選択方法

1. **自分のロールを確認**: どのエージェントロールで作業するか確認
2. **推奨ロールのタスクを優先**: 自分のロールに合ったタスクを選択
3. **ステータス確認**: `🟡 未着手` または `⏸️ 保留中` のタスクを確認
4. **依存関係確認**: 依存タスクが完了しているか確認
5. **ステータス更新**: 作業開始時に `🟡 未着手` → `🔵 作業中` に変更し、担当エージェント名を記載

### ステータス凡例

- 🟡 **未着手**: まだ誰も着手していない
- 🔵 **作業中**: 現在エージェントが実装中（エージェント名を記載: 例 `🔵 作業中 - FE-001`）
- ✅ **完了**: 実装完了、マージ待ち
- ⚠️ **問題発生**: 実装中に問題が発生（詳細を記載）
- ⏸️ **保留中**: 依存関係により一時保留
- 🟢 **レビュー済み**: コードレビュー完了、マージ済み

---

## 🎯 v1.1実装タスク

### F006: ログ表示機能の完全実装

#### バックエンド・基盤実装タスク

---

##### BE-006-01: IPCコマンド拡張（フィルタ機能）
- **タスクID**: BE-006-01
- **推奨ロール**: **BE** (バックエンド) + **DB** (データベース)
- **ファイル**: `src-tauri/src/commands/api.rs`
- **タスク**: `get_request_logs`コマンドに日時範囲・ステータスコードフィルタを追加
- **実装内容**:
  - `GetRequestLogsRequest`構造体にフィルタフィールド追加
    - `start_date`: Option<String>
    - `end_date`: Option<String>
    - `status_codes`: Option<Vec<i32>>
    - `path_filter`: Option<String>
  - SQLクエリにWHERE条件追加（DBエージェントと協力）
  - エラーハンドリング追加
  - `src-tauri/src/lib.rs`にコマンド登録確認
- **依存関係**: なし（既存コマンドの拡張）
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: BE + DB
- **メモ**: `RequestLogRepository::find_with_filters`メソッド実装済み。`get_request_logs`コマンドでフィルタ機能が使用可能

---

##### BE-006-02: ログ統計情報取得IPCコマンド実装
- **タスクID**: BE-006-02
- **推奨ロール**: **BE** (バックエンド) + **DB** (データベース)
- **ファイル**: `src-tauri/src/commands/api.rs`（新規関数追加）
- **タスク**: ログ統計情報を取得するIPCコマンドを実装
- **実装内容**:
  - 新規コマンド: `get_log_statistics(api_id: String, start_date: Option<String>, end_date: Option<String>)`
  - レスポンス構造:
    ```rust
    struct LogStatistics {
        total_requests: i64,
        avg_response_time_ms: f64,
        error_rate: f64,
        status_code_distribution: Vec<(i32, i64)>,
    }
    ```
  - SQL集計クエリ実装（COUNT, AVG, GROUP BY等）
  - `src-tauri/src/lib.rs`にコマンド登録
- **依存関係**: なし
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: BE + DB
- **メモ**: RequestLogRepository::get_statisticsメソッド実装済み（総リクエスト数、平均レスポンス時間、エラー率、ステータスコード分布）。IPCコマンドget_log_statistics実装済み。lib.rsに登録済み。

---

##### BE-006-03: データベースクエリ最適化
- **タスクID**: BE-006-03
- **推奨ロール**: **DB** (データベース)
- **ファイル**: 
  - `src-tauri/src/database/repository.rs`
  - `src-tauri/src/database/schema.rs`（インデックス追加の場合）
- **タスク**: 大量ログ対応のためのクエリ最適化
- **実装内容**:
  - 既存インデックスの確認（`idx_request_logs_api_id`, `idx_request_logs_created_at`等）
  - 必要に応じてインデックス追加
  - LIMIT/OFFSET パフォーマンス確認
  - EXPLAIN QUERY PLANで最適化確認
  - クエリ実行時間の測定・記録
- **依存関係**: BE-006-01完了後推奨（フィルタクエリの最適化）
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: DB
- **メモ**: `idx_request_logs_response_status`と`idx_request_logs_path`インデックスを追加済み。フィルタクエリのパフォーマンス向上。既存のインデックス（`idx_request_logs_api_id`, `idx_request_logs_created_at`, `idx_request_logs_api_created`）も確認済み。

---

#### フロントエンド実装タスク

---

##### FE-006-01: ログ一覧ページ基本実装
- **タスクID**: FE-006-01
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/pages/ApiLogs.tsx` (新規作成)
  - `src/pages/ApiLogs.css` (新規作成)
- **タスク**: ログ一覧ページの基本UI実装
- **実装内容**:
  - API選択ドロップダウン（`get_api_details` IPCコマンド使用）
  - ログ一覧テーブル（ID、メソッド、パス、ステータス、レスポンス時間、日時）
  - ページネーション（20件/ページ）
  - ローディング状態表示
  - エラー状態表示
  - `get_request_logs` IPCコマンド呼び出し
- **依存関係**: BE-006-01完了推奨（現状のIPCコマンドでも可）
- **推定工数**: 4-5時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: ApiLogs.tsx、ApiLogs.cssを作成。ルーティングも追加済み。

---

##### FE-006-02: ログフィルタコンポーネント実装
- **タスクID**: FE-006-02
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/LogFilter.tsx` (新規作成)
  - `src/components/api/LogFilter.css` (新規作成)
- **タスク**: ログフィルタUIコンポーネント実装
- **実装内容**:
  - 日時範囲選択（開始日時・終了日時、DatePicker推奨）
  - ステータスコードマルチ選択（200, 400, 500等、チェックボックス）
  - パス検索テキストボックス
  - エラーのみ表示トグル
  - フィルタリセットボタン
  - フィルタ状態の管理（React State）
- **依存関係**: FE-006-01完了推奨（独立実装も可）
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: LogFilter.tsx、LogFilter.cssを作成。フィルタ状態管理とコールバック実装済み。

---

##### FE-006-03: ログ詳細表示コンポーネント実装
- **タスクID**: FE-006-03
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/LogDetail.tsx` (新規作成)
  - `src/components/api/LogDetail.css` (新規作成)
- **タスク**: ログ詳細表示モーダル/サイドパネル実装
- **実装内容**:
  - モーダルまたはサイドパネル表示（既存の`ModelDetailModal.tsx`を参考）
  - リクエスト情報表示:
    - メソッド、パス、ヘッダー（将来的）、ボディ
  - レスポンス情報表示:
    - ステータスコード、レスポンス時間、エラーメッセージ、ボディ
  - JSONビューワー（構文ハイライト、`react-syntax-highlighter`推奨）
  - コピーボタン（リクエスト/レスポンスボディ）
  - 閉じるボタン
- **依存関係**: FE-006-01完了推奨
- **推定工数**: 4-5時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: LogDetail.tsx、LogDetail.cssを作成。ApiLogs.tsxに統合済み。ログ行をクリックで詳細表示。

---

##### FE-006-04: ログ統計情報コンポーネント実装
- **タスクID**: FE-006-04
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/LogStatistics.tsx` (新規作成)
  - `src/components/api/LogStatistics.css` (新規作成)
- **タスク**: ログ統計情報表示コンポーネント実装
- **実装内容**:
  - 統計サマリーカード表示:
    - リクエスト総数
    - 平均レスポンス時間（ms）
    - エラー率（%）
  - ステータスコード分布グラフ（棒グラフまたは円グラフ、`recharts`使用）
  - `get_log_statistics` IPCコマンド呼び出し
  - リアルタイム更新（30秒間隔、useEffect + setInterval）
- **依存関係**: BE-006-02完了必須、FE-006-01完了推奨
- **推定工数**: 4-5時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: LogStatistics.tsxとLogStatistics.cssを作成済み。rechartsを使用して棒グラフと円グラフを実装。`get_log_statistics` IPCコマンド呼び出し実装済み。

---

##### FE-006-05: ログ一覧ページへのフィルタ・統計統合
- **タスクID**: FE-006-05
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: `src/pages/ApiLogs.tsx` (拡張)
- **タスク**: FE-006-02、FE-006-04をApiLogsページに統合
- **実装内容**:
  - ログフィルタコンポーネントの配置（ページ上部）
  - 統計情報コンポーネントの配置（ページ上部またはサイドバー）
  - フィルタ状態の管理（useState）
  - フィルタ変更時のログ再取得（useEffect依存配列にフィルタ状態追加）
  - レイアウト調整（CSS GridまたはFlexbox）
- **依存関係**: FE-006-01、FE-006-02、FE-006-04完了必須
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: フィルタと統計の連携を実装（フィルタ変更時に統計も更新）。ApiLogs.tsxにLogFilterとLogStatisticsコンポーネントを統合済み。

---

##### FE-006-06: リアルタイム更新機能実装
- **タスクID**: FE-006-06
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: `src/pages/ApiLogs.tsx` (拡張)
- **タスク**: ログ一覧の自動更新（ポーリング）実装
- **実装内容**:
  - useEffectでポーリング実装（30秒間隔、または設定可能）
  - 新規ログのハイライト表示（アニメーション）
  - ポーリング停止/再開トグル（ユーザー操作可能）
  - メモリリーク対策（クリーンアップ関数実装）
  - ページが非表示の場合はポーリング停止（visibility API使用）
- **依存関係**: FE-006-01完了必須
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: ポーリング機能、自動更新トグル、visibility API統合を実装完了。

---

##### FE-006-07: ルーティング追加
- **タスクID**: FE-006-07
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: `src/App.tsx` (拡張)
- **タスク**: ログ表示ページへのルート追加
- **実装内容**:
  - `/logs` ルート追加
  - `ApiLogs`コンポーネントのインポート
  - ナビゲーションメニューに「ログ」リンク追加（必要に応じて、`Home.tsx`等）
- **依存関係**: FE-006-01完了推奨
- **推定工数**: 30分
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: App.tsxに`/logs`ルートとApiLogsコンポーネントのインポートを追加済み。

---

#### テストタスク

---

##### TEST-006-01: ログ表示機能のバックエンドテスト
- **タスクID**: TEST-006-01
- **推奨ロール**: **QA** (テスト) + **BE** (バックエンド)
- **ファイル**: `tests/integration/f006-log-display.test.ts` (新規作成)
- **タスク**: ログ取得・フィルタ・統計の統合テスト
- **実装内容**:
  - `get_request_logs`のテスト（フィルタ有無）
    - API ID指定テスト
    - フィルタ無しテスト
    - 日時範囲フィルタテスト
    - ステータスコードフィルタテスト
    - パスフィルタテスト
  - `get_log_statistics`のテスト
    - 統計情報取得テスト
    - 日時範囲指定テスト
    - エッジケーステスト（ログ0件、大量ログ等）
  - エラーハンドリングテスト
- **依存関係**: BE-006-01、BE-006-02完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: QA
- **メモ**: f006-log-display.test.tsを作成済み。get_request_logsの基本機能テスト（limit/offset、API IDフィルタ）、フィルタ機能テスト（日付範囲、ステータスコード、パス）、get_log_statisticsテスト（統計情報取得、日時範囲指定、エラー率計算）、エッジケーステスト（ログなしAPI、無効なAPI ID、大量データ）を実装済み。

---

##### TEST-006-02: ログ表示機能のE2Eテスト
- **タスクID**: TEST-006-02
- **推奨ロール**: **QA** (テスト) + **FE** (フロントエンド)
- **ファイル**: `tests/e2e/f006-logs-display.test.ts` (新規作成)
- **タスク**: ログ表示UIのE2Eテスト
- **実装内容**:
  - ログ一覧表示テスト
    - ページ読み込み
    - API選択
    - ログ一覧表示確認
  - フィルタ機能テスト
    - 日時範囲フィルタ
    - ステータスコードフィルタ
    - パス検索フィルタ
  - 詳細表示テスト
    - ログクリック
    - モーダル表示
    - 詳細情報表示確認
  - 統計情報表示テスト
    - 統計サマリー表示確認
    - グラフ表示確認
  - ページネーションテスト
  - リアルタイム更新テスト（オプション）
- **依存関係**: FE-006-01～FE-006-07完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: QA
- **メモ**: f006-logs-display.test.tsを作成済み。ログ一覧表示フロー（ページネーション、ソート）、フィルタ機能フロー（ステータスコード、日付範囲、パス、複数フィルタ組み合わせ）、詳細表示フロー、統計情報表示フロー、完全なフロー（ログ一覧→フィルタ→詳細表示→統計表示）を実装済み。TauriアプリケーションのE2Eテストとして、IPCコマンドを使用した完全なフローテストを実装。

---

### F007: パフォーマンス監視機能の完全実装

#### バックエンド・基盤実装タスク

---

##### BE-007-01: パフォーマンスメトリクステーブル作成
- **タスクID**: BE-007-01
- **推奨ロール**: **DB** (データベース) + **ARCH** (アーキテクト)
- **ファイル**: 
  - `src-tauri/src/database/schema.rs` (拡張)
  - `src-tauri/src/database/migrations.rs` (新規または拡張)
- **タスク**: `performance_metrics`テーブルとインデックス作成
- **実装内容**:
  - テーブル定義:
    ```sql
    CREATE TABLE IF NOT EXISTS performance_metrics (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        api_id TEXT NOT NULL,
        metric_type TEXT NOT NULL,
        value REAL NOT NULL,
        timestamp TEXT NOT NULL,
        FOREIGN KEY (api_id) REFERENCES apis(id) ON DELETE CASCADE
    );
    ```
  - インデックス作成:
    - `idx_performance_metrics_api_id`
    - `idx_performance_metrics_timestamp`
    - `idx_performance_metrics_api_type_timestamp`
  - マイグレーション実装（既存データベースへの適用）
  - マイグレーション実行確認
- **依存関係**: なし
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: DB + ARCH
- **メモ**: schema.rsに`performance_metrics`テーブルと3つのインデックスを実装済み。CREATE TABLE IF NOT EXISTSを使用して既存データベースにも適用可能。
- **メモ**: ARCHエージェントはスキーマ設計を確認、DBエージェントは実装

---

##### BE-007-02: パフォーマンスメトリクスRepository実装
- **タスクID**: BE-007-02
- **推奨ロール**: **DB** (データベース) + **BE** (バックエンド)
- **ファイル**: `src-tauri/src/database/repository.rs` (拡張)
- **タスク**: `PerformanceMetricRepository`実装
- **実装内容**:
  - `PerformanceMetric`構造体定義（`models.rs`にも追加）
  - Repository実装:
    - `create` メソッド（メトリクス記録）
    - `find_by_api_id` メソッド（API別メトリクス取得）
    - `find_by_api_id_and_type` メソッド（タイプ別取得）
    - `find_by_api_id_and_range` メソッド（時系列範囲指定取得）
    - `delete_old_metrics` メソッド（古いメトリクス削除、オプション、30日以上古いデータ等）
  - エラーハンドリング実装
  - ユニットテスト実装（オプション）
- **依存関係**: BE-007-01完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: DB + BE
- **メモ**: repository.rsに`PerformanceMetricRepository`を実装済み。全メソッド（create、find_by_api_id、find_by_api_id_and_type、find_by_api_id_and_range）を実装。`params_from_iter`を使用してパラメータバインディングを実装。

---

##### BE-007-03: パフォーマンス監視IPCコマンド実装
- **タスクID**: BE-007-03
- **推奨ロール**: **BE** (バックエンド) + **DB** (データベース)
- **ファイル**: `src-tauri/src/commands/performance.rs` (新規作成)
- **タスク**: パフォーマンス監視関連IPCコマンド実装
- **実装内容**:
  - `record_performance_metric` コマンド
    - リクエスト: `{ api_id: String, metric_type: String, value: f64 }`
    - バリデーション（metric_type: "request_count", "avg_response_time", "error_rate", "cpu_usage", "memory_usage"）
    - `PerformanceMetricRepository`を使用して保存
  - `get_performance_metrics` コマンド
    - リクエスト: `{ api_id: String, metric_type: Option<String>, start_date: Option<String>, end_date: Option<String> }`
    - レスポンス: `Vec<PerformanceMetricInfo>`
  - `get_performance_summary` コマンド
    - リクエスト: `{ api_id: String, period: String }` (period: "1h", "24h", "7d")
    - レスポンス: 統計サマリー（平均値、最大値、最小値等）
  - `src-tauri/src/lib.rs`にコマンド登録
  - `src-tauri/src/commands/mod.rs`にモジュール追加（必要に応じて）
- **依存関係**: BE-007-02完了必須
- **推定工数**: 4-5時間
- **ステータス**: ✅ 完了
- **担当エージェント**: BE + DB
- **メモ**: performance.rsを作成し、3つのIPCコマンド（record_performance_metric、get_performance_metrics、get_performance_summary）を実装済み。lib.rsにコマンド登録済み。

---

##### BE-007-04: 認証プロキシでのメトリクス収集実装
- **タスクID**: BE-007-04
- **推奨ロール**: **AUTH** (認証) + **BE** (バックエンド)
- **ファイル**: `src/backend/auth/server.ts` (拡張)
- **タスク**: リクエストごとのメトリクス収集・送信実装
- **実装内容**:
  - レスポンス時間記録（リクエスト開始〜終了、`Date.now()`使用）
  - CPU使用率監視（Node.jsプロセス、`process.cpuUsage()`使用）
  - メモリ使用量監視（`process.memoryUsage()`使用）
  - メトリクスの一時保存（メモリ内、1分間隔で集計）
  - メトリクスのバックエンドへの送信（データベース直接保存、`savePerformanceMetric`呼び出し）
  - バッチ送信実装（1分間隔でまとめて送信、パフォーマンス向上）
  - エラーハンドリング（保存失敗時の処理）
- **依存関係**: BE-007-03完了必須
- **推定工数**: 4-5時間
- **ステータス**: ✅ 完了
- **担当エージェント**: AUTH
- **メモ**: `server.ts`に`collectPerformanceMetrics`関数と`flushMetricsBuffer`関数を実装。メモリ内バッファ（`metricBuffers`）にメトリクスを蓄積し、1分間隔で集計（平均値、合計値など）して`savePerformanceMetric`経由でデータベースに保存。バッチ送信でパフォーマンス向上を実現。

---

#### フロントエンド実装タスク

---

##### FE-007-01: グラフライブラリ導入
- **タスクID**: FE-007-01
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: `package.json` (更新)
- **タスク**: `recharts`ライブラリのインストール
- **実装内容**:
  - `npm install recharts` 実行
  - 型定義確認（`@types/recharts`必要に応じてインストール）
  - `package-lock.json`更新確認
  - 簡単なテスト実装（動作確認、オプション）
- **依存関係**: なし
- **推定工数**: 30分
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: package.jsonにrechartsを追加済み。`npm install`を実行してインストールしてください。

---

##### FE-007-02: パフォーマンスダッシュボード基本実装
- **タスクID**: FE-007-02
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/pages/PerformanceDashboard.tsx` (新規作成)
  - `src/pages/PerformanceDashboard.css` (新規作成)
- **タスク**: パフォーマンスダッシュボードページ基本実装
- **実装内容**:
  - API選択ドロップダウン（`list_apis` IPCコマンド使用）
  - 期間選択（1時間、24時間、7日間、ドロップダウン）
  - ローディング状態表示
  - エラー状態表示
  - レイアウト構造（CSS Grid推奨）
  - `get_performance_metrics` IPCコマンド呼び出し（実装確認）
- **依存関係**: BE-007-03完了推奨、FE-007-01完了推奨
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: 基本的な構造のみ、グラフは後で追加。PerformanceDashboard.tsx、PerformanceDashboard.cssを作成。API選択、期間選択、基本レイアウト実装済み。

---

##### FE-007-03: レスポンス時間グラフコンポーネント実装
- **タスクID**: FE-007-03
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/ResponseTimeChart.tsx` (新規作成)
  - `src/components/api/ResponseTimeChart.css` (新規作成)
- **タスク**: レスポンス時間の時系列グラフ実装
- **実装内容**:
  - Line Chart実装（`recharts`の`LineChart`使用）
  - X軸: 時間（`timestamp`、フォーマット: HH:mm）
  - Y軸: レスポンス時間（ms）
  - データポイントホバー表示（Tooltip）
  - `get_performance_metrics` IPCコマンド呼び出し（metric_type: "avg_response_time"）
  - リアルタイム更新（30秒間隔、useEffect + setInterval）
  - ローディング状態表示
- **依存関係**: FE-007-01完了必須、BE-007-03完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: `recharts`のドキュメントを参照、レスポンシブ対応。ResponseTimeChart.tsx、ResponseTimeChart.cssを作成。リアルタイム更新機能実装済み。

---

##### FE-007-04: リクエスト数グラフコンポーネント実装
- **タスクID**: FE-007-04
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/RequestCountChart.tsx` (新規作成)
  - `src/components/api/RequestCountChart.css` (新規作成)
- **タスク**: リクエスト数の時系列グラフ実装
- **実装内容**:
  - Line Chart実装（`recharts`の`LineChart`使用）
  - X軸: 時間（`timestamp`）
  - Y軸: リクエスト数（/分）
  - `get_performance_metrics` IPCコマンド呼び出し（metric_type: "request_count"）
  - リアルタイム更新（30秒間隔）
  - ローディング状態表示
- **依存関係**: FE-007-01完了必須、BE-007-03完了必須
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: RequestCountChart.tsxとRequestCountChart.cssを作成済み。rechartsのLineChartを使用してリクエスト数の時系列グラフを実装。1分単位での集計（グループ化）と自動更新機能（30秒間隔）、統計情報表示（総リクエスト数、平均/分、最大/分）を実装済み。

---

##### FE-007-05: CPU/メモリ使用量グラフコンポーネント実装
- **タスクID**: FE-007-05
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/ResourceUsageChart.tsx` (新規作成)
  - `src/components/api/ResourceUsageChart.css` (新規作成)
- **タスク**: CPU/メモリ使用量の時系列グラフ実装
- **実装内容**:
  - Line Chart実装（2系列: CPU、メモリ）
  - X軸: 時間（`timestamp`）
  - Y軸: CPU使用率（%）、メモリ（MB）
  - 凡例表示（Legend）
  - `get_performance_metrics` IPCコマンド呼び出し（metric_type: "cpu_usage", "memory_usage"）
  - リアルタイム更新（30秒間隔）
  - ローディング状態表示
- **依存関係**: FE-007-01完了必須、BE-007-03完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: ResourceUsageChart.tsxとResourceUsageChart.cssを作成済み。rechartsのLineChartを使用してCPU使用率とメモリ使用量の2系列グラフを実装。CPUとメモリで異なるY軸（左: CPU %, 右: メモリ MB）を使用し、凡例とリアルタイム更新機能（30秒間隔）、期間選択（1h/24h/7d）を実装済み。

---

##### FE-007-06: エラー率グラフコンポーネント実装
- **タスクID**: FE-007-06
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/ErrorRateChart.tsx` (新規作成)
  - `src/components/api/ErrorRateChart.css` (新規作成)
- **タスク**: エラー率の時系列グラフ実装
- **実装内容**:
  - Line Chart実装（`recharts`の`LineChart`使用）
  - X軸: 時間（`timestamp`）
  - Y軸: エラー率（%、0-100）
  - アラート閾値表示（オプション、5%以上で色変更等）
  - `get_performance_metrics` IPCコマンド呼び出し（metric_type: "error_rate"）
  - リアルタイム更新（30秒間隔）
  - ローディング状態表示
- **依存関係**: FE-007-01完了必須、BE-007-03完了必須
- **推定工数**: 2-3時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: エラー率が高い場合の視覚的強調。ErrorRateChart.tsx、ErrorRateChart.cssを作成。アラート閾値（デフォルト5%）の表示と警告メッセージ実装済み。リアルタイム更新機能実装済み。

---

##### FE-007-07: 統計サマリーカードコンポーネント実装
- **タスクID**: FE-007-07
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: 
  - `src/components/api/PerformanceSummary.tsx` (新規作成)
  - `src/components/api/PerformanceSummary.css` (新規作成)
- **タスク**: パフォーマンス統計サマリー表示
- **実装内容**:
  - カード表示（複数カード、グリッドレイアウト）:
    - 現在のリクエスト数/秒
    - 平均レスポンス時間
    - ピークレスポンス時間
    - エラー率
    - CPU使用率
    - メモリ使用量
  - `get_performance_summary` IPCコマンド呼び出し
  - リアルタイム更新（30秒間隔）
  - 数値のフォーマット（小数点、単位表示）
- **依存関係**: BE-007-03完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: 既存のコンポーネント（`InfoBanner`等）を参考に実装。PerformanceSummary.tsx、PerformanceSummary.cssを作成。6つのカードを実装。リアルタイム更新機能実装済み。

---

##### FE-007-08: ダッシュボードページへの統合
- **タスクID**: FE-007-08
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: `src/pages/PerformanceDashboard.tsx` (拡張)
- **タスク**: 各グラフコンポーネントをダッシュボードに統合
- **実装内容**:
  - レスポンス時間グラフ配置（FE-007-03）
  - リクエスト数グラフ配置（FE-007-04）
  - CPU/メモリグラフ配置（FE-007-05）
  - エラー率グラフ配置（FE-007-06）
  - 統計サマリー配置（FE-007-07）
  - レイアウト調整（CSS Grid、レスポンシブ対応）
  - グラフサイズ調整（高さ・幅）
- **依存関係**: FE-007-02～FE-007-07完了必須
- **推定工数**: 3-4時間
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: PerformanceDashboard.tsxに全てのグラフコンポーネント（ResponseTimeChart、RequestCountChart、ResourceUsageChart、ErrorRateChart）とPerformanceSummaryを統合済み。API選択、期間選択（1h/24h/7d）、レイアウト調整を実装済み。PerformanceDashboard.cssでスタイル定義済み。

---

##### FE-007-09: ルーティング追加
- **タスクID**: FE-007-09
- **推奨ロール**: **FE** (フロントエンド)
- **ファイル**: `src/App.tsx` (拡張)
- **タスク**: パフォーマンスダッシュボードページへのルート追加
- **実装内容**:
  - `/performance` ルート追加
  - `PerformanceDashboard`コンポーネントのインポート
  - ナビゲーションメニューに「パフォーマンス」リンク追加（必要に応じて、`Home.tsx`等）
- **依存関係**: FE-007-02完了推奨
- **推定工数**: 30分
- **ステータス**: ✅ 完了
- **担当エージェント**: FE
- **メモ**: 既存のルーティングパターンに従う。App.tsxに`/performance`ルートとPerformanceDashboardコンポーネントのインポートを追加済み。

---

#### テストタスク

---

##### TEST-007-01: パフォーマンス監視機能のバックエンドテスト
- **タスクID**: TEST-007-01
- **推奨ロール**: **QA** (テスト) + **BE** (バックエンド) + **DB** (データベース)
- **ファイル**: `tests/integration/performance-monitoring.test.ts` (新規作成)
- **タスク**: メトリクス記録・取得の統合テスト
- **実装内容**:
  - `record_performance_metric`のテスト
    - 正常系テスト
    - バリデーションテスト（不正なmetric_type等）
  - `get_performance_metrics`のテスト（各種フィルタ）
    - API ID指定テスト
    - metric_type指定テスト
    - 日時範囲指定テスト
    - 複合フィルタテスト
  - `get_performance_summary`のテスト
    - 各期間（1h, 24h, 7d）のテスト
    - 統計値計算の確認
  - エッジケーステスト
    - メトリクス0件
    - 大量メトリクス
    - 無効なAPI ID
- **依存関係**: BE-007-01～BE-007-03完了必須
- **推定工数**: 3-4時間
- **ステータス**: 🟡 未着手
- **担当エージェント**: -
- **メモ**: テストデータの準備とクリーンアップを実装

---

##### TEST-007-02: パフォーマンス監視機能のE2Eテスト
- **タスクID**: TEST-007-02
- **推奨ロール**: **QA** (テスト) + **FE** (フロントエンド)
- **ファイル**: `tests/e2e/performance-dashboard.test.ts` (新規作成)
- **タスク**: パフォーマンスダッシュボードUIのE2Eテスト
- **実装内容**:
  - ダッシュボード表示テスト
    - ページ読み込み
    - API選択
    - 期間選択
  - グラフ表示テスト
    - レスポンス時間グラフ表示
    - リクエスト数グラフ表示
    - CPU/メモリグラフ表示
    - エラー率グラフ表示
  - 統計サマリー表示テスト
    - 各カードの値表示確認
  - リアルタイム更新テスト（オプション）
    - 自動更新の動作確認
  - 期間選択テスト
    - 期間変更時のデータ更新確認
- **依存関係**: FE-007-01～FE-007-09完了必須
- **推定工数**: 3-4時間
- **ステータス**: 🟡 未着手
- **担当エージェント**: -
- **メモ**: 既存のE2Eテストパターンを参考に実装

---

## 📊 タスク進捗サマリー（ロール別）

### F006: ログ表示機能

| ロール | タスク数 | 未着手 | 作業中 | 完了 | レビュー済み |
|--------|---------|--------|--------|------|------------|
| BE | 2 | 2 | 0 | 0 | 0 |
| DB | 1 | 1 | 0 | 0 | 0 |
| FE | 7 | 0 | 0 | 7 | 0 |
| QA | 2 | 2 | 0 | 0 | 0 |
| **合計** | **12** | **12** | **0** | **0** | **0** |

### F007: パフォーマンス監視機能

| ロール | タスク数 | 未着手 | 作業中 | 完了 | レビュー済み |
|--------|---------|--------|--------|------|------------|
| ARCH | 1 | 1 | 0 | 0 | 0 |
| BE | 4 | 0 | 0 | 4 | 0 |
| DB | 2 | 0 | 0 | 2 | 0 |
| AUTH | 1 | 0 | 0 | 1 | 0 |
| FE | 9 | 0 | 0 | 9 | 0 |
| QA | 2 | 2 | 0 | 0 | 0 |
| **合計** | **19** | **3** | **0** | **16** | **0** |

### 全体

| 機能 | 合計タスク | 未着手 | 作業中 | 完了 | レビュー済み |
|------|-----------|--------|--------|------|------------|
| F006 | 12 | 5 | 0 | 7 | 0 |
| F007 | 19 | 3 | 0 | 16 | 0 |
| **合計** | **31** | **8** | **0** | **23** | **0** |

---

## 🔄 ロール別推奨並行作業パターン

### Phase 1: 基盤実装（並行可能）

**独立タスク（依存関係なし）**:
- **FE-007-01** (FE): グラフライブラリ導入
- **BE-007-01** (DB + ARCH): パフォーマンスメトリクステーブル作成

**並行グループ1: F006バックエンド拡張**:
- **BE-006-01** (BE + DB): IPCコマンド拡張（フィルタ機能）
- **BE-006-02** (BE + DB): ログ統計情報取得IPCコマンド実装

**並行グループ2: F007バックエンド基盤**:
- **BE-007-02** (DB + BE): パフォーマンスメトリクスRepository実装
- **BE-007-03** (BE + DB): パフォーマンス監視IPCコマンド実装

### Phase 2: フロントエンド実装（並行可能）

**並行グループ1: F006 UI実装**:
- **FE-006-01** (FE): ログ一覧ページ基本実装
- **FE-006-02** (FE): ログフィルタコンポーネント実装
- **FE-006-03** (FE): ログ詳細表示コンポーネント実装

**並行グループ2: F007 UI実装**:
- **FE-007-02** (FE): パフォーマンスダッシュボード基本実装
- **FE-007-03** (FE): レスポンス時間グラフコンポーネント実装
- **FE-007-04** (FE): リクエスト数グラフコンポーネント実装

**並行グループ3: F007 UI続き**:
- **FE-007-05** (FE): CPU/メモリ使用量グラフコンポーネント実装
- **FE-007-06** (FE): エラー率グラフコンポーネント実装
- **FE-007-07** (FE): 統計サマリーカードコンポーネント実装

### Phase 3: 統合・テスト（並行可能）

**並行グループ1: F006統合**:
- **FE-006-04** (FE): ログ統計情報コンポーネント実装
- **FE-006-05** (FE): ログ一覧ページへのフィルタ・統計統合
- **FE-006-06** (FE): リアルタイム更新機能実装
- **FE-006-07** (FE): ルーティング追加

**並行グループ2: F007統合**:
- **BE-007-04** (AUTH + BE): 認証プロキシでのメトリクス収集実装
- **FE-007-08** (FE): ダッシュボードページへの統合
- **FE-007-09** (FE): ルーティング追加

**並行グループ3: テスト**:
- **BE-006-03** (DB): データベースクエリ最適化
- **TEST-006-01** (QA + BE): ログ表示機能のバックエンドテスト
- **TEST-007-01** (QA + BE + DB): パフォーマンス監視機能のバックエンドテスト

### Phase 4: E2Eテスト（統合後）

- **TEST-006-02** (QA + FE): ログ表示機能のE2Eテスト
- **TEST-007-02** (QA + FE): パフォーマンス監視機能のE2Eテスト

---

## 🎯 ロール別タスク優先順位

### BE（バックエンド）エージェント

**最優先**:
1. BE-006-01: IPCコマンド拡張（フィルタ機能）
2. BE-006-02: ログ統計情報取得IPCコマンド実装
3. BE-007-03: パフォーマンス監視IPCコマンド実装

**次優先**:
4. BE-007-04: 認証プロキシでのメトリクス収集実装（AUTHと協力）

---

### FE（フロントエンド）エージェント

**最優先**:
1. FE-007-01: グラフライブラリ導入（最も簡単、他タスクの前提）
2. FE-006-01: ログ一覧ページ基本実装
3. FE-007-02: パフォーマンスダッシュボード基本実装

**次優先**（並行可能）:
4. FE-006-02: ログフィルタコンポーネント実装
5. FE-006-03: ログ詳細表示コンポーネント実装
6. FE-007-03: レスポンス時間グラフコンポーネント実装
7. FE-007-04: リクエスト数グラフコンポーネント実装

**統合**:
8. FE-006-04～FE-006-07: F006統合タスク
9. FE-007-05～FE-007-09: F007統合タスク

---

### DB（データベース）エージェント

**最優先**:
1. BE-007-01: パフォーマンスメトリクステーブル作成（ARCHと協力）
2. BE-007-02: パフォーマンスメトリクスRepository実装

**次優先**:
3. BE-006-01, BE-006-02: SQLクエリ実装（BEと協力）
4. BE-006-03: データベースクエリ最適化

---

### AUTH（認証）エージェント

**最優先**:
1. BE-007-04: 認証プロキシでのメトリクス収集実装（BEと協力）

---

### QA（テスト）エージェント

**最優先**（バックエンド完了後）:
1. TEST-006-01: ログ表示機能のバックエンドテスト
2. TEST-007-01: パフォーマンス監視機能のバックエンドテスト

**次優先**（フロントエンド完了後）:
3. TEST-006-02: ログ表示機能のE2Eテスト
4. TEST-007-02: パフォーマンス監視機能のE2Eテスト

---

### ARCH（アーキテクト）エージェント

**最優先**:
1. BE-007-01: パフォーマンスメトリクステーブル設計確認（DBと協力）

---

## ⚠️ 注意事項

### エージェント間の協力が必要なタスク

1. **BE + DB**: 
   - BE-006-01, BE-006-02, BE-007-02, BE-007-03
   - BEエージェントがIPCコマンド実装、DBエージェントがSQLクエリ実装

2. **BE + AUTH**: 
   - BE-007-04
   - AUTHエージェントが認証プロキシ拡張、BEエージェントがIPC連携

3. **ARCH + DB**: 
   - BE-007-01
   - ARCHエージェントがスキーマ設計確認、DBエージェントが実装

4. **QA + 実装エージェント**: 
   - すべてのTESTタスク
   - QAエージェントがテスト実装、実装エージェントがレビュー・修正

### コンフリクト回避

- **同じファイルを編集する場合**: 事前に調整し、順次実装
  - `src-tauri/src/lib.rs`: BEエージェントが統一管理
  - `src/App.tsx`: FEエージェントが統一管理

### 依存関係の確認

- タスクに着手する前に、依存タスクの完了を必ず確認
- 依存タスクのステータスが`✅ 完了`または`🟢 レビュー済み`であることを確認

---

## 📋 タスク一覧（ID順）

### F006: ログ表示機能（12タスク）

| タスクID | タスク名 | 推奨ロール | 依存関係 | 工数 |
|---------|---------|-----------|---------|------|
| BE-006-01 | IPCコマンド拡張（フィルタ機能） | BE + DB | なし | 2-3h |
| BE-006-02 | ログ統計情報取得IPCコマンド実装 | BE + DB | なし | 3-4h |
| BE-006-03 | データベースクエリ最適化 | DB | BE-006-01推奨 | 2-3h |
| FE-006-01 | ログ一覧ページ基本実装 | FE | BE-006-01推奨 | 4-5h |
| FE-006-02 | ログフィルタコンポーネント実装 | FE | FE-006-01推奨 | 3-4h |
| FE-006-03 | ログ詳細表示コンポーネント実装 | FE | FE-006-01推奨 | 4-5h |
| FE-006-04 | ログ統計情報コンポーネント実装 | FE | BE-006-02必須 | 4-5h |
| FE-006-05 | ログ一覧ページへのフィルタ・統計統合 | FE | FE-006-01,02,04必須 | 2-3h |
| FE-006-06 | リアルタイム更新機能実装 | FE | FE-006-01必須 | 2-3h |
| FE-006-07 | ルーティング追加 | FE | FE-006-01推奨 | 30min |
| TEST-006-01 | ログ表示機能のバックエンドテスト | QA + BE | BE-006-01,02必須 | 3-4h |
| TEST-006-02 | ログ表示機能のE2Eテスト | QA + FE | FE-006-01～07必須 | 3-4h |

### F007: パフォーマンス監視機能（17タスク）

| タスクID | タスク名 | 推奨ロール | 依存関係 | 工数 |
|---------|---------|-----------|---------|------|
| BE-007-01 | パフォーマンスメトリクステーブル作成 | DB + ARCH | なし | 2-3h |
| BE-007-02 | パフォーマンスメトリクスRepository実装 | DB + BE | BE-007-01必須 | 3-4h |
| BE-007-03 | パフォーマンス監視IPCコマンド実装 | BE + DB | BE-007-02必須 | 4-5h |
| BE-007-04 | 認証プロキシでのメトリクス収集実装 | AUTH + BE | BE-007-03必須 | 4-5h |
| FE-007-01 | グラフライブラリ導入 | FE | なし | 30min |
| FE-007-02 | パフォーマンスダッシュボード基本実装 | FE | BE-007-03推奨 | 3-4h |
| FE-007-03 | レスポンス時間グラフコンポーネント実装 | FE | FE-007-01,BE-007-03必須 | 3-4h |
| FE-007-04 | リクエスト数グラフコンポーネント実装 | FE | FE-007-01,BE-007-03必須 | 2-3h |
| FE-007-05 | CPU/メモリ使用量グラフコンポーネント実装 | FE | FE-007-01,BE-007-03必須 | 3-4h |
| FE-007-06 | エラー率グラフコンポーネント実装 | FE | FE-007-01,BE-007-03必須 | 2-3h |
| FE-007-07 | 統計サマリーカードコンポーネント実装 | FE | BE-007-03必須 | 3-4h |
| FE-007-08 | ダッシュボードページへの統合 | FE | FE-007-02～07必須 | 3-4h |
| FE-007-09 | ルーティング追加 | FE | FE-007-02推奨 | 30min |
| TEST-007-01 | パフォーマンス監視機能のバックエンドテスト | QA + BE + DB | BE-007-01～03必須 | 3-4h |
| TEST-007-02 | パフォーマンス監視機能のE2Eテスト | QA + FE | FE-007-01～09必須 | 3-4h |

---

**最終更新**: 2024年（完全版作成）  
**作成者**: アーキテクトエージェント (ARCH)

