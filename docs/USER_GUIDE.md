# FLM - ユーザーガイド

**インストール方法が知りたい場合**: [インストールガイド](./INSTALLATION_GUIDE.md)を参照してください。

## フェーズ4: ドキュメントエージェント (DOC) 実装

このガイドは、FLMアプリケーションの使い方を説明します。技術的な知識がなくても、このガイドに従ってAPIを作成・利用できます。

---

## 目次

1. [はじめに](#はじめに)
2. [初回起動](#初回起動)
3. [APIの作成](#apiの作成)
4. [APIの利用](#apiの利用)
5. [APIの管理](#apiの管理)
6. [モデルの管理](#モデルの管理)
7. [よくある質問（FAQ）](#よくある質問faq)
8. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

FLMは、技術知識がなくても、コードを書かずに、ローカルLLMのAPIを作成・利用できるデスクトップアプリケーションです。

### FLMでできること

- **APIの作成**: Ollamaモデルを使ってAPIを作成
- **APIの利用**: 作成したAPIをOpenAI互換の形式で利用
- **モデルの管理**: Ollamaモデルの検索・ダウンロード・削除
- **認証機能**: APIキーによる認証（オプション）

---

## 初回起動

### 1. アプリケーションの起動

FLMアプリケーションを起動すると、最初にOllamaの状態を確認します。

### 2. Ollamaのセットアップ

Ollamaがインストールされていない場合、以下のいずれかが行われます：

- **自動ダウンロード**: FLMが自動的にOllamaをダウンロードします（推奨）
- **手動インストール**: 既にインストールされているOllamaを使用

#### 自動ダウンロードの場合

1. 「Ollamaをダウンロード」ボタンをクリック
2. ダウンロード進捗が表示されます
3. ダウンロード完了後、自動的にOllamaが起動されます

#### 手動インストールの場合

- システムパスにOllamaがインストールされている場合、自動的に検出されます

---

## APIの作成

### ステップ1: モデル選択

1. ホーム画面で「新しいAPIを作成」ボタンをクリック
2. 使用したいモデルを選択します
   - **推奨モデル**: 初心者におすすめのモデルがハイライト表示されます
   - **モデル情報**: 各モデルのサイズ、パラメータ数、説明が表示されます
3. 「次へ」ボタンをクリック

### ステップ2: API設定

1. **API名**: APIの名前を入力（デフォルト: "LocalAI API"）
2. **ポート番号**: ポート番号を入力（デフォルト: 8080）
   - 注意: 他のアプリケーションが使用していないポート番号を選択してください
3. **認証設定**: APIキーによる認証を有効にするか選択
   - 認証を有効にすると、APIキーが生成されます
4. 「作成」ボタンをクリック

### ステップ3: API作成の確認

1. API作成処理が開始されます
   - Ollamaの確認
   - 設定の保存
   - 認証プロキシの起動
2. 処理が完了すると、成功画面が表示されます
3. **APIエンドポイント**と**APIキー**（認証が有効な場合）が表示されます
   - 重要: APIキーは作成時のみ表示されます。安全な場所に保存してください

---

## APIの利用

### API一覧画面

1. ホーム画面またはメニューから「API一覧」を選択
2. 作成済みのAPI一覧が表示されます
   - API名
   - ステータス（実行中/停止中）
   - エンドポイントURL

### APIの起動・停止

1. API一覧で、起動したいAPIの「起動」ボタンをクリック
2. ステータスが「実行中」に変わります
3. 停止する場合は「停止」ボタンをクリック

### APIのテスト

1. API一覧で「テスト」ボタンをクリック
2. チャットインターフェースが開きます
3. プロンプトを入力して「送信」ボタンをクリック
4. レスポンスが表示されます
   - レスポンス内容
   - トークン数
   - タイムスタンプ

### API情報の確認

1. API一覧で「詳細」ボタンをクリック
2. 以下の情報が表示されます：
   - **エンドポイントURL**: APIのエンドポイント
   - **APIキー**: 認証が有効な場合（表示/非表示切り替え可能）
   - **サンプルコード**: curl、Python、JavaScriptのサンプルコード
   - **コピー機能**: エンドポイントやAPIキーをクリップボードにコピー

---

## APIの管理

### 設定の変更

1. API一覧で「設定変更」ボタンをクリック
2. 以下の設定を変更できます：
   - **API名**: APIの名前
   - **ポート番号**: ポート番号（変更後は再起動が必要）
   - **認証設定**: 認証の有効/無効
3. 「保存」ボタンをクリック

### APIキーの再生成

1. 設定変更画面で「APIキーを再生成」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. 新しいAPIキーが表示されます
   - 重要: 新しいAPIキーは今回のみ表示されます。安全な場所に保存してください
   - 注意: 古いAPIキーは無効になります

### APIの削除

1. API一覧で「削除」ボタンをクリック
2. 確認ダイアログで削除を確認
3. APIと関連するリソース（APIキーなど）が削除されます
   - 注意: 実行中のAPIは停止してから削除されます

---

## モデルの管理

### モデル検索・ダウンロード

1. メニューから「モデル管理」を選択
2. モデル検索画面で以下を設定できます：
   - **検索バー**: モデル名で検索
   - **カテゴリフィルタ**: チャット、コード生成、翻訳など
   - **サイズフィルタ**: 小、中、大
   - **用途フィルタ**: 汎用、専門用途
   - **ソート**: 人気順、サイズ順、名前順
3. ダウンロードしたいモデルを選択
4. 「ダウンロード」ボタンをクリック
5. 確認ダイアログでサイズを確認して「OK」をクリック
6. ダウンロード進捗が表示されます：
   - プログレスバー
   - パーセンテージ
   - ダウンロード速度
   - 残り時間

### インストール済みモデル一覧

1. モデル管理画面で「インストール済みモデル」タブを選択
2. インストール済みのモデル一覧が表示されます：
   - モデル名
   - サイズ
   - インストール日時
   - 使用状況
3. 各モデルで以下の操作が可能：
   - **API作成に使用**: API作成画面で使用するモデルとして選択
   - **削除**: モデルを削除（ストレージを解放）

---

## よくある質問（FAQ）

### Q1: APIキーを忘れてしまいました

A: APIキーを再生成してください。設定変更画面で「APIキーを再生成」ボタンをクリックします。古いAPIキーは無効になります。

### Q2: ポート番号は何を選べばいいですか？

A: デフォルトの8080で問題ありません。他のアプリケーションが使用している場合は、8081、8082などの別のポート番号を選択してください。

### Q3: どのモデルを選べばいいですか？

A: 初心者の方は、推奨モデルを選択することをおすすめします。用途に応じて以下のように選択できます：
- **チャット**: 汎用的な会話に適したモデル
- **コード生成**: プログラミングに適したモデル
- **翻訳**: 多言語対応に適したモデル

### Q4: APIが起動しません

A: 以下の点を確認してください：
- Ollamaが起動しているか
- ポート番号が他のアプリケーションで使用されていないか
- エラーメッセージを確認

### Q5: モデルのダウンロードが遅いです

A: モデルのサイズによってダウンロード時間は異なります。大きなモデル（8B以上）は数時間かかる場合があります。進捗画面でダウンロード速度と残り時間を確認できます。

---

## トラブルシューティング

### Ollamaが起動しない

**症状**: Ollamaの自動起動に失敗する

**解決方法**:
1. Ollamaが手動で起動できるか確認
2. アプリケーションを再起動
3. Ollamaを手動で起動してからFLMを使用

**エラーメッセージ**: 「Ollamaが実行されていません。先にOllamaを起動してください。」

---

### APIキーが表示されない

**症状**: API作成後、APIキーが表示されない

**解決方法**:
1. 認証設定が有効になっているか確認
2. API詳細画面で「表示」ボタンをクリック
3. APIキーが表示されない場合は、再生成を試す

---

### ポート番号エラー

**症状**: 「ポート番号が既に使用されています」というエラー

**解決方法**:
1. 他のアプリケーションがそのポートを使用していないか確認
2. 別のポート番号を選択（例: 8081, 8082）
3. 設定変更画面でポート番号を変更

---

### モデルのダウンロードが失敗する

**症状**: モデルのダウンロードが途中で失敗する

**解決方法**:
1. インターネット接続を確認
2. 十分なストレージ容量があるか確認
3. ダウンロードを再試行
4. 別のモデルを試す

---

### データベースエラー

**症状**: 「データベース接続エラー」が表示される

**解決方法**:
1. アプリケーションを再起動
2. アプリケーションデータディレクトリのアクセス権限を確認
3. 問題が解決しない場合、アプリケーションを再インストール（既存のデータは削除されます）

---

## サポート

問題が解決しない場合は、以下を参照してください：

- [トラブルシューティングガイド](./TROUBLESHOOTING.md): より詳細なトラブルシューティング情報
- [FAQ](./FAQ.md): よくある質問と回答
- [GitHub Issues](https://github.com/your-repo/issues): バグ報告・機能要望

---

## 次のステップ

APIを作成したら、以下を試してみてください：

1. **APIをテスト**: チャットインターフェースでAPIをテスト
2. **外部アプリケーションで使用**: APIエンドポイントとAPIキーを使用して、他のアプリケーションからAPIに接続
3. **複数のAPIを作成**: 異なるモデルで複数のAPIを作成して比較

---

**お楽しみください！FLMでローカルLLMのAPIを作成・利用しましょう！**

