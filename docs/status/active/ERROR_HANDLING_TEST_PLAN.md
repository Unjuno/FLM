# エラーハンドリングテスト計画

> Updated: 2025-02-01 | Status: Planning

## 目的

`unwrap()`/`expect()`が使用されている箇所のエラーケースをテストし、適切なエラーハンドリングが実装されていることを確認する。

## 調査が必要な箇所

### flm-proxy
- `middleware.rs`: 認証、レート制限、IPブロックなどのエラーハンドリング
- `controller.rs`: プロキシ起動/停止、設定読み込みなどのエラーハンドリング
- `adapters.rs`: データベース操作のエラーハンドリング

### flm-cli
- CLIコマンドのエラーハンドリング
- 設定ファイル読み込みのエラーハンドリング

## テストすべきエラーケース

### 1. データベースエラー
- データベース接続失敗
- クエリ実行失敗
- トランザクション失敗
- データベースロック

### 2. ネットワークエラー
- 接続タイムアウト
- 接続拒否
- DNS解決失敗
- SSL/TLSエラー

### 3. 設定エラー
- 無効な設定値
- 欠落している設定
- 設定ファイル読み込み失敗

### 4. 認証エラー
- 無効なAPIキー
- 期限切れAPIキー
- リボークされたAPIキー

### 5. リソースエラー
- メモリ不足
- ファイルシステムエラー
- ポート競合

## 実装方針

1. 既存のエラーハンドリングを確認
2. `unwrap()`/`expect()`の使用箇所を特定
3. 各箇所でエラーケースのテストを追加
4. エラーメッセージとログの確認

## 参考

- `docs/status/active/TEST_PROGRESS_SUMMARY.md` - テスト進捗サマリー

