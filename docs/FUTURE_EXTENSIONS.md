# 将来の拡張計画

この文書は、FLMプロジェクトの将来の拡張計画とロードマップを説明します。

---

## 目次

1. [バージョンロードマップ](#バージョンロードマップ)
2. [機能拡張計画](#機能拡張計画)
3. [技術的拡張計画](#技術的拡張計画)
4. [プラットフォーム拡張計画](#プラットフォーム拡張計画)
5. [パフォーマンス改善計画](#パフォーマンス改善計画)

---

## バージョンロードマップ

### v1.0 (現在)

**完了機能**:
- ✅ F001: API作成機能
- ✅ F002: API利用機能
- ✅ F003: API管理機能
- ✅ F004: モデル管理機能（基本機能）
- ✅ F005: 認証機能
- ✅ F009: Ollama自動インストール機能

**主要目標**: MVP機能の完全実装、非開発者向けの使いやすさ

---

### v1.1 (計画中)

**予定機能**:
- 🔄 F006: ログ表示機能
  - リクエストログの表示・検索・フィルタ
  - 統計情報の表示
  - エラーログの分析
- 🔄 F007: パフォーマンス監視
  - API応答時間の監視
  - リソース使用量の監視
  - パフォーマンスグラフの表示

**目標リリース**: 2024年Q2

---

### v1.2 (計画中)

**予定機能**:
- 📅 モデルカタログ機能の拡張
  - 詳細情報の取得（説明、カテゴリ、作成者、ライセンス）
  - 定期的なモデルカタログの更新（日次または週次）
  - モデルの評価・レビュー機能
- 📅 バックアップ・復元機能
  - API設定のバックアップ
  - 設定のエクスポート・インポート

**目標リリース**: 2024年Q3

---

### v1.3 (計画中)

**予定機能**:
- 🔄 **複数LLM実行エンジン対応（Phase 1）**
  - 抽象化レイヤー（Trait/Interface）の実装
  - LM Studioエンジン対応
  - エンジン選択UIの実装
  - データベーススキーマの拡張（`execution_engine`カラム追加）
- 🔄 **セキュリティ強化**
  - IPホワイトリスト機能
  - レート制限機能
  - APIキーローテーション機能

**目標リリース**: 2024年Q4

---

### v2.0 (将来)

**予定機能**:
- 📅 高度な認証機能
  - OAuth 2.0対応
  - マルチユーザー対応
  - ロールベースアクセス制御（RBAC）
- 📅 リモートアクセス機能
  - クラウド経由でのAPIアクセス
  - 複数デバイス間での設定同期
- 📅 コラボレーション機能
  - チームでのAPI共有
  - コメント・アノテーション機能

**目標リリース**: 2025年

---

## 機能拡張計画

### F006: ログ表示機能

#### 要件
- リクエストログの表示（リクエストURL、メソッド、ステータスコード、レスポンス時間）
- ログの検索・フィルタ（日付、ステータスコード、エンドポイント）
- 統計情報の表示（リクエスト数、平均レスポンス時間、エラー率）
- エラーログの詳細表示

#### 実装計画
- **データベース**: `request_logs`テーブル（実装済み）
- **バックエンド**: ログ取得API（実装済み）
- **フロントエンド**: ログ表示画面の実装
- **優先度**: 高

---

### F007: パフォーマンス監視

#### 要件
- API応答時間のリアルタイム監視
- CPU/メモリ使用量の監視
- パフォーマンスグラフの表示
- アラート機能（パフォーマンス低下時）

#### 実装計画
- **データ収集**: 認証プロキシからメトリクス収集
- **データベース**: `performance_metrics`テーブル（新規作成）
- **フロントエンド**: ダッシュボード画面の実装
- **優先度**: 中

---

### モデルカタログ機能の拡張

#### 要件
- Ollama公式モデルライブラリからの詳細情報取得
  - 説明（詳細）
  - カテゴリ
  - 作成者情報
  - ライセンス情報
- 定期的な更新（日次または週次）
- モデルの評価・レビュー機能

#### 実装計画
- **データソース**: Ollama公式APIまたはウェブスクレイピング
- **スケジューラー**: バックグラウンドジョブで定期更新
- **優先度**: 中

---

### バックアップ・復元機能

#### 要件
- API設定のバックアップ
- 設定のエクスポート（JSON形式）
- 設定のインポート
- 自動バックアップ（オプション）

#### 実装計画
- **エクスポート形式**: JSON
- **インポート**: バリデーション機能を含む
- **優先度**: 低

---

### 複数LLM実行エンジン対応

#### 要件
- Ollama以外のLLM実行エンジン（LM Studio、vLLM、llama.cpp、text-generation-webui等）をサポート
- エンジン選択UI（API作成時に選択可能）
- エンジン固有の設定項目に対応
- 統一されたAPIインターフェース（OpenAI互換を維持）

#### 実装計画

**Phase 1: 基盤構築（v1.3）**
- **抽象化レイヤーの実装**: Strategy/Adapterパターンで実行エンジンを抽象化
  - `LlmEngine` Trait/Interface の定義
  - エンジン検出・起動・停止・モデル管理の統一インターフェース
- **データベーススキーマ拡張**:
  - `apis`テーブルに`execution_engine`カラム追加
  - `execution_engines`テーブル作成（エンジン情報管理）
  - `engine_config`カラム追加（JSON形式でエンジン固有設定）
- **Ollama実装のリファクタリング**: 既存コードを`LlmEngine` Trait実装に変換

**Phase 2: LM Studio対応（v1.3）**
- **LM Studioエンジン実装**:
  - プロセス検出・起動・停止機能
  - モデル一覧取得機能
  - OpenAI互換APIのプロキシ対応
- **UI拡張**: API作成画面にエンジン選択UIを追加
- **テスト**: LM Studio統合テスト

**Phase 3: その他エンジン対応（v2.0以降）**
- **vLLM対応**: 高性能推論エンジン
- **llama.cpp対応**: 軽量な推論エンジン
- **text-generation-webui対応**: WebUI経由のアクセス
- **カスタムエンドポイント対応**: 任意のOpenAI互換APIエンドポイント

#### アーキテクチャ設計

```rust
// 抽象化レイヤー（擬似コード）
#[async_trait]
pub trait LlmEngine {
    fn name(&self) -> &str;
    fn engine_type(&self) -> LlmEngineType;
    async fn detect(&self) -> Result<EngineDetectionResult>;
    async fn start(&self, config: EngineConfig) -> Result<u32>;
    async fn stop(&self) -> Result<()>;
    async fn list_models(&self) -> Result<Vec<ModelInfo>>;
    fn get_api_base_url(&self) -> String;
    fn is_openai_compatible(&self) -> bool;
}
```

#### 優先度
- **高**: ユーザーの選択肢を広げ、Ollama依存を軽減

---

## 技術的拡張計画

### パフォーマンス最適化

#### 計画
- データベースクエリの最適化
- インデックスの追加
- 接続プールの実装
- キャッシュ機能の追加

#### 優先度
- 高（v1.1以降）

---

### セキュリティ強化（v1.3以降）

#### 計画

**IPホワイトリスト機能**
- 許可されたIPアドレスのみアクセス可能にする機能
- 特定のネットワークからのみアクセスを許可
- データベースに`whitelisted_ips`カラム追加（JSON配列形式）
- UIにIPアドレス入力・管理機能を追加

**レート制限機能**
- APIキーごとのリクエストレート制限（例: 100リクエスト/分）
- IPアドレスごとのレート制限
- DDoS攻撃対策
- 設定可能なレート制限閾値

**APIキーローテーション機能**
- 定期的なAPIキーの自動ローテーション
- 手動でのAPIキー再生成
- 複数APIキーの同時保持（移行期間対応）

**監査ログ機能**
- 全てのAPI操作の記録
- アクセス履歴の保存・検索
- セキュリティイベントのアラート

#### 実装計画
- **データベース**: `api_whitelist`テーブル、`rate_limits`テーブル（新規作成）
- **バックエンド**: ミドルウェア実装（認証プロキシに統合）
- **フロントエンド**: セキュリティ設定画面の実装
- **優先度**: 中（v1.3以降）

---

### テストカバレッジ向上

#### 計画
- テストカバレッジを80%以上に向上
- E2Eテストの拡充
- パフォーマンステストの自動化
- セキュリティテストの定期実行

#### 優先度
- 高（継続的）

---

## プラットフォーム拡張計画

### macOS対応

#### 計画
- macOS向けインストーラー（.dmg）の作成
- macOS固有の機能（メニューバー統合など）
- テスト環境の構築

#### 優先度
- 中（v1.2以降）

---

### Linux対応

#### 計画
- Linux向けパッケージ（.AppImage、.deb、.rpm）の作成
- 各ディストリビューションでのテスト
- システム統合（デスクトップエントリなど）

#### 優先度
- 低（v2.0以降）

---

## パフォーマンス改善計画

### 起動時間の短縮

#### 計画
- 遅延読み込みの実装
- データベース初期化の最適化
- 不要な初期化処理の削減

#### 目標
- 起動時間を5秒以下に

---

### メモリ使用量の削減

#### 計画
- メモリリークの修正
- 不要なデータの早期解放
- キャッシュサイズの最適化

#### 目標
- メモリ使用量を100MB以下に

---

### 応答速度の向上

#### 計画
- 非同期処理の最適化
- データベースクエリの最適化
- UI更新の最適化

#### 目標
- API応答時間を1秒以内に

---

## コミュニティ・オープンソース化

### オープンソース化

#### 計画
- GitHub上での公開
- ライセンス（MIT）の明示
- コントリビューションガイドの作成
- イシュー管理の整備

#### 目標リリース
- v1.1リリース時

---

### コミュニティ機能

#### 計画
- Discord/Slackコミュニティの作成
- ドキュメントの充実
- サンプルコード・チュートリアルの提供
- ユーザーストーリーの共有

---

## 関連ドキュメント

- [アーキテクチャ設計書](../ARCHITECTURE.md): システムアーキテクチャの詳細
- [技術選定レポート](../DOCKS/TECHNOLOGY_SELECTION_REPORT.md): 技術選定の詳細
- [機能仕様書](../DOCKS/SPECIFICATION.md): 機能仕様の詳細

---

**このロードマップは、プロジェクトの成長と進化を反映して定期的に更新されます。**

