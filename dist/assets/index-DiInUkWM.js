import{r as Ne,a as Se,g as Ce,b as a,u as fe,c as ke,R as J,d as Ee,N as we,B as Pe}from"./react-vendor-B_iA_kAh.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const m of o)if(m.type==="childList")for(const u of m.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const m={};return o.integrity&&(m.integrity=o.integrity),o.referrerPolicy&&(m.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?m.credentials="include":o.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function n(o){if(o.ep)return;o.ep=!0;const m=r(o);fetch(o.href,m)}})();var se={exports:{}},G={};var ie;function Te(){if(ie)return G;ie=1;var t=Ne(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function u(f,g,y){var x,b={},P=null,N=null;y!==void 0&&(P=""+y),g.key!==void 0&&(P=""+g.key),g.ref!==void 0&&(N=g.ref);for(x in g)n.call(g,x)&&!m.hasOwnProperty(x)&&(b[x]=g[x]);if(f&&f.defaultProps)for(x in g=f.defaultProps,g)b[x]===void 0&&(b[x]=g[x]);return{$$typeof:s,type:f,key:P,ref:N,props:b,_owner:o.current}}return G.Fragment=r,G.jsx=u,G.jsxs=u,G}var oe;function _e(){return oe||(oe=1,se.exports=Te()),se.exports}var e=_e(),X={},ce;function Ae(){if(ce)return X;ce=1;var t=Se();return X.createRoot=t.createRoot,X.hydrateRoot=t.hydrateRoot,X}var Me=Ae();const Ie=Ce(Me);async function Le(t,s={},r){return window.__TAURI_INTERNALS__.invoke(t,s,r)}function Re(){return typeof window<"u"&&"__TAURI__"in window}async function I(t,s){if(!Re())throw new Error("Tauri is not available. Please ensure you are running this application in a Tauri environment.");try{return await Le(t,s)}catch(r){if(r&&typeof r=="object"&&"code"in r){const n=r,o=new Error(`CLI Error [${n.code}]: ${n.message}`);throw Object.defineProperty(o,"cliError",{value:{code:n.code,message:n.message,stderr:n.stderr,originalError:r},enumerable:!0,writable:!1}),o}if(r instanceof Error){const n=r.message.toLowerCase();if(n.includes("network")||n.includes("connection")||n.includes("fetch"))throw new Error(`Network error: ${r.message}. Please check your connection and try again.`)}throw r}}function De(t){if(t&&typeof t=="object"&&"cliError"in t){const s=t.cliError;if(s&&typeof s=="object"&&"code"in s&&"message"in s)return s}return null}const Fe={loading:"読み込み中...",error:"エラー",success:"成功",cancel:"キャンセル",confirm:"確認",close:"閉じる",save:"保存",delete:"削除",edit:"編集",add:"追加",remove:"削除",search:"検索",filter:"フィルター",export:"エクスポート",import:"インポート",refresh:"更新",retry:"再試行",back:"戻る",next:"次へ",previous:"前へ",others:"他 {{count}}個...",actions:"操作"},Oe={title:"FLM - Local LLM API Manager",subtitle:"ローカルLLM API管理ツール",proxyStatus:"プロキシ状態",engineStatus:"エンジン状態",running:"実行中",stopped:"停止中",startProxy:"プロキシを起動",stopProxy:"プロキシを停止",detectEngines:"エンジンを検出",enginesFound:"{{count}}個のエンジンが見つかりました",noEngines:"エンジンが見つかりませんでした",quickActions:"クイックアクション",chatTester:"Chat Tester",securityEvents:"セキュリティイベント",ipBlocklist:"IPブロックリスト",appOverview:"アプリケーション概要",appDescription:"FLMは、ローカルLLM（Large Language Model）のAPIを簡単に作成・管理できるデスクトップアプリケーションです。",port:"ポート",mode:"モード",feature1:"複数のLLMエンジン（Ollama、vLLM、LM Studio、llama.cpp）に対応",feature2:"OpenAI互換のAPIエンドポイントを提供",feature3:"セキュリティ機能（APIキー認証、IPブロックリスト、侵入検知）",feature4:"直感的なUIで初心者でも簡単に操作可能"},Ue={title:"Chat Tester",subtitle:"モデルをテストする",model:"モデル",message:"メッセージ",temperature:"温度",maxTokens:"最大トークン数",send:"送信",response:"レスポンス",loading:"読み込み中...",error:"エラーが発生しました",proxyNotRunning:"プロキシが実行されていません。Dashboardでプロキシを起動してください。",proxyEndpointError:"プロキシエンドポイントの取得に失敗しました",proxyEndpointNotAvailable:"プロキシエンドポイントが取得できません",fetchingProxyEndpoint:"プロキシエンドポイントを取得中...",proxyEndpoint:"プロキシエンドポイント",modelListError:"モデルリストの取得に失敗しました",fetchingModelList:"モデルリストを取得中...",selectModel:"選択してください",modelNotAvailable:"モデルが利用できません",refresh:"更新",apiKey:"APIキー (オプション)",apiKeyPlaceholder:"Bearer token",streaming:"Streaming (SSE)",selectModelError:"モデルを選択してください",temperatureError:"Temperatureは0.0から2.0の範囲で指定してください",maxTokensError:"Max Tokensは1以上の整数を指定してください",messageRequired:"メッセージを入力してください",sendError:"チャットリクエストの送信に失敗しました",settings:"設定",addMessage:"メッセージを追加",removeMessage:"削除"},$e={title:"セキュリティイベント",auditLogs:"監査ログ",intrusionDetection:"侵入検知",anomalyDetection:"異常検知",ipBlocklist:"IPブロックリスト",block:"ブロック",unblock:"ブロック解除",clearTemporary:"一時ブロックをクリア",exportCSV:"CSVエクスポート",exportJSON:"JSONエクスポート",filterApply:"フィルター適用",filterClear:"フィルタークリア",eventType:"イベントタイプ",severity:"重大度",ipAddress:"IPアドレス",minScore:"最小スコア",anomalyType:"異常タイプ",ipBlocklistManagement:"IPブロックリスト管理",fetchError:"IPブロックリストの取得に失敗しました",unblockConfirm:"IP {{ip}} のブロックを解除しますか？",unblockSuccess:"IP {{ip}} のブロックを解除しました",unblockError:"IPブロックの解除に失敗しました",clearTemporaryConfirm:"すべての一時ブロックを解除しますか？永続ブロックは残ります。",clearTemporarySuccess:"すべての一時ブロックを解除しました",clearTemporaryError:"一時ブロックの解除に失敗しました",clearAllTemporary:"一時ブロックをすべて解除",refresh:"更新",totalBlocks:"総ブロック数",permanentBlocks:"永続ブロック",temporaryBlocks:"一時ブロック",noBlockedIps:"ブロックされたIPアドレスはありません",blockedAt:"ブロック日時",reason:"理由",permanent:"永続",temporary:"一時",failureCount:"失敗回数",firstFailureAt:"初回失敗日時",blockedUntil:"ブロック期限",lastAttempt:"最終試行日時",type:"種類",cannotUnblockPermanent:"永続ブロックは解除できません"},Be={title:"設定",language:"言語",displayLanguage:"表示言語",languageHint:"アプリケーションの表示言語を選択します（現在: {{current}}）",japanese:"日本語",english:"English",autoDetect:"自動検出"},qe={menu:"メニュー",home:"ホーム",chatTester:"Chat Tester",securityEvents:"セキュリティイベント",ipBlocklist:"IPブロックリスト",settings:"設定",modelProfiles:"モデルプロファイル",modelComparison:"モデル比較",collapse:"サイドバーを折りたたむ",expand:"サイドバーを展開"},He={title:"モデルプロファイル",description:"エンジンごとに異なるモデルパラメータのプロファイルを管理します。",fetchError:"モデルプロファイルの取得に失敗しました",saveError:"モデルプロファイルの保存に失敗しました",deleteError:"モデルプロファイルの削除に失敗しました",createSuccess:"モデルプロファイルを作成しました",updateSuccess:"モデルプロファイルを更新しました",deleteSuccess:"モデルプロファイルを削除しました",deleteConfirm:"プロファイル「{{label}}」を削除しますか？この操作は元に戻せません。",requiredFields:"必須項目を入力してください",invalidJson:"パラメータJSONを解析できません。正しいJSON形式で入力してください。",filterByEngine:"エンジンでフィルター",filterByModel:"モデルでフィルター",enginePlaceholder:"例: ollama",modelPlaceholder:"例: llama3",createNew:"新規プロファイル作成",createProfile:"プロファイル作成",editProfile:"プロファイル編集",engineId:"エンジンID",modelId:"モデルID",label:"ラベル",labelPlaceholder:"プロファイル名",parameters:"パラメータ (JSON)",parametersHint:'JSON形式でパラメータを入力してください。例: {"temperature": 0.7, "max_tokens": 512}',profilesList:"プロファイル一覧",noProfiles:"プロファイルが見つかりません",updatedAt:"更新日時"},Je={title:"モデル比較・ヘルス履歴",description:"エンジンのヘルス履歴を表示し、時間経過に伴うモデルのパフォーマンスを比較します。",fetchError:"ヘルス履歴の取得に失敗しました",timeRange:"期間",last24Hours:"過去24時間",last7Days:"過去7日間",last30Days:"過去30日間",filterByEngine:"エンジンでフィルター",filterByModel:"モデルでフィルター",enginePlaceholder:"例: ollama",modelPlaceholder:"例: llama3",totalChecks:"総チェック数",successRate:"成功率",avgLatency:"平均レイテンシ",avgErrorRate:"平均エラー率",statusBreakdown:"ステータス内訳",healthy:"正常",degraded:"劣化",unreachable:"到達不可",engineSummary:"エンジンサマリ",modelSummary:"モデルサマリ",recentLogs:"最近のログ",engine:"エンジン",model:"モデル",status:"ステータス",latency:"レイテンシ",errorRate:"エラー率",timestamp:"タイムスタンプ",nA:"N/A",noData:"ヘルス履歴データがありません",noModelData:"モデル固有のデータがありません"},We={generic:"エラーが発生しました",networkError:"ネットワークエラーが発生しました",cliError:"CLIエラーが発生しました",proxyNotRunning:"プロキシが実行されていません",details:"詳細",showDetails:"詳細を表示",hideDetails:"詳細を非表示"},ze={proxyStarted:"プロキシが起動しました",proxyStopped:"プロキシが停止しました",enginesDetected:"エンジンの検出が完了しました",ipBlocked:"IPアドレスがブロックされました",ipUnblocked:"IPアドレスのブロックが解除されました",temporaryBlockedCleared:"一時ブロックがクリアされました",languageChanged:"言語を{{locale}}に変更しました"},ne={common:Fe,home:Oe,chatTester:Ue,security:$e,settings:Be,sidebar:qe,modelProfiles:He,modelComparison:Je,errors:We,messages:ze},Ve={loading:"Loading...",error:"Error",success:"Success",cancel:"Cancel",confirm:"Confirm",close:"Close",save:"Save",delete:"Delete",edit:"Edit",add:"Add",remove:"Remove",search:"Search",filter:"Filter",export:"Export",import:"Import",refresh:"Refresh",retry:"Retry",back:"Back",next:"Next",previous:"Previous",others:"{{count}} more...",actions:"Actions"},Ke={title:"FLM - Local LLM API Manager",subtitle:"Local LLM API Management Tool",proxyStatus:"Proxy Status",engineStatus:"Engine Status",running:"Running",stopped:"Stopped",startProxy:"Start Proxy",stopProxy:"Stop Proxy",detectEngines:"Detect Engines",enginesFound:"{{count}} engines found",noEngines:"No engines found",quickActions:"Quick Actions",chatTester:"Chat Tester",securityEvents:"Security Events",ipBlocklist:"IP Blocklist",appOverview:"Application Overview",appDescription:"FLM is a desktop application that makes it easy to create and manage APIs for local LLMs (Large Language Models).",port:"Port",mode:"Mode",feature1:"Supports multiple LLM engines (Ollama, vLLM, LM Studio, llama.cpp)",feature2:"Provides OpenAI-compatible API endpoints",feature3:"Security features (API key authentication, IP blocklist, intrusion detection)",feature4:"Intuitive UI that is easy to use even for beginners"},Ge={title:"Chat Tester",subtitle:"Test Models",model:"Model",message:"Message",temperature:"Temperature",maxTokens:"Max Tokens",send:"Send",response:"Response",loading:"Loading...",error:"An error occurred",proxyNotRunning:"Proxy is not running. Please start the proxy from the Dashboard.",proxyEndpointError:"Failed to get proxy endpoint",proxyEndpointNotAvailable:"Proxy endpoint is not available",fetchingProxyEndpoint:"Fetching proxy endpoint...",proxyEndpoint:"Proxy Endpoint",modelListError:"Failed to fetch model list",fetchingModelList:"Fetching model list...",selectModel:"Please select",modelNotAvailable:"No models available",refresh:"Refresh",apiKey:"API Key (Optional)",apiKeyPlaceholder:"Bearer token",streaming:"Streaming (SSE)",selectModelError:"Please select a model",temperatureError:"Temperature must be between 0.0 and 2.0",maxTokensError:"Max Tokens must be a positive integer",messageRequired:"Please enter a message",sendError:"Failed to send chat request",settings:"Settings",addMessage:"Add Message",removeMessage:"Remove"},Ye={title:"Security Events",auditLogs:"Audit Logs",intrusionDetection:"Intrusion Detection",anomalyDetection:"Anomaly Detection",ipBlocklist:"IP Blocklist",block:"Block",unblock:"Unblock",clearTemporary:"Clear Temporary",exportCSV:"Export CSV",exportJSON:"Export JSON",filterApply:"Apply Filter",filterClear:"Clear Filter",eventType:"Event Type",severity:"Severity",ipAddress:"IP Address",minScore:"Min Score",anomalyType:"Anomaly Type",ipBlocklistManagement:"IP Blocklist Management",fetchError:"Failed to fetch IP blocklist",unblockConfirm:"Unblock IP {{ip}}?",unblockSuccess:"Unblocked IP {{ip}}",unblockError:"Failed to unblock IP",clearTemporaryConfirm:"Clear all temporary blocks? Permanent blocks will remain.",clearTemporarySuccess:"Cleared all temporary blocks",clearTemporaryError:"Failed to clear temporary blocks",clearAllTemporary:"Clear All Temporary Blocks",refresh:"Refresh",totalBlocks:"Total Blocks",permanentBlocks:"Permanent Blocks",temporaryBlocks:"Temporary Blocks",noBlockedIps:"No blocked IP addresses",blockedAt:"Blocked At",reason:"Reason",permanent:"Permanent",temporary:"Temporary",failureCount:"Failure Count",firstFailureAt:"First Failure At",blockedUntil:"Blocked Until",lastAttempt:"Last Attempt",type:"Type",cannotUnblockPermanent:"Cannot unblock permanent blocks"},Xe={title:"Settings",language:"Language",displayLanguage:"Display Language",languageHint:"Select the application display language (Current: {{current}})",japanese:"Japanese",english:"English",autoDetect:"Auto Detect"},Qe={menu:"Menu",home:"Home",chatTester:"Chat Tester",securityEvents:"Security Events",ipBlocklist:"IP Blocklist",settings:"Settings",modelProfiles:"Model Profiles",modelComparison:"Model Comparison",collapse:"Collapse sidebar",expand:"Expand sidebar"},Ze={title:"Model Profiles",description:"Manage model-specific parameter profiles for different engines.",fetchError:"Failed to fetch model profiles",saveError:"Failed to save model profile",deleteError:"Failed to delete model profile",createSuccess:"Model profile created successfully",updateSuccess:"Model profile updated successfully",deleteSuccess:"Model profile deleted successfully",deleteConfirm:'Delete profile "{{label}}"? This action cannot be undone.',requiredFields:"Please fill in required fields",invalidJson:"Invalid JSON format. Please enter valid JSON.",filterByEngine:"Filter by Engine",filterByModel:"Filter by Model",enginePlaceholder:"e.g., ollama",modelPlaceholder:"e.g., llama3",createNew:"Create New Profile",createProfile:"Create Profile",editProfile:"Edit Profile",engineId:"Engine ID",modelId:"Model ID",label:"Label",labelPlaceholder:"Profile name",parameters:"Parameters (JSON)",parametersHint:'Enter parameters as JSON. Example: {"temperature": 0.7, "max_tokens": 512}',profilesList:"Profiles",noProfiles:"No profiles found",updatedAt:"Updated"},et={title:"Model Comparison & Health History",description:"View engine health history and compare model performance over time.",fetchError:"Failed to fetch health history",timeRange:"Time Range",last24Hours:"Last 24 Hours",last7Days:"Last 7 Days",last30Days:"Last 30 Days",filterByEngine:"Filter by Engine",filterByModel:"Filter by Model",enginePlaceholder:"e.g., ollama",modelPlaceholder:"e.g., llama3",totalChecks:"Total Checks",successRate:"Success Rate",avgLatency:"Avg Latency",avgErrorRate:"Avg Error Rate",statusBreakdown:"Status Breakdown",healthy:"Healthy",degraded:"Degraded",unreachable:"Unreachable",engineSummary:"Engine Summary",modelSummary:"Model Summary",recentLogs:"Recent Logs",engine:"Engine",model:"Model",status:"Status",latency:"Latency",errorRate:"Error Rate",timestamp:"Timestamp",nA:"N/A",noData:"No health history data available",noModelData:"No model-specific data available"},tt={generic:"An error occurred",networkError:"Network error occurred",cliError:"CLI error occurred",proxyNotRunning:"Proxy is not running",details:"Details",showDetails:"Show Details",hideDetails:"Hide Details"},st={proxyStarted:"Proxy started",proxyStopped:"Proxy stopped",enginesDetected:"Engine detection completed",ipBlocked:"IP address blocked",ipUnblocked:"IP address unblocked",temporaryBlockedCleared:"Temporary blocks cleared",languageChanged:"Language changed to {{locale}}"},ye={common:Ve,home:Ke,chatTester:Ge,security:Ye,settings:Xe,sidebar:Qe,modelProfiles:Ze,modelComparison:et,errors:tt,messages:st},xe=a.createContext(void 0),rt={ja:ne,en:ye},at=({children:t})=>{const[s,r]=a.useState("ja");a.useEffect(()=>{(async()=>{try{const g=navigator.language.toLowerCase();let y="ja";g.startsWith("ja")?y="ja":g.startsWith("en")&&(y="en");try{const x=await I("ipc_config_get",{key:"preferred_language"});x?.data?.value&&(x.data.value==="ja"||x.data.value==="en")&&(y=x.data.value)}catch{}r(y)}catch{r("ja")}})()},[]);const n=a.useCallback((f,g)=>{let y=f;for(const x of g)if(y&&typeof y=="object"&&x in y)y=y[x];else return null;return typeof y=="string"?y:null},[]),o=a.useCallback(async f=>{r(f);try{await I("ipc_config_set",{key:"preferred_language",value:f})}catch(g){console.error("Failed to save language preference:",g)}},[]),m=a.useCallback((f,g)=>{const y=f.split(".");let x=n(rt[s],y);return x===null&&s!=="ja"&&(x=n(ne,y)),x===null&&(x=n(ye,y)),x===null?f:g?x.replace(/\{\{(\w+)\}\}/g,(b,P)=>g[P]?.toString()||b):x},[s,n]),u=a.useMemo(()=>({locale:s,setLocale:o,t:m}),[s,o,m]);return e.jsx(xe.Provider,{value:u,children:t})},U=()=>{const t=a.useContext(xe);return t||{locale:"ja",setLocale:async()=>{console.warn("setLocale called outside I18nProvider")},t:(r,n)=>{const o=r.split(".");let m=null,u=ne;for(const f of o)if(u&&typeof u=="object"&&f in u)u=u[f];else return r;return m=typeof u=="string"?u:null,m===null?r:n?m.replace(/\{\{(\w+)\}\}/g,(f,g)=>n[g]?.toString()||f):m}}},je=a.createContext(void 0),re="flm_preferred_theme",nt=({children:t})=>{const[s,r]=a.useState("light");a.useEffect(()=>{(async()=>{try{const x=localStorage.getItem(re);if(x==="light"||x==="dark")r(x),n(x);else{const P=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";r(P),n(P)}}catch(x){console.error("Failed to load theme:",x),r("light"),n("light")}})();const g=window.matchMedia("(prefers-color-scheme: dark)"),y=x=>{if(!localStorage.getItem(re)){const P=x.matches?"dark":"light";r(P),n(P)}};return g.addEventListener("change",y),()=>g.removeEventListener("change",y)},[]);const n=a.useCallback(f=>{const g=document.documentElement;f==="dark"?(g.classList.add("dark-theme"),g.classList.remove("light-theme")):(g.classList.add("light-theme"),g.classList.remove("dark-theme"))},[]),o=a.useCallback(async f=>{try{r(f),n(f),localStorage.setItem(re,f)}catch(g){throw console.error("Failed to save theme:",g),g}},[n]),m=a.useCallback(async()=>{await o(s==="light"?"dark":"light")},[s,o]),u={theme:s,setTheme:o,toggleTheme:m};return e.jsx(je.Provider,{value:u,children:t})},lt=()=>{const t=a.useContext(je);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},it=({defaultCollapsed:t=!1,className:s="",onCollapseChange:r})=>{const n=fe(),o=ke(),{t:m}=U(),[u,f]=a.useState(t),g=a.useCallback(()=>{const N=!u;f(N),r?.(N)},[u,r]),y=a.useCallback(N=>o.pathname===N||o.pathname.startsWith(`${N}/`),[o.pathname]),x=[{path:"/",label:m("sidebar.home")},{path:"/chat/tester",label:m("sidebar.chatTester")},{path:"/security/events",label:m("sidebar.securityEvents")},{path:"/security/ip-blocklist",label:m("sidebar.ipBlocklist")},{path:"/security/ip-whitelist",label:m("sidebar.ipWhitelist")},{path:"/models/profiles",label:m("sidebar.modelProfiles")},{path:"/models/comparison",label:m("sidebar.modelComparison")},{path:"/settings",label:m("sidebar.settings")}],b=a.useCallback(N=>{n(N)},[n]),P=`app-sidebar ${u?"collapsed":""} ${s}`.trim();return e.jsx("aside",{className:P,children:e.jsxs("div",{className:"sidebar-container",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("button",{className:"sidebar-toggle",onClick:g,"aria-label":m(u?"sidebar.expand":"sidebar.collapse"),"aria-expanded":!u,children:u?"▶":"◀"}),!u&&e.jsx("h2",{className:"sidebar-title",children:m("sidebar.menu")})]}),e.jsx("nav",{className:"sidebar-nav","aria-label":m("sidebar.menu"),children:e.jsx("ul",{className:"sidebar-nav-list",children:x.map(N=>{const S=y(N.path);return e.jsx("li",{className:"sidebar-nav-item",children:e.jsx("button",{className:`sidebar-nav-link ${S?"active":""}`,onClick:()=>b(N.path),"aria-label":N.label,"aria-current":S?"page":void 0,children:!u&&e.jsx("span",{className:"sidebar-nav-label",children:N.label})})},N.path)})})})]})})},$=({children:t,className:s=""})=>e.jsxs("div",{className:`app-layout ${s}`,children:[e.jsx(it,{}),e.jsx("div",{className:"layout-body",children:e.jsx("main",{className:"main-content",children:t})})]}),q=t=>{if(!t||t.trim()==="")return"不明";try{const s=new Date(t);return isNaN(s.getTime())?t:s.toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return t}},ot=t=>typeof t=="string"?{"local-http":"Local HTTP","dev-selfsigned":"Dev Self-Signed","dev-self-signed":"Dev Self-Signed","https-acme":"HTTPS ACME","packaged-ca":"Packaged CA"}[t]||t:t&&typeof t=="object"?"LocalHttp"in t||"local-http"in t?"Local HTTP":"DevSelfSigned"in t||"dev-selfsigned"in t||"dev-self-signed"in t?"Dev Self-Signed":"HttpsAcme"in t||"https-acme"in t?"HTTPS ACME":"PackagedCa"in t||"packaged-ca"in t?"Packaged CA":JSON.stringify(t):"Unknown",ct=t=>{if(typeof t=="string")return{"installed-only":"Installed Only","running-healthy":"Running Healthy","running-degraded":"Running Degraded","error-network":"Network Error","error-api":"API Error"}[t]||t.replace(/-/g," ").replace(/\b\w/g,r=>r.toUpperCase());if(t&&typeof t=="object"){if("status"in t){const s=t.status;if(typeof s=="string")return{"installed-only":"Installed Only","running-healthy":`Running Healthy${t.latency_ms?` (${t.latency_ms}ms)`:""}`,"running-degraded":`Running Degraded${t.latency_ms?` (${t.latency_ms}ms)`:""}`,"error-network":`Network Error${t.reason?`: ${t.reason}`:""}`,"error-api":`API Error${t.reason?`: ${t.reason}`:""}`}[s]||s.replace(/-/g," ").replace(/\b\w/g,n=>n.toUpperCase())}if("InstalledOnly"in t||"installed-only"in t)return"Installed Only";if("RunningHealthy"in t||"running-healthy"in t){const s=t.RunningHealthy?.latency_ms||t["running-healthy"]?.latency_ms||t.latency_ms;return`Running Healthy${s?` (${s}ms)`:""}`}if("RunningDegraded"in t||"running-degraded"in t){const s=t.RunningDegraded||t["running-degraded"],r=s?.latency_ms||t.latency_ms,n=s?.reason||t.reason;return`Running Degraded${r?` (${r}ms)`:""}${n?`: ${n}`:""}`}if("ErrorNetwork"in t||"error-network"in t){const s=t.ErrorNetwork?.reason||t["error-network"]?.reason||t.reason;return`Network Error${s?`: ${s}`:""}`}if("ErrorApi"in t||"error-api"in t){const s=t.ErrorApi?.reason||t["error-api"]?.reason||t.reason;return`API Error${s?`: ${s}`:""}`}return JSON.stringify(t)}return"Unknown"};function H(t,s){const r=t.current[s];r&&(clearTimeout(r),delete t.current[s])}function Y(t,s,r,n){H(t,s),t.current[s]=setTimeout(r,n)}function dt(t){Object.keys(t.current).forEach(s=>{H(t,s)})}const ut={level:1,enableConsole:!0};let de={...ut};function Q(t){return t>=de.level&&de.enableConsole}function mt(t){return{debug:(...r)=>{Q(0)&&console.debug("",...r)},info:(...r)=>{Q(1)&&console.info("",...r)},warn:(...r)=>{Q(2)&&console.warn("",...r)},error:(...r)=>{Q(3)&&console.error("",...r)}}}const V=mt();function F(t){const{defaultMessage:s,silentPatterns:r=[],showStderr:n=!1}=t;return o=>{const m=De(o),u=o instanceof Error?o.message:s,f=r.some(y=>u.toLowerCase().includes(y.toLowerCase()));return{message:m?.stderr&&n?`${u}
詳細: ${m.stderr}`:u,shouldShow:!f,cliError:m??void 0}}}const B={STATUS_REFRESH_DELAY_MS:1e3,MESSAGE_AUTO_DISMISS_MS:3e3,STATUS_POLL_INTERVAL_MS:3e4},ht=["not found","not running","CLI_BINARY_NOT_FOUND"],ue={MODE:"dev-selfsigned",PORT:8080},me={TEMPERATURE:.7,MAX_TOKENS:1e3},O=J.memo(({message:t,onDismiss:s,details:r})=>e.jsxs("div",{className:"error-message",children:[e.jsxs("div",{className:"error-message-header",children:[e.jsx("strong",{children:"エラー:"}),s&&e.jsx("button",{className:"error-dismiss-button",onClick:s,"aria-label":"エラーメッセージを閉じる",children:"×"})]}),e.jsx("div",{className:"error-message-content",children:t}),r&&e.jsxs("details",{className:"error-details",children:[e.jsx("summary",{children:"詳細情報"}),e.jsx("pre",{className:"error-details-content",children:r})]})]}));O.displayName="ErrorMessage";const W=J.memo(({message:t,onDismiss:s,autoDismiss:r=3e3})=>(a.useEffect(()=>{if(r>0&&s){const n=setTimeout(()=>{s()},r);return()=>clearTimeout(n)}},[r,s]),e.jsxs("div",{className:"success-message",children:[e.jsxs("div",{className:"success-message-header",children:[e.jsx("strong",{children:"成功:"}),s&&e.jsx("button",{className:"success-dismiss-button",onClick:s,"aria-label":"成功メッセージを閉じる",children:"×"})]}),e.jsx("div",{className:"success-message-content",children:t})]})));W.displayName="SuccessMessage";const R=J.memo(({size:t="medium",message:s})=>e.jsxs("div",{className:`loading-spinner-container ${t}`,role:"status","aria-live":"polite","aria-label":s||"読み込み中",children:[e.jsx("div",{className:"loading-spinner","aria-hidden":"true"}),s&&e.jsx("p",{className:"loading-message",id:"loading-message",children:s})]}));R.displayName="LoadingSpinner";const pt=new Set(["installed-only","running-healthy","running-degraded","error-network","error-api","unknown"]);function gt(t){if(!t||typeof t!="object")return!1;const s=t;if(!("data"in s))return!1;const r=s.data;return Array.isArray(r)&&r.length>0}function ft(t){return t!==null&&typeof t=="object"&&"running"in t&&typeof t.running=="boolean"}function ae(t){if(!t||typeof t!="object")return null;const s=t;if(typeof s.id!="string"||!s.id.trim())return null;const r=s.id.trim(),n=typeof s.name=="string"&&s.name.trim()?s.name.trim():r;let o="unknown";return s.status!==void 0&&(typeof s.status=="string"?o=pt.has(s.status)?s.status:"unknown":typeof s.status=="object"&&s.status!==null&&(o=s.status)),{id:r,name:n,status:o}}const yt=()=>{const t=fe(),{t:s}=U(),[r,n]=a.useState(null),[o,m]=a.useState([]),[u,f]=a.useState(!1),[g,y]=a.useState(!1),[x,b]=a.useState(null),[P,N]=a.useState(null),S=a.useRef({}),T=a.useCallback(p=>{if(gt(p)){const j=p.data;if(j&&j.length>0){const M=j[0];n({running:M.running??!1,port:M.port,mode:M.mode});return}}if(ft(p)){n(p);return}n({running:!1})},[]),_=a.useMemo(()=>F({defaultMessage:"プロキシステータスの取得に失敗しました",silentPatterns:ht}),[]),w=a.useCallback(async()=>{try{const p=await I("ipc_proxy_status");T(p),b(j=>j?.includes("プロキシステータス")?null:j)}catch(p){const j=_(p);j.shouldShow?b(j.message):n({running:!1})}},[T,_]),h=a.useCallback(async()=>{y(!0),b(null);try{const p=await I("ipc_detect_engines",{fresh:!1});if(p&&"data"in p&&p.data&&"engines"in p.data){const j=p.data.engines;Array.isArray(j)&&m(j.map(ae).filter(M=>M!==null))}else p&&"engines"in p&&Array.isArray(p.engines)?m(p.engines.map(ae).filter(j=>j!==null)):Array.isArray(p)?m(p.map(ae).filter(j=>j!==null)):m([])}catch(p){V.warn("エンジンの検出に失敗しました:",p),m([])}finally{y(!1)}},[]),c=a.useMemo(()=>F({defaultMessage:s("errors.generic")}),[s]),d=a.useMemo(()=>F({defaultMessage:s("errors.generic")}),[s]),i=a.useCallback(async()=>{f(!0),b(null),N(null),H(S,"status"),H(S,"message");try{await I("ipc_proxy_start",{mode:ue.MODE,port:ue.PORT,no_daemon:!0}),N(s("messages.proxyStarted")),Y(S,"status",()=>{w()},B.STATUS_REFRESH_DELAY_MS),Y(S,"message",()=>{N(null)},B.MESSAGE_AUTO_DISMISS_MS)}catch(p){const j=c(p);j.shouldShow&&b(j.message),N(null)}finally{f(!1)}},[w,c]),C=a.useCallback(async()=>{if(f(!0),b(null),N(null),H(S,"status"),H(S,"message"),!r||!r.running||!r.port){b(s("errors.proxyNotRunning")||"プロキシが実行されていません"),f(!1);return}try{await I("ipc_proxy_stop",{port:r.port}),N(s("messages.proxyStopped")),Y(S,"message",()=>{N(null)},B.MESSAGE_AUTO_DISMISS_MS),Y(S,"status",()=>{w()},B.STATUS_REFRESH_DELAY_MS)}catch(p){const j=d(p);j.shouldShow&&b(j.message),N(null)}finally{f(!1)}},[r,w,d,s]),l=a.useMemo(()=>F({defaultMessage:s("errors.generic")}),[s]),E=a.useCallback(async()=>{b(null),N(null),H(S,"detect"),H(S,"message");try{await h(),N(s("messages.enginesDetected")),Y(S,"detect",()=>{N(null)},B.MESSAGE_AUTO_DISMISS_MS)}catch(p){const j=l(p);j.shouldShow&&b(j.message)}},[h,l]);a.useEffect(()=>{w(),h();const p=setInterval(()=>{w()},B.STATUS_POLL_INTERVAL_MS);return()=>{clearInterval(p),dt(S)}},[w,h]);const k=a.useMemo(()=>{if(g)return e.jsx(R,{size:"small",message:s("common.loading")});if(o.length===0)return e.jsx("div",{className:"status-info",children:e.jsx("div",{className:"status-badge status-stopped",children:s("home.noEngines")})});const p=o.slice(0,3),j=o.length-3;return e.jsxs("div",{className:"status-info",children:[e.jsx("div",{className:"status-badge status-running",children:s("home.enginesFound",{count:o.length})}),e.jsxs("div",{className:"engine-list",children:[p.map(M=>e.jsxs("div",{className:"engine-item",children:[M.name," (",ct(M.status),")"]},M.id)),j>0&&e.jsx("div",{className:"engine-item",children:s("common.others",{count:j})})]})]})},[g,o,s]);return e.jsxs("div",{className:"home",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:s("home.title")}),e.jsx("p",{className:"page-subtitle",children:s("home.subtitle")})]}),x&&e.jsx(O,{message:x,onDismiss:()=>b(null)}),P&&e.jsx(W,{message:P,onDismiss:()=>N(null),autoDismiss:B.MESSAGE_AUTO_DISMISS_MS}),e.jsxs("div",{className:"home-content",children:[e.jsxs("section",{className:"status-section",children:[e.jsx("h2",{children:"システムステータス"}),e.jsxs("div",{className:"status-cards",children:[e.jsxs("div",{className:"status-card",children:[e.jsx("h3",{children:s("home.proxyStatus")}),r?e.jsxs("div",{className:"status-info",children:[e.jsx("div",{className:`status-badge ${r.running?"status-running":"status-stopped"}`,children:r.running?s("home.running"):s("home.stopped")}),r.running&&r.port&&e.jsxs("div",{className:"status-detail",children:[e.jsxs("span",{children:[s("home.port"),": ",r.port]}),r.mode&&e.jsxs("span",{children:[s("home.mode"),": ",ot(r.mode)]})]})]}):e.jsx(R,{size:"small",message:s("common.loading")})]}),e.jsxs("div",{className:"status-card",children:[e.jsx("h3",{children:s("home.engineStatus")}),k]})]})]}),e.jsxs("section",{className:"actions-section",children:[e.jsx("h2",{children:s("home.quickActions")}),e.jsxs("div",{className:"action-buttons",children:[r?.running?e.jsx("button",{className:"button-danger action-button",onClick:C,disabled:u,children:s("home.stopProxy")}):e.jsx("button",{className:"button-primary action-button",onClick:i,disabled:u,children:s("home.startProxy")}),e.jsx("button",{className:"button-secondary action-button",onClick:E,disabled:g||u,children:s(g?"common.loading":"home.detectEngines")}),e.jsx("button",{className:"button-secondary action-button",onClick:()=>t("/chat/tester"),children:s("home.chatTester")}),e.jsx("button",{className:"button-secondary action-button",onClick:()=>t("/security/events"),children:s("home.securityEvents")})]})]}),e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:s("home.appOverview")}),e.jsxs("div",{className:"info-content",children:[e.jsx("p",{children:s("home.appDescription")}),e.jsxs("ul",{children:[e.jsx("li",{children:s("home.feature1")}),e.jsx("li",{children:s("home.feature2")}),e.jsx("li",{children:s("home.feature3")}),e.jsx("li",{children:s("home.feature4")})]})]})]})]})]})},ve={MODELS:"/v1/models",CHAT_COMPLETIONS:"/v1/chat/completions"},he="flm-";function be(t,s){try{const r=new URL(t);let n;const o=s.toLowerCase(),m=o.startsWith("http://")||o.startsWith("https://");if(s.startsWith("//"))throw new Error("Invalid URL: protocol-relative URLs are not allowed");if(m){if(n=new URL(s),n.origin!==r.origin)throw new Error("Invalid URL: origin mismatch")}else if(n=new URL(s,t),n.origin!==r.origin)throw new Error("Invalid URL: origin mismatch");if(n.protocol!=="http:"&&n.protocol!=="https:")throw new Error("Invalid URL: only http and https protocols are allowed");return n.toString()}catch{throw new Error(`Invalid proxy endpoint URL: ${t}`)}}function xt(t){if(!t)return"http";if(typeof t=="string")return t.toLowerCase().includes("https")?"https":"http";if(typeof t=="object"){const s=Object.keys(t),r=new Set(["HttpsAcme","DevSelfSigned","PackagedCa"]);return s.some(n=>r.has(n))?"https":"http"}return"http"}function jt(t){if(!t||typeof t!="object")return!1;const s=t;return typeof s.id=="string"&&typeof s.object=="string"&&typeof s.created=="number"&&typeof s.model=="string"&&Array.isArray(s.choices)}function vt(t){return!t||typeof t!="object"?null:"data"in t&&Array.isArray(t.data)&&t.data.length>0?t.data[0]:"running"in t?t:null}function bt(t){const s=t.id||"";if(!s)return null;let r="",n=s;if(s.startsWith(he)){const o=s.replace(he,"").split("-");o.length>=2?(r=`flm://${o[0]}/${o.slice(1).join("-")}`,n=r):r=s}else r=s;return{id:s,flmUri:r,displayName:n}}function Nt(t){if(!t||typeof t!="object"||!("data"in t))return[];const s=t;return Array.isArray(s.data)?s.data.map(r=>bt(r)).filter(r=>r!==null):[]}async function St(t){try{const s=await fetch(be(t,ve.MODELS),{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to fetch models: HTTP ${s.status}`);const r=await s.json();return Nt(r)}catch(s){throw new Error(s instanceof Error?s.message:"モデルリストの取得に失敗しました")}}function Ct(t){const s={"Content-Type":"application/json"};return t&&(s.Authorization=`Bearer ${t}`),s}async function kt(t){let s=`Chat completion failed: HTTP ${t.status}`;try{const r=await t.text()}catch{}return s}function Et(t,s){const r=s.headers.get("x-request-id")||s.headers.get("X-Request-Id");return r?{...t,request_id:r}:t}async function wt(t,s,r){try{const n=Ct(s),o=await fetch(be(t,ve.CHAT_COMPLETIONS),{method:"POST",headers:n,body:JSON.stringify(r)});if(!o.ok){const u=await kt(o);throw new Error(u)}const m=await o.json();if(!jt(m))throw new Error("Invalid response format from chat completion endpoint");return Et(m,o)}catch(n){throw new Error(n instanceof Error?n.message:"チャットリクエストの送信に失敗しました")}}async function Pt(){try{const t=await I("ipc_proxy_status"),s=vt(t);return s?.running?s.endpoints?.localhost?s.endpoints.localhost:s.port?`${xt(s.mode)}://localhost:${s.port}`:null:null}catch{return null}}function Tt(t){const s=typeof t=="string"?parseFloat(t):t;return!isNaN(s)&&s>=0&&s<=2}function _t(t){const s=typeof t=="string"?parseInt(t,10):t;return Number.isInteger(s)&&s>0}function pe(t,s,r){const n=typeof t=="string"?parseFloat(t):t;return isNaN(n)||s!==void 0&&n<s||r!==void 0&&n>r?null:n}const At=()=>{const{t}=U(),[s,r]=a.useState(null),[n,o]=a.useState([]),[m,u]=a.useState(""),[f,g]=a.useState(""),[y,x]=a.useState([{role:"user",content:""}]),[b,P]=a.useState(!1),[N,S]=a.useState(me.TEMPERATURE),[T,_]=a.useState(me.MAX_TOKENS),[w,h]=a.useState(null),[c,d]=a.useState(!1),[i,C]=a.useState(null),l=a.useMemo(()=>F({defaultMessage:t("chatTester.proxyEndpointError")}),[t]),E=a.useCallback(async()=>{d(!0),C(null);try{const A=await Pt();r(A),A||C(t("chatTester.proxyNotRunning"))}catch(A){const v=l(A);v.shouldShow&&C(v.message)}finally{d(!1)}},[l]),k=a.useMemo(()=>F({defaultMessage:t("chatTester.modelListError")}),[t]),p=a.useMemo(()=>F({defaultMessage:t("chatTester.sendError")}),[t]),j=a.useCallback(async()=>{if(s){d(!0),C(null);try{const A=await St(s);o(A),A.length>0&&!m&&u(A[0].id)}catch(A){const v=k(A);v.shouldShow&&C(v.message)}finally{d(!1)}}},[s,k]);a.useEffect(()=>{E()},[E]),a.useEffect(()=>{s&&j()},[s,j]);const M=()=>{x([...y,{role:"user",content:""}])},D=A=>{y.length>1&&x(y.filter((v,L)=>L!==A))},K=(A,v)=>{const L=[...y];L[A]={...L[A],content:v},x(L)},ee=(A,v)=>{const L=[...y];L[A]={...L[A],role:v},x(L)},te=async()=>{if(!s){C(t("chatTester.proxyEndpointNotAvailable"));return}if(!m){C(t("chatTester.selectModelError"));return}if(!Tt(N)){C(t("chatTester.temperatureError"));return}if(!_t(T)){C(t("chatTester.maxTokensError"));return}const A=y.filter(v=>v.content.trim().length>0);if(A.length===0){C(t("chatTester.messageRequired"));return}d(!0),C(null),h(null);try{const L=await wt(s,f||null,{model:m,messages:A,stream:b,temperature:N,max_tokens:T});h(L)}catch(v){const L=p(v);L.shouldShow&&C(L.message)}finally{d(!1)}};return e.jsxs("div",{className:"chat-tester",children:[e.jsx("div",{className:"page-header",children:e.jsx("h1",{children:t("chatTester.title")})}),i&&e.jsx(O,{message:i,onDismiss:()=>C(null)}),!s&&!c&&e.jsx("div",{className:"proxy-warning",children:e.jsx("p",{children:t("chatTester.proxyNotRunning")})}),c&&!s&&e.jsx(R,{message:t("chatTester.fetchingProxyEndpoint")}),s&&e.jsxs("div",{className:"chat-tester-content",children:[e.jsxs("div",{className:"tester-config",children:[e.jsx("h2",{children:t("chatTester.settings")}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{children:[t("chatTester.proxyEndpoint"),":",e.jsx("code",{className:"endpoint-display",children:s})]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{htmlFor:"model-select",children:[t("chatTester.model"),":",e.jsxs("select",{id:"model-select",value:m,onChange:A=>u(A.target.value),className:"model-select",disabled:c||n.length===0,"aria-label":t("chatTester.model"),"aria-describedby":n.length===0&&!c?"model-select-help":void 0,children:[e.jsx("option",{value:"",children:t("chatTester.selectModel")}),n.map(A=>e.jsx("option",{value:A.id,children:A.displayName},A.id))]}),n.length===0&&!c&&e.jsx("span",{id:"model-select-help",className:"help-text",children:t("chatTester.modelNotAvailable")}),c&&n.length===0?e.jsx(R,{size:"small",message:t("chatTester.fetchingModelList")}):e.jsx("button",{className:"button-secondary button-small",onClick:j,disabled:c,children:t("chatTester.refresh")})]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{htmlFor:"api-key-input",children:[t("chatTester.apiKey"),":",e.jsx("input",{id:"api-key-input",type:"password",value:f,onChange:A=>g(A.target.value),placeholder:t("chatTester.apiKeyPlaceholder"),className:"input-text","aria-label":t("chatTester.apiKey")})]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{htmlFor:"streaming-checkbox",children:[e.jsx("input",{id:"streaming-checkbox",type:"checkbox",checked:b,onChange:A=>P(A.target.checked)}),t("chatTester.streaming")]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{htmlFor:"temperature-input",children:["Temperature:",e.jsx("input",{id:"temperature-input",type:"number",value:N,onChange:A=>{const v=pe(A.target.value,0,2);v!==null&&S(v)},min:"0",max:"2",step:"0.1",className:"input-number","aria-label":"Temperature（0.0から2.0の範囲）","aria-describedby":"temperature-help"}),e.jsx("span",{id:"temperature-help",className:"help-text",children:t("chatTester.temperatureError")})]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{htmlFor:"max-tokens-input",children:["Max Tokens:",e.jsx("input",{id:"max-tokens-input",type:"number",value:T,onChange:A=>{const v=pe(A.target.value,1);v!==null&&Number.isInteger(v)&&_(v)},min:"1",className:"input-number","aria-label":"Max Tokens（1以上の整数）","aria-describedby":"max-tokens-help"}),e.jsx("span",{id:"max-tokens-help",className:"help-text",children:t("chatTester.maxTokensError")})]})})]}),e.jsxs("div",{className:"tester-messages",children:[e.jsx("h2",{children:t("chatTester.message")}),e.jsx("div",{className:"messages-list",children:y.map((A,v)=>e.jsxs("div",{className:"message-item",children:[e.jsxs("div",{className:"message-header",children:[e.jsxs("label",{htmlFor:`role-select-${v}`,className:"sr-only",children:["メッセージ",v+1,"のロールを選択"]}),e.jsxs("select",{id:`role-select-${v}`,value:A.role,onChange:L=>ee(v,L.target.value),className:"role-select",children:[e.jsx("option",{value:"system",children:"System"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"assistant",children:"Assistant"})]}),y.length>1&&e.jsx("button",{className:"button-danger button-small",onClick:()=>D(v),"aria-label":`メッセージ${v+1}を削除`,children:"削除"})]}),e.jsxs("label",{htmlFor:`message-textarea-${v}`,className:"sr-only",children:["メッセージ",v+1,"の内容を入力"]}),e.jsx("textarea",{id:`message-textarea-${v}`,value:A.content,onChange:L=>K(v,L.target.value),placeholder:t("chatTester.message")+"...",className:"message-textarea",rows:4})]},v))}),e.jsxs("button",{className:"button-secondary",onClick:M,"aria-label":"新しいメッセージを追加",children:["+ ",t("chatTester.addMessage")]}),e.jsx("div",{className:"send-actions",children:c?e.jsx(R,{size:"small",message:"送信中..."}):e.jsx("button",{className:"button-primary",onClick:te,disabled:!m||!s,children:t("chatTester.send")})})]}),w&&e.jsxs("div",{className:"tester-response",children:[e.jsx("h2",{children:t("chatTester.response")}),w.request_id&&e.jsx("div",{className:"response-meta",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Request ID:"})," ",e.jsx("code",{children:w.request_id})]})}),e.jsxs("div",{className:"response-content",children:[e.jsx("h3",{children:"選択された応答:"}),w.choices&&w.choices.length>0&&e.jsxs("div",{className:"choice-item",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",w.choices[0].message.role]}),e.jsx("p",{children:e.jsx("strong",{children:"Content:"})}),e.jsx("pre",{className:"response-text",children:w.choices[0].message.content}),e.jsxs("p",{children:[e.jsx("strong",{children:"Finish Reason:"})," ",w.choices[0].finish_reason]})]}),w.usage&&e.jsxs("div",{className:"response-usage",children:[e.jsx("h4",{children:"使用量:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Prompt Tokens: ",w.usage.prompt_tokens]}),e.jsxs("li",{children:["Completion Tokens: ",w.usage.completion_tokens]}),e.jsxs("li",{children:["Total Tokens: ",w.usage.total_tokens]})]})]})]}),e.jsxs("div",{className:"response-raw",children:[e.jsx("h3",{children:"Raw JSON:"}),e.jsx("pre",{className:"json-display",children:JSON.stringify(w,null,2)})]})]})]})]})};function Mt(t){if(!t||typeof t!="object")return!1;const s=t;return typeof s.version=="string"&&s.data!==null&&typeof s.data=="object"&&"logs"in s.data&&Array.isArray(s.data.logs)}function It(t){if(!t||typeof t!="object")return!1;const s=t;return typeof s.version=="string"&&s.data!==null&&typeof s.data=="object"&&"attempts"in s.data&&Array.isArray(s.data.attempts)}function Lt(t){if(!t||typeof t!="object")return!1;const s=t;return typeof s.version=="string"&&s.data!==null&&typeof s.data=="object"&&"detections"in s.data&&Array.isArray(s.data.detections)}function Rt(t){if(!t||typeof t!="object")return!1;const s=t;return typeof s.version=="string"&&s.data!==null&&typeof s.data=="object"&&"blocked_ips"in s.data&&Array.isArray(s.data.blocked_ips)}function Dt(t){return{id:t.id,requestId:t.request_id,apiKeyId:t.api_key_id,endpoint:t.endpoint,status:t.status,latencyMs:t.latency_ms,eventType:t.event_type,severity:t.severity,ip:t.ip,details:t.details,createdAt:t.created_at}}function Ft(t){const s={};return t.eventType&&(s.event_type=t.eventType),t.severity&&(s.severity=t.severity),t.ip&&(s.ip=t.ip),t.limit!==void 0&&(s.limit=t.limit),t.offset!==void 0&&(s.offset=t.offset),s}async function Ot(t={}){const s=Ft(t),r=await I("ipc_security_audit_logs",Object.keys(s).length>0?s:void 0);return!Mt(r)||!r.data?.logs?[]:r.data.logs.map(Dt)}function Ut(t){return{id:t.id,ip:t.ip,pattern:t.pattern,score:t.score,requestPath:t.request_path,userAgent:t.user_agent,method:t.method,createdAt:t.created_at}}function $t(t){const s={};return t.ip&&(s.ip=t.ip),t.minScore!==void 0&&(s.min_score=t.minScore),t.limit!==void 0&&(s.limit=t.limit),t.offset!==void 0&&(s.offset=t.offset),s}async function Bt(t={}){const s=$t(t),r=await I("ipc_security_intrusion",Object.keys(s).length>0?s:void 0);return!It(r)||!r.data?.attempts?[]:r.data.attempts.map(Ut)}function qt(t){return{id:t.id,ip:t.ip,anomalyType:t.anomaly_type,score:t.score,details:t.details,createdAt:t.created_at}}function Ht(t){const s={};return t.ip&&(s.ip=t.ip),t.anomalyType&&(s.anomaly_type=t.anomalyType),t.limit!==void 0&&(s.limit=t.limit),t.offset!==void 0&&(s.offset=t.offset),s}async function Jt(t={}){const s=Ht(t),r=await I("ipc_security_anomaly",Object.keys(s).length>0?s:void 0);return!Lt(r)||!r.data?.detections?[]:r.data.detections.map(qt)}function Wt(t){return{ip:t.ip,failureCount:t.failure_count,firstFailureAt:t.first_failure_at,blockedUntil:t.blocked_until,permanentBlock:t.permanent_block,lastAttempt:t.last_attempt}}async function zt(){const t=await I("ipc_security_ip_blocklist_list");return!Rt(t)||!t.data?.blocked_ips?[]:t.data.blocked_ips.map(Wt)}async function Vt(t){await I("ipc_security_ip_blocklist_unblock",{ip:t})}async function Kt(){await I("ipc_security_ip_blocklist_clear")}function Gt(t){if(!t||typeof t!="object")return!1;const s=t;return typeof s.version=="string"&&s.data!==null&&typeof s.data=="object"&&"whitelisted_ips"in s.data&&Array.isArray(s.data.whitelisted_ips)}function Yt(t){return{ip:t.ip,addedAt:t.added_at}}async function Xt(){const t=await I("ipc_security_ip_whitelist_list");return!Gt(t)||!t.data?.whitelisted_ips?[]:t.data.whitelisted_ips.map(Yt)}async function Qt(t){await I("ipc_security_ip_whitelist_add",{ip:t})}async function Zt(t){await I("ipc_security_ip_whitelist_remove",{ip:t})}const es=()=>{const[t,s]=a.useState([]),[r,n]=a.useState(!0),[o,m]=a.useState(null),[u,f]=a.useState(""),[g,y]=a.useState(""),[x,b]=a.useState(""),[P,N]=a.useState(1),[S]=a.useState(50),T=a.useMemo(()=>F({defaultMessage:"監査ログの取得に失敗しました",showStderr:!0}),[]),_=a.useCallback(async()=>{n(!0),m(null);try{const l={eventType:u.trim()||void 0,severity:g.trim()||void 0,ip:x.trim()||void 0,limit:S,offset:(P-1)*S},E=await Ot(l);s(E)}catch(l){const E=T(l);E.shouldShow&&m(E.message)}finally{n(!1)}},[u,g,x,P,S,T]);a.useEffect(()=>{_()},[_]);const w=()=>{N(1),_()},h=()=>{f(""),y(""),b(""),N(1)},c=l=>{if(!l)return"";switch(l.toLowerCase()){case"critical":return"severity-critical";case"high":return"severity-high";case"medium":return"severity-medium";case"low":return"severity-low";default:return""}},d=l=>l>=200&&l<300?"status-success":l>=400&&l<500?"status-client-error":l>=500?"status-server-error":"status-info",i=()=>{const l=["ID","Request ID","Endpoint","Status","Severity","IP","Event Type","Created At"],E=t.map(D=>[D.id.toString(),D.requestId,D.endpoint,D.status.toString(),D.severity||"",D.ip||"",D.eventType||"",D.createdAt]),k=[l.join(","),...E.map(D=>D.map(K=>`"${K}"`).join(","))].join(`
`),p=new Blob([k],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a"),M=URL.createObjectURL(p);j.href=M,j.download=`audit-logs-${new Date().toISOString()}.csv`,j.click(),setTimeout(()=>URL.revokeObjectURL(M),100)},C=()=>{const l=JSON.stringify(t,null,2),E=new Blob([l],{type:"application/json"}),k=document.createElement("a"),p=URL.createObjectURL(E);k.href=p,k.download=`audit-logs-${new Date().toISOString()}.json`,k.click(),setTimeout(()=>URL.revokeObjectURL(p),100)};return r&&t.length===0?e.jsx(R,{size:"medium",message:"読み込み中..."}):e.jsxs("div",{className:"audit-logs-view",children:[e.jsxs("div",{className:"filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"event-type-filter",children:"イベントタイプ:"}),e.jsx("input",{id:"event-type-filter",type:"text",className:"form-input",value:u,onChange:l=>f(l.target.value),placeholder:"例: auth_failure, intrusion"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"severity-filter",children:"重要度:"}),e.jsxs("select",{id:"severity-filter",className:"form-select",value:g,onChange:l=>y(l.target.value),children:[e.jsx("option",{value:"",children:"すべて"}),e.jsx("option",{value:"low",children:"低"}),e.jsx("option",{value:"medium",children:"中"}),e.jsx("option",{value:"high",children:"高"}),e.jsx("option",{value:"critical",children:"緊急"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"ip-filter",children:"IPアドレス:"}),e.jsx("input",{id:"ip-filter",type:"text",className:"form-input",value:x,onChange:l=>b(l.target.value),placeholder:"例: 192.168.1.1"})]}),e.jsxs("div",{className:"filter-actions",children:[e.jsx("button",{className:"button-primary",onClick:w,children:"フィルター適用"}),e.jsx("button",{className:"button-secondary",onClick:h,children:"クリア"})]})]}),e.jsxs("div",{className:"page-actions",children:[e.jsx("button",{className:"button-primary",onClick:_,children:"更新"}),e.jsx("button",{className:"button-secondary",onClick:i,children:"CSVエクスポート"}),e.jsx("button",{className:"button-secondary",onClick:C,children:"JSONエクスポート"})]}),o&&e.jsx(O,{message:o,onDismiss:()=>m(null)}),e.jsx("div",{className:"audit-logs-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Request ID"}),e.jsx("th",{children:"エンドポイント"}),e.jsx("th",{children:"ステータス"}),e.jsx("th",{children:"重要度"}),e.jsx("th",{children:"IPアドレス"}),e.jsx("th",{children:"イベントタイプ"}),e.jsx("th",{children:"作成日時"})]})}),e.jsx("tbody",{children:t.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.id}),e.jsx("td",{children:l.requestId}),e.jsx("td",{children:l.endpoint}),e.jsx("td",{className:d(l.status),children:l.status}),e.jsx("td",{className:c(l.severity),children:l.severity||"-"}),e.jsx("td",{children:l.ip||"-"}),e.jsx("td",{children:l.eventType||"-"}),e.jsx("td",{children:q(l.createdAt)})]},l.id))})]})}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"button-secondary",onClick:()=>N(l=>Math.max(1,l-1)),disabled:P===1,children:"前へ"}),e.jsxs("span",{children:["ページ ",P]}),e.jsx("button",{className:"button-secondary",onClick:()=>N(l=>l+1),disabled:t.length<S,children:"次へ"})]})]})},ts=()=>{const[t,s]=a.useState([]),[r,n]=a.useState(!0),[o,m]=a.useState(null),[u,f]=a.useState(""),[g,y]=a.useState(""),[x,b]=a.useState(1),[P]=a.useState(50),N=a.useMemo(()=>F({defaultMessage:"侵入検知イベントの取得に失敗しました",showStderr:!0}),[]),S=a.useCallback(async()=>{n(!0),m(null);try{const d={ip:u.trim()||void 0,minScore:g?(()=>{const C=parseInt(g,10);return isNaN(C)?void 0:C})():void 0,limit:P,offset:(x-1)*P},i=await Bt(d);s(i)}catch(d){const i=N(d);i.shouldShow&&m(i.message)}finally{n(!1)}},[u,g,x,P,N]);a.useEffect(()=>{S()},[S]);const T=()=>{b(1),S()},_=()=>{f(""),y(""),b(1)},w=d=>d>=100?"score-critical":d>=50?"score-high":d>=20?"score-medium":"score-low",h=()=>{const d=["ID","IP","Pattern","Score","Request Path","Method","User Agent","Created At"],i=t.map(p=>[p.id,p.ip,p.pattern,p.score.toString(),p.requestPath||"",p.method||"",p.userAgent||"",p.createdAt]),C=[d.join(","),...i.map(p=>p.map(j=>`"${j}"`).join(","))].join(`
`),l=new Blob([C],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a"),k=URL.createObjectURL(l);E.href=k,E.download=`intrusion-events-${new Date().toISOString()}.csv`,E.click(),setTimeout(()=>URL.revokeObjectURL(k),100)},c=()=>{const d=JSON.stringify(t,null,2),i=new Blob([d],{type:"application/json"}),C=document.createElement("a"),l=URL.createObjectURL(i);C.href=l,C.download=`intrusion-events-${new Date().toISOString()}.json`,C.click(),setTimeout(()=>URL.revokeObjectURL(l),100)};return r&&t.length===0?e.jsx(R,{size:"medium",message:"読み込み中..."}):e.jsxs("div",{className:"intrusion-events-view",children:[e.jsxs("div",{className:"filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"ip-filter",children:"IPアドレス:"}),e.jsx("input",{id:"ip-filter",type:"text",className:"form-input",value:u,onChange:d=>f(d.target.value),placeholder:"例: 192.168.1.1"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"min-score-filter",children:"最小スコア:"}),e.jsx("input",{id:"min-score-filter",type:"number",className:"form-input",value:g,onChange:d=>y(d.target.value),placeholder:"例: 50"})]}),e.jsxs("div",{className:"filter-actions",children:[e.jsx("button",{className:"button-primary",onClick:T,children:"フィルター適用"}),e.jsx("button",{className:"button-secondary",onClick:_,children:"クリア"})]})]}),e.jsxs("div",{className:"page-actions",children:[e.jsx("button",{className:"button-primary",onClick:S,children:"更新"}),e.jsx("button",{className:"button-secondary",onClick:h,children:"CSVエクスポート"}),e.jsx("button",{className:"button-secondary",onClick:c,children:"JSONエクスポート"})]}),o&&e.jsx(O,{message:o,onDismiss:()=>m(null)}),e.jsx("div",{className:"intrusion-events-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"IPアドレス"}),e.jsx("th",{children:"パターン"}),e.jsx("th",{children:"スコア"}),e.jsx("th",{children:"リクエストパス"}),e.jsx("th",{children:"メソッド"}),e.jsx("th",{children:"User Agent"}),e.jsx("th",{children:"作成日時"})]})}),e.jsx("tbody",{children:t.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.id}),e.jsx("td",{children:d.ip}),e.jsx("td",{children:d.pattern}),e.jsx("td",{className:w(d.score),children:d.score}),e.jsx("td",{children:d.requestPath||"-"}),e.jsx("td",{children:d.method||"-"}),e.jsx("td",{children:d.userAgent||"-"}),e.jsx("td",{children:q(d.createdAt)})]},d.id))})]})}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"button-secondary",onClick:()=>b(d=>Math.max(1,d-1)),disabled:x===1,children:"前へ"}),e.jsxs("span",{children:["ページ ",x]}),e.jsx("button",{className:"button-secondary",onClick:()=>b(d=>d+1),disabled:t.length<P,children:"次へ"})]})]})},ss=()=>{const[t,s]=a.useState([]),[r,n]=a.useState(!0),[o,m]=a.useState(null),[u,f]=a.useState(""),[g,y]=a.useState(""),[x,b]=a.useState(1),[P]=a.useState(50),N=a.useMemo(()=>F({defaultMessage:"異常検知イベントの取得に失敗しました",showStderr:!0}),[]),S=a.useCallback(async()=>{n(!0),m(null);try{const i={ip:u.trim()||void 0,anomalyType:g.trim()||void 0,limit:P,offset:(x-1)*P},C=await Jt(i);s(C)}catch(i){const C=N(i);C.shouldShow&&m(C.message)}finally{n(!1)}},[u,g,x,P,N]);a.useEffect(()=>{S()},[S]);const T=()=>{b(1),S()},_=()=>{f(""),y(""),b(1)},w=i=>i>=200?"score-critical":i>=100?"score-high":i>=50?"score-medium":"score-low",h=i=>({high_request_rate_1s:"高リクエストレート (1秒)",high_request_rate_1m:"高リクエストレート (1分)",large_request_body:"大きなリクエストボディ",long_request_duration:"長時間リクエスト",non_existent_endpoint_access:"存在しないエンドポイントアクセス",repeated_request_pattern:"繰り返しリクエストパターン"})[i]||i,c=()=>{const i=["ID","IP","Anomaly Type","Score","Details","Created At"],C=t.map(j=>[j.id,j.ip,j.anomalyType,j.score.toString(),j.details||"",j.createdAt]),l=[i.join(","),...C.map(j=>j.map(M=>`"${M}"`).join(","))].join(`
`),E=new Blob([l],{type:"text/csv;charset=utf-8;"}),k=document.createElement("a"),p=URL.createObjectURL(E);k.href=p,k.download=`anomaly-events-${new Date().toISOString()}.csv`,k.click(),setTimeout(()=>URL.revokeObjectURL(p),100)},d=()=>{const i=JSON.stringify(t,null,2),C=new Blob([i],{type:"application/json"}),l=document.createElement("a"),E=URL.createObjectURL(C);l.href=E,l.download=`anomaly-events-${new Date().toISOString()}.json`,l.click(),setTimeout(()=>URL.revokeObjectURL(E),100)};return r&&t.length===0?e.jsx(R,{size:"medium",message:"読み込み中..."}):e.jsxs("div",{className:"anomaly-events-view",children:[e.jsxs("div",{className:"filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"ip-filter",children:"IPアドレス:"}),e.jsx("input",{id:"ip-filter",type:"text",className:"form-input",value:u,onChange:i=>f(i.target.value),placeholder:"例: 192.168.1.1"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"anomaly-type-filter",children:"異常タイプ:"}),e.jsx("input",{id:"anomaly-type-filter",type:"text",className:"form-input",value:g,onChange:i=>y(i.target.value),placeholder:"例: high_request_rate_1s"})]}),e.jsxs("div",{className:"filter-actions",children:[e.jsx("button",{className:"button-primary",onClick:T,children:"フィルター適用"}),e.jsx("button",{className:"button-secondary",onClick:_,children:"クリア"})]})]}),e.jsxs("div",{className:"page-actions",children:[e.jsx("button",{className:"button-primary",onClick:S,children:"更新"}),e.jsx("button",{className:"button-secondary",onClick:c,children:"CSVエクスポート"}),e.jsx("button",{className:"button-secondary",onClick:d,children:"JSONエクスポート"})]}),o&&e.jsx(O,{message:o,onDismiss:()=>m(null)}),e.jsx("div",{className:"anomaly-events-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"IPアドレス"}),e.jsx("th",{children:"異常タイプ"}),e.jsx("th",{children:"スコア"}),e.jsx("th",{children:"詳細"}),e.jsx("th",{children:"作成日時"})]})}),e.jsx("tbody",{children:t.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:i.id}),e.jsx("td",{children:i.ip}),e.jsx("td",{children:h(i.anomalyType)}),e.jsx("td",{className:w(i.score),children:i.score}),e.jsx("td",{children:i.details||"-"}),e.jsx("td",{children:q(i.createdAt)})]},i.id))})]})}),e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"button-secondary",onClick:()=>b(i=>Math.max(1,i-1)),disabled:x===1,children:"前へ"}),e.jsxs("span",{children:["ページ ",x]}),e.jsx("button",{className:"button-secondary",onClick:()=>b(i=>i+1),disabled:t.length<P,children:"次へ"})]})]})},rs=()=>{const{t}=U(),[s,r]=a.useState("audit");return e.jsxs("div",{className:"security-events",children:[e.jsx("div",{className:"page-header",children:e.jsx("h1",{children:t("security.title")})}),e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:`tab ${s==="audit"?"active":""}`,onClick:()=>r("audit"),children:t("security.auditLogs")}),e.jsx("button",{className:`tab ${s==="intrusion"?"active":""}`,onClick:()=>r("intrusion"),children:t("security.intrusionDetection")}),e.jsx("button",{className:`tab ${s==="anomaly"?"active":""}`,onClick:()=>r("anomaly"),children:t("security.anomalyDetection")})]}),e.jsxs("div",{className:"tab-content",children:[s==="audit"&&e.jsx(es,{}),s==="intrusion"&&e.jsx(ts,{}),s==="anomaly"&&e.jsx(ss,{})]})]})},le=J.memo(({message:t,onConfirm:s,onCancel:r,confirmText:n="確認",cancelText:o="キャンセル",danger:m=!1})=>{const u=f=>{f.key==="Escape"?r():f.key==="Enter"&&f.target===f.currentTarget&&s()};return a.useEffect(()=>{const f=g=>{g.key==="Escape"&&r()};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[r]),e.jsx("div",{className:"confirm-dialog-overlay",onClick:r,role:"dialog","aria-modal":"true","aria-labelledby":"confirm-dialog-message",children:e.jsxs("div",{className:"confirm-dialog",onClick:f=>f.stopPropagation(),onKeyDown:u,tabIndex:-1,children:[e.jsx("div",{className:"confirm-dialog-content",children:e.jsx("p",{id:"confirm-dialog-message",children:t})}),e.jsxs("div",{className:"confirm-dialog-actions",children:[e.jsx("button",{className:`button-secondary ${m?"button-danger":""}`,onClick:r,autoFocus:!0,children:o}),e.jsx("button",{className:`button-primary ${m?"button-danger":""}`,onClick:s,children:n})]})]})})});le.displayName="ConfirmDialog";const as=()=>{const{t}=U(),[s,r]=a.useState([]),[n,o]=a.useState(!0),[m,u]=a.useState(null),[f,g]=a.useState(null),[y,x]=a.useState(null),b=a.useMemo(()=>F({defaultMessage:t("security.fetchError")}),[t]),P=a.useMemo(()=>F({defaultMessage:t("security.unblockError")}),[t]),N=a.useMemo(()=>F({defaultMessage:t("security.clearTemporaryError")}),[t]),S=a.useCallback(async()=>{o(!0),u(null);try{const c=await zt();r(c)}catch(c){const d=b(c);d.shouldShow&&u(d.message)}finally{o(!1)}},[b]);a.useEffect(()=>{S()},[S]);const T=a.useCallback(async c=>{x({message:t("security.unblockConfirm",{ip:c}),onConfirm:async()=>{x(null),u(null),g(null);try{await Vt(c),g(t("security.unblockSuccess",{ip:c})),await S()}catch(d){const i=P(d);i.shouldShow&&u(i.message)}}})},[S,P,t]),_=a.useCallback(()=>{x({message:t("security.clearTemporaryConfirm"),onConfirm:async()=>{x(null),u(null),g(null);try{await Kt(),g(t("security.clearTemporarySuccess")),await S()}catch(c){const d=N(c);d.shouldShow&&u(d.message)}}})},[S,N,t]),w=a.useMemo(()=>s.filter(c=>c.permanentBlock),[s]),h=a.useMemo(()=>s.filter(c=>!c.permanentBlock),[s]);return n?e.jsx("div",{className:"ip-blocklist-management",children:e.jsx(R,{size:"medium",message:"読み込み中..."})}):e.jsxs("div",{className:"ip-blocklist-management",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:t("security.ipBlocklistManagement")}),e.jsxs("div",{className:"page-actions",children:[h.length>0&&e.jsx("button",{className:"button-secondary",onClick:_,children:t("security.clearAllTemporary")}),e.jsx("button",{className:"button-primary",onClick:S,children:t("security.refresh")})]})]}),m&&e.jsx(O,{message:m,onDismiss:()=>u(null)}),f&&e.jsx(W,{message:f,onDismiss:()=>g(null),autoDismiss:B.MESSAGE_AUTO_DISMISS_MS}),y&&e.jsx(le,{message:y.message,onConfirm:y.onConfirm,onCancel:()=>x(null),danger:y.danger}),e.jsxs("div",{className:"blocklist-summary",children:[e.jsxs("div",{className:"summary-item",children:[e.jsxs("span",{className:"summary-label",children:[t("security.totalBlocks"),":"]}),e.jsx("span",{className:"summary-value",children:s.length})]}),e.jsxs("div",{className:"summary-item",children:[e.jsxs("span",{className:"summary-label",children:[t("security.permanentBlocks"),":"]}),e.jsx("span",{className:"summary-value",children:w.length})]}),e.jsxs("div",{className:"summary-item",children:[e.jsxs("span",{className:"summary-label",children:[t("security.temporaryBlocks"),":"]}),e.jsx("span",{className:"summary-value",children:h.length})]})]}),s.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:t("security.noBlockedIps")})}):e.jsx("div",{className:"blocklist-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t("security.ipAddress")}),e.jsx("th",{children:t("security.failureCount")}),e.jsx("th",{children:t("security.firstFailureAt")}),e.jsx("th",{children:t("security.blockedUntil")}),e.jsx("th",{children:t("security.lastAttempt")}),e.jsx("th",{children:t("security.type")}),e.jsx("th",{children:t("common.actions")})]})}),e.jsx("tbody",{children:s.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{children:c.ip})}),e.jsx("td",{children:c.failureCount}),e.jsx("td",{children:q(c.firstFailureAt)}),e.jsx("td",{children:c.blockedUntil?q(c.blockedUntil):t("security.permanent")}),e.jsx("td",{children:q(c.lastAttempt)}),e.jsx("td",{children:e.jsx("span",{className:`block-type ${c.permanentBlock?"permanent":"temporary"}`,children:c.permanentBlock?t("security.permanent"):t("security.temporary")})}),e.jsx("td",{children:e.jsx("button",{className:"button-danger-small",onClick:()=>T(c.ip),disabled:c.permanentBlock,title:c.permanentBlock?t("security.cannotUnblockPermanent"):t("security.unblock"),children:t("security.unblock")})})]},c.ip))})]})})]})},ns=()=>{const{t}=U(),[s,r]=a.useState([]),[n,o]=a.useState(!0),[m,u]=a.useState(null),[f,g]=a.useState(null),[y,x]=a.useState(""),[b,P]=a.useState(!1),[N,S]=a.useState(null),T=a.useCallback(l=>F({defaultMessage:t("security.fetchError")||"Failed to fetch whitelisted IPs"})(l),[t]),_=a.useCallback(l=>F({defaultMessage:t("security.addWhitelistError")||"Failed to add IP to whitelist"})(l),[t]),w=a.useCallback(l=>F({defaultMessage:t("security.removeWhitelistError")||"Failed to remove IP from whitelist"})(l),[t]),h=a.useCallback(async()=>{o(!0),u(null);try{const l=await Xt();r(l)}catch(l){const E=T(l);E.shouldShow&&u(E.message)}finally{o(!1)}},[T]);a.useEffect(()=>{h()},[h]);const c=l=>{const E=l.trim();if(!E)return!1;if(E.includes("/")){const[k,p]=E.split("/"),j=parseInt(p,10);return isNaN(j)||j<0||j>128?!1:d(k)}return d(E)},d=l=>{const E=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,k=/^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::1$|^::$|^(?:[0-9a-fA-F]{1,4}:)*::(?:[0-9a-fA-F]{1,4}:)*[0-9a-fA-F]{1,4}$/;return E.test(l)||k.test(l)},i=a.useCallback(async()=>{const l=y.trim();if(!l){u(t("security.ipRequired")||"IP address or CIDR is required");return}if(!c(l)){u(t("security.invalidIpFormat")||"Invalid IP address or CIDR format. Please enter a valid IPv4/IPv6 address or CIDR notation (e.g., 192.168.1.0/24)");return}P(!0),u(null),g(null);try{await Qt(l),g(t("security.addWhitelistSuccess",{ip:l})||`IP ${l} added to whitelist successfully`),x(""),await h()}catch(E){const k=_(E);k.shouldShow&&u(k.message)}finally{P(!1)}},[y,h,_,t]),C=a.useCallback(l=>{S({message:t("security.removeWhitelistConfirm",{ip:l})||`Remove ${l} from whitelist?`,onConfirm:async()=>{S(null),u(null),g(null);try{await Zt(l),g(t("security.removeWhitelistSuccess",{ip:l})||`IP ${l} removed from whitelist successfully`),await h()}catch(E){const k=w(E);k.shouldShow&&u(k.message)}},danger:!0})},[h,w,t]);return n&&s.length===0?e.jsx("div",{className:"ip-whitelist-management",children:e.jsx(R,{size:"medium",message:t("common.loading")||"読み込み中..."})}):e.jsxs("div",{className:"ip-whitelist-management",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:t("security.ipWhitelistManagement")||"IP Whitelist Management"}),e.jsx("div",{className:"page-actions",children:e.jsx("button",{className:"button-primary",onClick:h,children:t("security.refresh")||"Refresh"})})]}),m&&e.jsx(O,{message:m,onDismiss:()=>u(null)}),f&&e.jsx(W,{message:f,onDismiss:()=>g(null),autoDismiss:B.MESSAGE_AUTO_DISMISS_MS}),N&&e.jsx(le,{message:N.message,onConfirm:N.onConfirm,onCancel:()=>S(null),danger:N.danger}),e.jsx("div",{className:"whitelist-summary",children:e.jsxs("div",{className:"summary-item",children:[e.jsxs("span",{className:"summary-label",children:[t("security.totalWhitelisted")||"Total Whitelisted",":"]}),e.jsx("span",{className:"summary-value",children:s.length})]})}),e.jsxs("div",{className:"add-ip-section",children:[e.jsx("h2",{children:t("security.addIpToWhitelist")||"Add IP to Whitelist"}),e.jsxs("div",{className:"add-ip-form",children:[e.jsx("input",{type:"text",value:y,onChange:l=>x(l.target.value),placeholder:t("security.ipOrCidrPlaceholder")||"e.g., 192.168.1.0/24 or 10.0.0.1",className:"ip-input",disabled:b,onKeyPress:l=>{l.key==="Enter"&&i()}}),e.jsx("button",{className:"button-primary",onClick:i,disabled:b||!y.trim(),children:b?t("common.adding")||"Adding...":t("security.add")||"Add"})]}),e.jsx("small",{className:"form-hint",children:t("security.ipWhitelistHint")||"Enter an IP address (IPv4 or IPv6) or CIDR notation (e.g., 192.168.1.0/24)"})]}),s.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:t("security.noWhitelistedIps")||"No IPs in whitelist"})}):e.jsx("div",{className:"whitelist-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t("security.ipAddress")||"IP Address / CIDR"}),e.jsx("th",{children:t("security.addedAt")||"Added At"}),e.jsx("th",{children:t("common.actions")||"Actions"})]})}),e.jsx("tbody",{children:s.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{children:l.ip})}),e.jsx("td",{children:q(l.addedAt)}),e.jsx("td",{children:e.jsx("button",{className:"button-danger-small",onClick:()=>C(l.ip),disabled:n,children:t("security.remove")||"Remove"})})]},l.ip))})]})})]})},ls=()=>{const{locale:t,setLocale:s,t:r}=U(),{theme:n,setTheme:o,toggleTheme:m}=lt(),[u,f]=a.useState(!1),[g,y]=a.useState(null),[x,b]=a.useState(null),[P,N]=a.useState(t);a.useEffect(()=>{N(t)},[t]);const S=async _=>{f(!0),y(null),b(null);try{await s(_),N(_);const w=r(_==="ja"?"settings.japanese":"settings.english");b(r("messages.languageChanged",{locale:w})),setTimeout(()=>b(null),3e3)}catch(w){const h=w instanceof Error?w.message:String(w);y(r("errors.generic")+": "+h)}finally{f(!1)}},T=async _=>{f(!0),y(null),b(null);try{await o(_),b(`Theme changed to ${_}`),setTimeout(()=>b(null),3e3)}catch(w){const h=w instanceof Error?w.message:String(w);y("Failed to change theme: "+h)}finally{f(!1)}};return e.jsxs("div",{className:"settings-page",children:[e.jsx("h1",{children:r("settings.title")}),g&&e.jsx(O,{message:g,onDismiss:()=>y(null)}),x&&e.jsx(W,{message:x,onDismiss:()=>b(null)}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h2",{children:r("settings.language")}),e.jsxs("div",{className:"settings-field",children:[e.jsx("label",{htmlFor:"language-select",children:r("settings.displayLanguage")}),e.jsxs("select",{id:"language-select",value:P,onChange:_=>S(_.target.value),disabled:u,"aria-label":r("settings.displayLanguage"),children:[e.jsx("option",{value:"ja",children:r("settings.japanese")}),e.jsx("option",{value:"en",children:r("settings.english")})]}),u&&e.jsx(R,{size:"small"})]}),e.jsx("p",{className:"settings-hint",children:r("settings.languageHint",{current:r(P==="ja"?"settings.japanese":"settings.english")})})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h2",{children:"Theme"}),e.jsxs("div",{className:"settings-field",children:[e.jsx("label",{htmlFor:"theme-select",children:"Appearance"}),e.jsxs("select",{id:"theme-select",value:n,onChange:_=>T(_.target.value),disabled:u,"aria-label":"Theme selection",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]}),u&&e.jsx(R,{size:"small"})]}),e.jsxs("p",{className:"settings-hint",children:["Current theme: ",n==="light"?"Light":"Dark"]})]})]})},is=()=>{const{t}=U(),[s,r]=a.useState(!1),[n,o]=a.useState(null),[m,u]=a.useState(null),[f,g]=a.useState(""),[y,x]=a.useState([8080,8081]),[b,P]=a.useState([]),[N,S]=a.useState(""),[T,_]=a.useState(""),[w,h]=a.useState(""),[c,d]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const j=await I("get_platform"),M=typeof j=="string"?JSON.parse(j):j,D=M?.os||M||j;g(String(D).toLowerCase())}catch(j){console.error("Failed to detect OS:",j),navigator.platform.toLowerCase().includes("win")?g("windows"):navigator.platform.toLowerCase().includes("mac")?g("macos"):g("linux")}})()},[]);const i=async()=>{r(!0),o(null),u(null);try{const j=await I("system_firewall_preview",{os:f,ports:y,ip_whitelist:b});S(j.script),_(j.shell),h(j.display_name)}catch(p){const j=p instanceof Error?p.message:String(p);o(`Failed to generate firewall script: ${j}`)}finally{r(!1)}},C=async()=>{if(!N||!T){o("Please generate a firewall script preview first");return}r(!0),o(null),u(null);try{const j=await I("system_firewall_apply",{script:N,shell:T});j.exit_code===0?(u("Firewall rules applied successfully"),d(!0)):o(`Firewall application failed (exit code: ${j.exit_code})
${j.stderr}`)}catch(p){const j=p instanceof Error?p.message:String(p);o(`Failed to apply firewall script: ${j}`)}finally{r(!1)}},l=async()=>{r(!0),o(null),u(null);try{const p=await I("system_firewall_rollback",{os:f});p.exit_code===0?(u("Firewall rules rolled back successfully"),d(!1)):o(`Firewall rollback failed (exit code: ${p.exit_code})
${p.stderr}`)}catch(p){const j=p instanceof Error?p.message:String(p);o(`Failed to rollback firewall script: ${j}`)}finally{r(!1)}},E=()=>{navigator.clipboard.writeText(N),u("Script copied to clipboard"),setTimeout(()=>u(null),2e3)},k=()=>{const p=new Blob([N],{type:"text/plain"}),j=URL.createObjectURL(p),M=document.createElement("a");M.href=j,M.download=`firewall-script-${Date.now()}.${T==="powershell"?"ps1":"sh"}`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(j),u("Script saved to file"),setTimeout(()=>u(null),2e3)};return e.jsxs("div",{className:"setup-wizard-page",children:[e.jsx("h1",{children:"Setup Wizard - Firewall Configuration"}),n&&e.jsx(O,{message:n,onDismiss:()=>o(null)}),m&&e.jsx(W,{message:m,onDismiss:()=>u(null)}),e.jsxs("div",{className:"firewall-config-section",children:[e.jsx("h2",{children:"Configuration"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Operating System:"}),e.jsx("input",{type:"text",value:f,readOnly:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ports (comma-separated):"}),e.jsx("input",{type:"text",value:y.join(", "),onChange:p=>{const j=p.target.value.split(",").map(M=>parseInt(M.trim(),10)).filter(M=>!isNaN(M));x(j)},className:"form-input",placeholder:"8080, 8081"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"IP Whitelist (comma-separated, optional):"}),e.jsx("input",{type:"text",value:b.join(", "),onChange:p=>{const j=p.target.value.split(",").map(M=>M.trim()).filter(M=>M.length>0);P(j)},className:"form-input",placeholder:"203.0.113.0/24, 2001:db8::/48"})]}),e.jsx("button",{onClick:i,disabled:s||y.length===0,className:"btn btn-primary",children:"Generate Script Preview"})]}),N&&e.jsxs("div",{className:"firewall-preview-section",children:[e.jsx("h2",{children:"Script Preview"}),e.jsx("div",{className:"script-info",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Shell:"})," ",w]})}),e.jsx("div",{className:"script-preview",children:e.jsx("pre",{children:N})}),e.jsxs("div",{className:"script-actions",children:[e.jsx("button",{onClick:E,className:"btn btn-secondary",children:"Copy Script"}),e.jsx("button",{onClick:k,className:"btn btn-secondary",children:"Save Script"}),e.jsx("button",{onClick:C,disabled:s||c,className:"btn btn-primary",children:"Apply Script (Requires Admin)"}),c&&e.jsx("button",{onClick:l,disabled:s,className:"btn btn-danger",children:"Rollback"})]})]}),s&&e.jsx(R,{})]})};async function os(t){try{const s=t?{engine:t.engine,model:t.model}:void 0,r=await I("ipc_model_profiles_list",s?{payload:s}:void 0);return r.data?.profiles?r.data.profiles:[]}catch(s){throw V.error("Failed to fetch model profiles:",s),new Error(s instanceof Error?s.message:"Failed to fetch model profiles")}}async function cs(t){try{const s=JSON.stringify(t.parameters),r=await I("ipc_model_profiles_save",{payload:{engine:t.engineId,model:t.modelId,label:t.label,params_json:s}});if(r.data?.profile)return r.data.profile;throw new Error("Invalid response from save model profile")}catch(s){throw V.error("Failed to save model profile:",s),new Error(s instanceof Error?s.message:"Failed to save model profile")}}async function ds(t){try{await I("ipc_model_profiles_delete",{payload:{id:t}})}catch(s){throw V.error("Failed to delete model profile:",s),new Error(s instanceof Error?s.message:"Failed to delete model profile")}}const us=({engineId:t,modelId:s,parameters:r,onChange:n,onError:o})=>{const{t:m}=U(),[u,f]=a.useState(!1),[g,y]=a.useState(null),[x,b]=a.useState(null),[P,N]=a.useState(r);a.useEffect(()=>{N(r)},[r]);const S=a.useCallback(async()=>{if(t){f(!0),y(null);try{const h=await I("ipc_detect_engines",{fresh:!1});let c=null;if(h&&"data"in h&&h.data){const d=h.data.engines;if(Array.isArray(d)){const i=d.find(C=>C.id===t);i&&"capabilities"in i&&(c={id:i.id,name:i.name||i.id,parameters:ms(i.capabilities)})}}c||(c=ge(t)),b(c)}catch(h){const c=h instanceof Error?h.message:"Failed to load engine capabilities";y(c),o&&o(c),b(ge(t))}finally{f(!1)}}},[t,o]);a.useEffect(()=>{S()},[S]);const T=(h,c)=>{const d={...P,[h]:c};N(d),n(d)},_=(h,c,d)=>{const i=`param-${h}`,C=d!==void 0?d:c.default;switch(c.type){case"boolean":return e.jsxs("div",{className:"parameter-field",children:[e.jsxs("label",{htmlFor:i,className:"parameter-label",children:[h,c.required&&e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{id:i,type:"checkbox",checked:C===!0,onChange:l=>T(h,l.target.checked),className:"parameter-input parameter-checkbox"}),c.description&&e.jsx("small",{className:"parameter-hint",children:c.description})]},h);case"number":return e.jsxs("div",{className:"parameter-field",children:[e.jsxs("label",{htmlFor:i,className:"parameter-label",children:[h,c.required&&e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{id:i,type:"number",value:C,onChange:l=>T(h,parseFloat(l.target.value)||0),min:c.min,max:c.max,step:"any",className:"parameter-input parameter-number"}),c.description&&e.jsx("small",{className:"parameter-hint",children:c.description})]},h);case"string":return c.enum&&c.enum.length>0?e.jsxs("div",{className:"parameter-field",children:[e.jsxs("label",{htmlFor:i,className:"parameter-label",children:[h,c.required&&e.jsx("span",{className:"required",children:"*"})]}),e.jsx("select",{id:i,value:C||"",onChange:l=>T(h,l.target.value),className:"parameter-input parameter-select",children:c.enum.map(l=>e.jsx("option",{value:String(l),children:String(l)},String(l)))}),c.description&&e.jsx("small",{className:"parameter-hint",children:c.description})]},h):e.jsxs("div",{className:"parameter-field",children:[e.jsxs("label",{htmlFor:i,className:"parameter-label",children:[h,c.required&&e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{id:i,type:"text",value:C||"",onChange:l=>T(h,l.target.value),className:"parameter-input parameter-text"}),c.description&&e.jsx("small",{className:"parameter-hint",children:c.description})]},h);case"array":case"object":return e.jsxs("div",{className:"parameter-field",children:[e.jsxs("label",{htmlFor:i,className:"parameter-label",children:[h,c.required&&e.jsx("span",{className:"required",children:"*"})]}),e.jsx("textarea",{id:i,value:JSON.stringify(C,null,2),onChange:l=>{try{const E=JSON.parse(l.target.value);T(h,E)}catch{}},className:"parameter-input parameter-textarea",rows:4}),c.description&&e.jsx("small",{className:"parameter-hint",children:c.description})]},h);default:return null}};if(u)return e.jsx("div",{className:"model-detail-settings",children:e.jsx(R,{message:m("modelProfiles.loadingCapabilities")||"Loading capabilities..."})});if(g&&!x)return e.jsx("div",{className:"model-detail-settings",children:e.jsx(O,{message:g,onDismiss:()=>y(null)})});if(!x||!x.parameters)return e.jsx("div",{className:"model-detail-settings",children:e.jsx("p",{className:"no-capabilities",children:m("modelProfiles.noCapabilities")||"No parameter definitions available for this engine."})});const w=Object.entries(x.parameters);return e.jsxs("div",{className:"model-detail-settings",children:[g&&e.jsx(O,{message:g,onDismiss:()=>y(null)}),e.jsxs("div",{className:"capabilities-header",children:[e.jsxs("h3",{children:[m("modelProfiles.engineParameters")||"Engine Parameters"," (",x.name,")"]}),e.jsx("p",{className:"capabilities-description",children:m("modelProfiles.parametersDescription")||"Configure engine-specific parameters for this model profile."})]}),e.jsx("div",{className:"parameters-form",children:w.length===0?e.jsx("p",{className:"no-parameters",children:m("modelProfiles.noParameters")||"No parameters defined for this engine."}):w.map(([h,c])=>_(h,c,P[h]))})]})};function ms(t){if(!(!t||typeof t!="object"))try{const s=t,r={};for(const[n,o]of Object.entries(s))if(o&&typeof o=="object"){const m=o;r[n]={type:m.type||"string",description:m.description,default:m.default,min:m.min,max:m.max,enum:m.enum,required:m.required}}return Object.keys(r).length>0?r:void 0}catch{return}}function ge(t){const s={temperature:{type:"number",description:"Sampling temperature (0.0 to 2.0)",default:.7,min:0,max:2},max_tokens:{type:"number",description:"Maximum number of tokens to generate",default:512,min:1,max:4096},top_p:{type:"number",description:"Nucleus sampling parameter (0.0 to 1.0)",default:.9,min:0,max:1},top_k:{type:"number",description:"Top-k sampling parameter",default:40,min:1},frequency_penalty:{type:"number",description:"Frequency penalty (-2.0 to 2.0)",default:0,min:-2,max:2},presence_penalty:{type:"number",description:"Presence penalty (-2.0 to 2.0)",default:0,min:-2,max:2}},n={ollama:{num_ctx:{type:"number",description:"Context window size",default:2048,min:512,max:32768},num_predict:{type:"number",description:"Maximum number of tokens to predict",default:-1,min:-1},repeat_penalty:{type:"number",description:"Repeat penalty",default:1.1,min:0}},vllm:{max_model_len:{type:"number",description:"Maximum model length",default:2048,min:512},gpu_memory_utilization:{type:"number",description:"GPU memory utilization (0.0 to 1.0)",default:.9,min:0,max:1}},"lm-studio":{stop:{type:"array",description:"Stop sequences",default:[]},stream:{type:"boolean",description:"Enable streaming",default:!1}}}[t.toLowerCase()]||{},o={...s,...n};return{id:t,name:t,parameters:o}}const Z=`{
  "temperature": 0.7,
  "max_tokens": 512
}`,hs=()=>{const{t}=U(),[s,r]=a.useState([]),[n,o]=a.useState(!0),[m,u]=a.useState(null),[f,g]=a.useState(null),[y,x]=a.useState(""),[b,P]=a.useState(""),[N,S]=a.useState(""),[T,_]=a.useState(""),[w,h]=a.useState(""),[c,d]=a.useState(Z),[i,C]=a.useState(null),[l,E]=a.useState(!1),[k,p]=a.useState(!1),j=a.useCallback(async()=>{o(!0),u(null);try{const v=await os({engine:y.trim()||void 0,model:b.trim()||void 0});r(v)}catch(v){u(v instanceof Error?v.message:t("modelProfiles.fetchError")||"Failed to fetch model profiles")}finally{o(!1)}},[y,b,t]);a.useEffect(()=>{j()},[j]);const M=()=>{S(""),_(""),h(""),d(Z),C(null),E(!1),p(!1)},D=v=>{C(v.id),S(v.engineId),_(v.modelId),h(v.label),d(JSON.stringify(v.parameters,null,2)||Z),E(!0)},K=v=>{d(JSON.stringify(v,null,2))},ee=async v=>{if(v.preventDefault(),!N.trim()||!T.trim()||!w.trim()){u(t("modelProfiles.requiredFields")||"Required fields are missing");return}let L;try{L=JSON.parse(c)}catch{u(t("modelProfiles.invalidJson")||"Invalid JSON format. Please enter valid JSON.");return}o(!0),u(null);try{await cs({engineId:N.trim(),modelId:T.trim(),label:w.trim(),parameters:L}),g(i?t("modelProfiles.updateSuccess")||"Model profile updated successfully":t("modelProfiles.createSuccess")||"Model profile created successfully"),setTimeout(()=>g(null),3e3),await j(),M()}catch(z){u(z instanceof Error?z.message:t("modelProfiles.saveError")||"Failed to save model profile")}finally{o(!1)}},te=async v=>{if(window.confirm(t("modelProfiles.deleteConfirm",{label:v.label})||`Delete profile "${v.label}"? This action cannot be undone.`)){o(!0),u(null);try{await ds(v.id),g(t("modelProfiles.deleteSuccess")||"Model profile deleted successfully"),setTimeout(()=>g(null),3e3),i===v.id&&M(),await j()}catch(z){u(z instanceof Error?z.message:t("modelProfiles.deleteError")||"Failed to delete model profile")}finally{o(!1)}}},A=s.filter(v=>!(y&&!v.engineId.toLowerCase().includes(y.toLowerCase())||b&&!v.modelId.toLowerCase().includes(b.toLowerCase())));return e.jsxs("div",{className:"model-profiles-page",children:[e.jsx("h1",{children:t("modelProfiles.title")||"Model Profiles"}),e.jsx("p",{className:"page-description",children:t("modelProfiles.description")||"Manage model-specific parameter profiles for different engines."}),m&&e.jsx(O,{message:m,onDismiss:()=>u(null)}),f&&e.jsxs("div",{className:"success-message",children:[f,e.jsx("button",{className:"success-dismiss",onClick:()=>g(null),"aria-label":"Close",children:"×"})]}),e.jsxs("div",{className:"model-profiles-content",children:[e.jsxs("div",{className:"model-profiles-filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"engine-filter",children:t("modelProfiles.filterByEngine")||"Filter by Engine"}),e.jsx("input",{id:"engine-filter",type:"text",value:y,onChange:v=>x(v.target.value),placeholder:t("modelProfiles.enginePlaceholder")||"e.g., ollama"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"model-filter",children:t("modelProfiles.filterByModel")||"Filter by Model"}),e.jsx("input",{id:"model-filter",type:"text",value:b,onChange:v=>P(v.target.value),placeholder:t("modelProfiles.modelPlaceholder")||"e.g., llama3"})]}),e.jsx("button",{className:"btn-primary",onClick:()=>E(!l),disabled:n,children:l?t("common.cancel")||"Cancel":t("modelProfiles.createNew")||"Create New Profile"})]}),l&&e.jsxs("div",{className:"model-profiles-form",children:[e.jsx("h2",{children:i?t("modelProfiles.editProfile")||"Edit Profile":t("modelProfiles.createProfile")||"Create Profile"}),e.jsxs("form",{onSubmit:ee,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"engine-id",children:[t("modelProfiles.engineId")||"Engine ID"," *"]}),e.jsx("input",{id:"engine-id",type:"text",value:N,onChange:v=>S(v.target.value),placeholder:"e.g., ollama",required:!0,disabled:n})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"model-id",children:[t("modelProfiles.modelId")||"Model ID"," *"]}),e.jsx("input",{id:"model-id",type:"text",value:T,onChange:v=>_(v.target.value),placeholder:"e.g., flm://ollama/llama3",required:!0,disabled:n})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"label",children:[t("modelProfiles.label")||"Label"," *"]}),e.jsx("input",{id:"label",type:"text",value:w,onChange:v=>h(v.target.value),placeholder:t("modelProfiles.labelPlaceholder")||"Profile name",required:!0,disabled:n})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("label",{htmlFor:"parameters",children:[t("modelProfiles.parameters")||"Parameters (JSON)"," *"]}),N&&e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>p(!k),disabled:n,style:{fontSize:"0.875rem",padding:"0.25rem 0.75rem"},children:k?t("modelProfiles.hideAdvanced")||"Hide Advanced":t("modelProfiles.showAdvanced")||"Show Advanced Settings"})]}),k&&N&&T?e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsx(us,{engineId:N,modelId:T,parameters:(()=>{try{return JSON.parse(c)}catch{return{}}})(),onChange:K,onError:v=>u(v)})}):null,e.jsx("textarea",{id:"parameters",value:c,onChange:v=>d(v.target.value),rows:k?6:10,required:!0,disabled:n,placeholder:Z}),e.jsx("small",{className:"form-hint",children:t("modelProfiles.parametersHint")||'Enter parameters as JSON. Example: {"temperature": 0.7, "max_tokens": 512}'})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(R,{size:"small"})," ",t("common.loading")||"Loading..."]}):t("common.save")||"Save"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:M,disabled:n,children:t("common.cancel")||"Cancel"})]})]})]}),e.jsxs("div",{className:"model-profiles-list",children:[e.jsx("h2",{children:t("modelProfiles.profilesList")||"Profiles"}),n&&!l?e.jsx(R,{message:t("common.loading")||"Loading..."}):A.length===0?e.jsx("p",{className:"empty-message",children:t("modelProfiles.noProfiles")||"No profiles found"}):e.jsx("div",{className:"profiles-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t("modelProfiles.label")||"Label"}),e.jsx("th",{children:t("modelProfiles.engineId")||"Engine"}),e.jsx("th",{children:t("modelProfiles.modelId")||"Model"}),e.jsx("th",{children:t("modelProfiles.updatedAt")||"Updated"}),e.jsx("th",{children:t("common.actions")||"Actions"})]})}),e.jsx("tbody",{children:A.map(v=>e.jsxs("tr",{children:[e.jsx("td",{children:v.label}),e.jsx("td",{children:v.engineId}),e.jsx("td",{children:v.modelId}),e.jsx("td",{children:q(v.updatedAt)}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn-edit",onClick:()=>D(v),disabled:n,"aria-label":t("common.edit")||"Edit",children:t("common.edit")||"Edit"}),e.jsx("button",{className:"btn-delete",onClick:()=>te(v),disabled:n,"aria-label":t("common.delete")||"Delete",children:t("common.delete")||"Delete"})]})})]},v.id))})]})})]})]})]})};async function ps(t){try{const s=t?{engine:t.engine,model:t.model,hours:t.hours||24,limit:t.limit||100}:{hours:24,limit:100},r=await I("ipc_engines_health_history",{payload:s});return r.data?.logs?r.data.logs:[]}catch(s){throw V.error("Failed to fetch engine health history:",s),new Error(s instanceof Error?s.message:"Failed to fetch engine health history")}}const gs=()=>{const{t}=U(),[s,r]=a.useState([]),[n,o]=a.useState(!0),[m,u]=a.useState(null),[f,g]=a.useState("24h"),[y,x]=a.useState(""),[b,P]=a.useState(""),N={"24h":24,"7d":168,"30d":720},S=a.useCallback(async()=>{o(!0),u(null);try{const h=await ps({engine:y.trim()||void 0,model:b.trim()||void 0,hours:N[f],limit:1e3});r(h)}catch(h){u(h instanceof Error?h.message:t("modelComparison.fetchError")||"Failed to fetch health history")}finally{o(!1)}},[y,b,f,t]);a.useEffect(()=>{S()},[S]);const T=J.useMemo(()=>{if(s.length===0)return null;const h=s.filter(p=>p.status==="healthy").length,c=s.filter(p=>p.status==="degraded").length,d=s.filter(p=>p.status==="unreachable").length,i=s.length,C=i>0?h/i*100:0,l=s.map(p=>p.latency_ms).filter(p=>p!==null),E=l.length>0?l.reduce((p,j)=>p+j,0)/l.length:null,k=s.reduce((p,j)=>p+j.error_rate,0)/s.length;return{total:i,healthy:h,degraded:c,unreachable:d,successRate:C,avgLatency:E,avgErrorRate:k}},[s]),_=J.useMemo(()=>{const h={};for(const c of s)h[c.engine_id]||(h[c.engine_id]=[]),h[c.engine_id].push(c);return h},[s]),w=J.useMemo(()=>{const h={};for(const c of s)c.model_id&&(h[c.model_id]||(h[c.model_id]=[]),h[c.model_id].push(c));return h},[s]);return e.jsxs("div",{className:"model-comparison-page",children:[e.jsx("h1",{children:t("modelComparison.title")||"Model Comparison & Health History"}),e.jsx("p",{className:"page-description",children:t("modelComparison.description")||"View engine health history and compare model performance over time."}),m&&e.jsx(O,{message:m,onDismiss:()=>u(null)}),e.jsxs("div",{className:"model-comparison-content",children:[e.jsxs("div",{className:"model-comparison-filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"time-range",children:t("modelComparison.timeRange")||"Time Range"}),e.jsxs("select",{id:"time-range",value:f,onChange:h=>g(h.target.value),disabled:n,children:[e.jsx("option",{value:"24h",children:t("modelComparison.last24Hours")||"Last 24 Hours"}),e.jsx("option",{value:"7d",children:t("modelComparison.last7Days")||"Last 7 Days"}),e.jsx("option",{value:"30d",children:t("modelComparison.last30Days")||"Last 30 Days"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"engine-filter",children:t("modelComparison.filterByEngine")||"Filter by Engine"}),e.jsx("input",{id:"engine-filter",type:"text",value:y,onChange:h=>x(h.target.value),placeholder:t("modelComparison.enginePlaceholder")||"e.g., ollama",disabled:n})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"model-filter",children:t("modelComparison.filterByModel")||"Filter by Model"}),e.jsx("input",{id:"model-filter",type:"text",value:b,onChange:h=>P(h.target.value),placeholder:t("modelComparison.modelPlaceholder")||"e.g., llama3",disabled:n})]}),e.jsx("button",{className:"btn-primary",onClick:S,disabled:n,children:t("common.refresh")||"Refresh"})]}),n?e.jsx(R,{message:t("common.loading")||"Loading..."}):T?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"summary-cards",children:[e.jsxs("div",{className:"summary-card",children:[e.jsx("h3",{children:t("modelComparison.totalChecks")||"Total Checks"}),e.jsx("p",{className:"summary-value",children:T.total})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("h3",{children:t("modelComparison.successRate")||"Success Rate"}),e.jsxs("p",{className:"summary-value",children:[T.successRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("h3",{children:t("modelComparison.avgLatency")||"Avg Latency"}),e.jsx("p",{className:"summary-value",children:T.avgLatency?`${T.avgLatency.toFixed(0)}ms`:t("modelComparison.nA")||"N/A"})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("h3",{children:t("modelComparison.avgErrorRate")||"Avg Error Rate"}),e.jsxs("p",{className:"summary-value",children:[(T.avgErrorRate*100).toFixed(2),"%"]})]})]}),e.jsxs("div",{className:"status-breakdown",children:[e.jsx("h2",{children:t("modelComparison.statusBreakdown")||"Status Breakdown"}),e.jsxs("div",{className:"status-cards",children:[e.jsxs("div",{className:"status-card healthy",children:[e.jsx("h4",{children:t("modelComparison.healthy")||"Healthy"}),e.jsx("p",{children:T.healthy})]}),e.jsxs("div",{className:"status-card degraded",children:[e.jsx("h4",{children:t("modelComparison.degraded")||"Degraded"}),e.jsx("p",{children:T.degraded})]}),e.jsxs("div",{className:"status-card unreachable",children:[e.jsx("h4",{children:t("modelComparison.unreachable")||"Unreachable"}),e.jsx("p",{children:T.unreachable})]})]})]}),e.jsxs("div",{className:"engine-summary",children:[e.jsx("h2",{children:t("modelComparison.engineSummary")||"Engine Summary"}),e.jsx("div",{className:"summary-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t("modelComparison.engine")||"Engine"}),e.jsx("th",{children:t("modelComparison.totalChecks")||"Total Checks"}),e.jsx("th",{children:t("modelComparison.healthy")||"Healthy"}),e.jsx("th",{children:t("modelComparison.degraded")||"Degraded"}),e.jsx("th",{children:t("modelComparison.unreachable")||"Unreachable"}),e.jsx("th",{children:t("modelComparison.avgLatency")||"Avg Latency"})]})}),e.jsx("tbody",{children:Object.entries(_).map(([h,c])=>{const d=c.filter(k=>k.status==="healthy").length,i=c.filter(k=>k.status==="degraded").length,C=c.filter(k=>k.status==="unreachable").length,l=c.map(k=>k.latency_ms).filter(k=>k!==null),E=l.length>0?l.reduce((k,p)=>k+p,0)/l.length:null;return e.jsxs("tr",{children:[e.jsx("td",{children:h}),e.jsx("td",{children:c.length}),e.jsx("td",{children:d}),e.jsx("td",{children:i}),e.jsx("td",{children:C}),e.jsx("td",{children:E?`${E.toFixed(0)}ms`:t("modelComparison.nA")||"N/A"})]},h)})})]})})]}),e.jsxs("div",{className:"model-summary",children:[e.jsx("h2",{children:t("modelComparison.modelSummary")||"Model Summary"}),Object.keys(w).length>0?e.jsx("div",{className:"summary-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t("modelComparison.model")||"Model"}),e.jsx("th",{children:t("modelComparison.totalChecks")||"Total Checks"}),e.jsx("th",{children:t("modelComparison.healthy")||"Healthy"}),e.jsx("th",{children:t("modelComparison.degraded")||"Degraded"}),e.jsx("th",{children:t("modelComparison.unreachable")||"Unreachable"}),e.jsx("th",{children:t("modelComparison.avgLatency")||"Avg Latency"})]})}),e.jsx("tbody",{children:Object.entries(w).map(([h,c])=>{const d=c.filter(k=>k.status==="healthy").length,i=c.filter(k=>k.status==="degraded").length,C=c.filter(k=>k.status==="unreachable").length,l=c.map(k=>k.latency_ms).filter(k=>k!==null),E=l.length>0?l.reduce((k,p)=>k+p,0)/l.length:null;return e.jsxs("tr",{children:[e.jsx("td",{children:h}),e.jsx("td",{children:c.length}),e.jsx("td",{children:d}),e.jsx("td",{children:i}),e.jsx("td",{children:C}),e.jsx("td",{children:E?`${E.toFixed(0)}ms`:t("modelComparison.nA")||"N/A"})]},h)})})]})}):e.jsx("p",{className:"empty-message",children:t("modelComparison.noModelData")||"No model-specific data available"})]}),e.jsxs("div",{className:"recent-logs",children:[e.jsx("h2",{children:t("modelComparison.recentLogs")||"Recent Logs"}),e.jsx("div",{className:"logs-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:t("modelComparison.timestamp")||"Timestamp"}),e.jsx("th",{children:t("modelComparison.engine")||"Engine"}),e.jsx("th",{children:t("modelComparison.model")||"Model"}),e.jsx("th",{children:t("modelComparison.status")||"Status"}),e.jsx("th",{children:t("modelComparison.latency")||"Latency"}),e.jsx("th",{children:t("modelComparison.errorRate")||"Error Rate"})]})}),e.jsx("tbody",{children:s.slice(0,50).map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:q(h.created_at)}),e.jsx("td",{children:h.engine_id}),e.jsx("td",{children:h.model_id||"-"}),e.jsx("td",{children:e.jsx("span",{className:`status-badge status-${h.status}`,children:h.status})}),e.jsx("td",{children:h.latency_ms?`${h.latency_ms}ms`:t("modelComparison.nA")||"N/A"}),e.jsxs("td",{children:[(h.error_rate*100).toFixed(2),"%"]})]},h.id))})]})})]})]}):e.jsx("p",{className:"empty-message",children:t("modelComparison.noData")||"No health history data available"})]})]})},fs=({maxNotifications:t=5,defaultDuration:s=5e3})=>{const{t:r}=U(),[n,o]=a.useState([]),m=a.useCallback(f=>{o(g=>g.filter(y=>y.id!==f))},[]),u=a.useCallback(f=>{const g=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,y={...f,id:g,timestamp:Date.now(),duration:f.duration??s};o(x=>[y,...x].slice(0,t)),y.duration&&y.duration>0&&setTimeout(()=>{m(g)},y.duration)},[s,t,m]);return a.useEffect(()=>(window.flmNotifications={add:u},()=>{delete window.flmNotifications}),[u]),n.length===0?null:e.jsx("div",{className:"notification-system",role:"region","aria-label":"Notifications",children:n.map(f=>e.jsx("div",{className:`notification notification-${f.severity}`,role:"alert","aria-live":f.severity==="error"?"assertive":"polite",children:e.jsxs("div",{className:"notification-content",children:[e.jsx("span",{className:"notification-message",children:f.message}),e.jsx("button",{className:"notification-dismiss",onClick:()=>m(f.id),"aria-label":r("common.dismiss")||"Dismiss",children:"×"})]})},f.id))})},ys=()=>({addNotification:a.useCallback(s=>{const r=window.flmNotifications;r?r.add(s):console.warn("NotificationSystem not mounted")},[])}),xs=()=>{const{t}=U(),{addNotification:s}=ys(),[r,n]=a.useState(!1),[o,m]=a.useState(!1),[u,f]=a.useState(null),[g,y]=a.useState(null),[x,b]=a.useState([]),P=[{value:"intrusion",label:t("security.intrusion")||"Intrusion Detection"},{value:"anomaly",label:t("security.anomaly")||"Anomaly Detection"},{value:"rate_limit",label:t("security.rateLimit")||"Rate Limit Exceeded"},{value:"api_error",label:t("security.apiError")||"API Error"}],N=[{value:"critical",label:t("security.critical")||"Critical"},{value:"high",label:t("security.high")||"High"},{value:"medium",label:t("security.medium")||"Medium"},{value:"low",label:t("security.low")||"Low"}],S=a.useCallback(async()=>{n(!0),f(null);try{const d=await I("ipc_config_get",{key:"alert_rules"});if(d&&"data"in d&&d.data){const i=d.data.rules;Array.isArray(i)?b(i):b(T())}else b(T())}catch{b(T())}finally{n(!1)}},[]);a.useEffect(()=>{S()},[S]);const T=()=>[{id:"intrusion-critical",eventType:"intrusion",severity:"critical",threshold:90,enabled:!0,notifyUI:!0,notifyLog:!0},{id:"intrusion-high",eventType:"intrusion",severity:"high",threshold:70,enabled:!0,notifyUI:!0,notifyLog:!0},{id:"anomaly-critical",eventType:"anomaly",severity:"critical",enabled:!0,notifyUI:!0,notifyLog:!0}],_=(d,i,C)=>{b(l=>l.map(E=>E.id===d?{...E,[i]:C}:E))},w=()=>{const d={id:`rule-${Date.now()}`,eventType:"intrusion",severity:"medium",enabled:!0,notifyUI:!0,notifyLog:!0};b(i=>[...i,d])},h=d=>{b(i=>i.filter(C=>C.id!==d))},c=async()=>{m(!0),f(null),y(null);try{await I("ipc_config_set",{key:"alert_rules",value:JSON.stringify(x)}),y(t("alertSettings.saveSuccess")||"Alert settings saved successfully"),s({message:t("alertSettings.saveSuccess")||"Alert settings saved successfully",severity:"success"}),setTimeout(()=>y(null),3e3)}catch(d){const i=d instanceof Error?d.message:t("alertSettings.saveError")||"Failed to save alert settings";f(i),s({message:i,severity:"error"})}finally{m(!1)}};return r?e.jsx("div",{className:"alert-settings",children:e.jsx(R,{message:t("common.loading")||"Loading..."})}):e.jsxs("div",{className:"alert-settings",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{children:t("alertSettings.title")||"Alert Settings"}),e.jsxs("div",{className:"page-actions",children:[e.jsx("button",{className:"button-secondary",onClick:w,children:t("alertSettings.addRule")||"Add Rule"}),e.jsx("button",{className:"button-primary",onClick:c,disabled:o,children:o?t("common.saving")||"Saving...":t("common.save")||"Save"})]})]}),u&&e.jsx(O,{message:u,onDismiss:()=>f(null)}),g&&e.jsx(W,{message:g,onDismiss:()=>y(null)}),e.jsxs("div",{className:"alert-settings-content",children:[e.jsx("p",{className:"page-description",children:t("alertSettings.description")||"Configure alert rules for security events. Alerts can be displayed as UI notifications or logged to the audit log."}),x.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:t("alertSettings.noRules")||"No alert rules configured"}),e.jsx("button",{className:"button-primary",onClick:w,children:t("alertSettings.addFirstRule")||"Add First Rule"})]}):e.jsx("div",{className:"rules-list",children:x.map(d=>e.jsxs("div",{className:"rule-card",children:[e.jsxs("div",{className:"rule-header",children:[e.jsxs("h3",{children:[P.find(i=>i.value===d.eventType)?.label||d.eventType," -"," ",N.find(i=>i.value===d.severity)?.label||d.severity]}),e.jsx("button",{className:"button-danger-small",onClick:()=>h(d.id),children:t("common.delete")||"Delete"})]}),e.jsxs("div",{className:"rule-fields",children:[e.jsx("div",{className:"form-field",children:e.jsxs("label",{children:[t("alertSettings.eventType")||"Event Type",e.jsx("select",{value:d.eventType,onChange:i=>_(d.id,"eventType",i.target.value),children:P.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}),e.jsx("div",{className:"form-field",children:e.jsxs("label",{children:[t("alertSettings.severity")||"Severity",e.jsx("select",{value:d.severity,onChange:i=>_(d.id,"severity",i.target.value),children:N.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}),d.eventType==="intrusion"&&e.jsx("div",{className:"form-field",children:e.jsxs("label",{children:[t("alertSettings.threshold")||"Threshold",e.jsx("input",{type:"number",value:d.threshold||"",onChange:i=>_(d.id,"threshold",parseInt(i.target.value,10)||void 0),min:0,max:100})]})}),e.jsx("div",{className:"form-field checkbox-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:d.enabled,onChange:i=>_(d.id,"enabled",i.target.checked)}),t("alertSettings.enabled")||"Enabled"]})}),e.jsx("div",{className:"form-field checkbox-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:d.notifyUI,onChange:i=>_(d.id,"notifyUI",i.target.checked)}),t("alertSettings.notifyUI")||"Show UI Notification"]})}),e.jsx("div",{className:"form-field checkbox-field",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:d.notifyLog,onChange:i=>_(d.id,"notifyLog",i.target.checked)}),t("alertSettings.notifyLog")||"Log to Audit Log"]})})]})]},d.id))})]})]})},js=[{path:"/",element:e.jsx($,{children:e.jsx(yt,{})})},{path:"/chat/tester",element:e.jsx($,{children:e.jsx(At,{})})},{path:"/security/events",element:e.jsx($,{children:e.jsx(rs,{})})},{path:"/security/ip-blocklist",element:e.jsx($,{children:e.jsx(as,{})})},{path:"/security/ip-whitelist",element:e.jsx($,{children:e.jsx(ns,{})})},{path:"/settings",element:e.jsx($,{children:e.jsx(ls,{})})},{path:"/models/profiles",element:e.jsx($,{children:e.jsx(hs,{})})},{path:"/models/comparison",element:e.jsx($,{children:e.jsx(gs,{})})},{path:"/setup",element:e.jsx($,{children:e.jsx(is,{})})},{path:"/settings/alerts",element:e.jsx($,{children:e.jsx(xs,{})})}];class vs extends a.Component{constructor(s){super(s),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,r){this.setState({errorInfo:r}),this.props.onError&&this.props.onError(s,r)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const s=this.state.error?.message||"予期しないエラーが発生しました",r=this.state.errorInfo?.componentStack?`Component Stack:
${this.state.errorInfo.componentStack}`:void 0;return e.jsxs("div",{className:"error-boundary",children:[e.jsx(O,{message:s,details:r,onDismiss:this.handleReset}),e.jsx("div",{className:"error-boundary-actions",children:e.jsx("button",{className:"button-primary",onClick:this.handleReset,children:"再試行"})})]})}return this.props.children}}const bs=()=>e.jsx("div",{className:"page-loading",children:e.jsx("p",{children:"読み込み中..."})});function Ns(){const t=Ee([...js,{path:"*",element:e.jsx(we,{to:"/",replace:!0})}]),s=(r,n)=>{V.error("Application error caught by ErrorBoundary:",r,n)};return e.jsx(vs,{onError:s,children:e.jsxs("div",{className:"app",children:[e.jsx(a.Suspense,{fallback:e.jsx(bs,{}),children:t}),e.jsx(fs,{})]})})}Ie.createRoot(document.getElementById("root")).render(e.jsx(J.StrictMode,{children:e.jsx(Pe,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsx(nt,{children:e.jsx(at,{children:e.jsx(Ns,{})})})})}));typeof window<"u"&&window.dispatchEvent(new Event("flm-app-initialized"));
