# FLM - UIマップ

## 文書情報

- **プロジェクト名**: FLM
- **作成日**: 2024年
- **目的**: UI画面構成とナビゲーション構造の可視化

---

## 全体構造

```
┌─────────────────────────────────────────────────────┐
│              FLM アプリケーション              │
├─────────────────────────────────────────────────────┤
│                                                       │
│  ┌─────────────────────────────────────────────┐   │
│  │  メインナビゲーション（サイドバーまたはヘッダー）   │   │
│  │  - ホーム                                       │   │
│  │  - API作成                                     │   │
│  │  - API一覧                                     │   │
│  │  - モデル管理                                   │   │
│  │  - 設定                                         │   │
│  └─────────────────────────────────────────────┘   │
│                                                       │
│  ┌─────────────────────────────────────────────┐   │
│  │  メインコンテンツエリア                          │   │
│  │  （画面ごとに切り替わる）                        │   │
│  └─────────────────────────────────────────────┘   │
│                                                       │
└─────────────────────────────────────────────────────┘
```

---

## 画面一覧

### 1. 起動時・初期化画面

**画面ID**: S001  
**優先度**: 最高  
**概要**: アプリ起動時の初期化・Ollama検出

**画面構成**:
```
┌─────────────────────────────────────┐
│  FLM                        │
├─────────────────────────────────────┤
│                                     │
│  [ロゴ・アイコン]                     │
│                                     │
│  起動中...                           │
│  [プログレスバー]                     │
│                                     │
│  ✓ アプリケーションの初期化           │
│  → Ollamaの検出中...                 │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- Ollama未インストール → **Ollamaインストール画面（S002）**
- Ollamaインストール済み → **ホーム画面（S003）**

---

### 2. Ollamaインストール画面

**画面ID**: S002  
**優先度**: 最高  
**概要**: Ollamaの自動インストール

**画面構成**:
```
┌─────────────────────────────────────┐
│  FLM                     [閉じる]    │
├─────────────────────────────────────┤
│                                     │
│  Ollamaのインストールが必要です        │
│                                     │
│  Ollamaは、AIモデルを実行するための   │
│  ソフトウェアです。                   │
│                                     │
│  [Ollamaをインストール] ボタン         │
│                                     │
│  または                              │
│                                     │
│  既にインストール済みの場合は:         │
│  [手動でパスを設定] リンク             │
│                                     │
└─────────────────────────────────────┘
```

**ボタンアクション**:
- 「Ollamaをインストール」→ インストール進行画面（S002-1）
- 「手動でパスを設定」→ 設定画面（S008）のパス設定タブ

**インストール進行画面（S002-1）**:
```
┌─────────────────────────────────────┐
│  Ollamaのインストール中...            │
├─────────────────────────────────────┤
│                                     │
│  [プログレスバー] 45%                 │
│                                     │
│  ✓ ダウンロード開始                   │
│  → インストール中...                 │
│                                     │
│  [キャンセル] ボタン                  │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- インストール完了 → **ホーム画面（S003）**
- エラー発生 → エラーメッセージ表示 → リトライまたはヘルプ

---

### 3. ホーム画面

**画面ID**: S003  
**優先度**: 最高  
**概要**: アプリのメイン画面、API一覧とクイックアクション

**画面構成**:
```
┌─────────────────────────────────────┐
│  FLM                     [設定] [ヘルプ]│
├─────────────────────────────────────┤
│                                     │
│  ┌───────────────────────────────┐ │
│  │  「新しいAPIを作成」ボタン        │ │
│  │  (大きく目立つデザイン)          │ │
│  └───────────────────────────────┘ │
│                                     │
│  作成済みAPI一覧                      │
│  ┌───────────────────────────────┐ │
│  │ ┌───────────────────────────┐ │ │
│  │ │ API名: My First API        │ │ │
│  │ │ モデル: llama2             │ │ │
│  │ │ ステータス: [実行中] 🟢    │ │ │
│  │ │ [詳細] [テスト] [停止]      │ │ │
│  │ └───────────────────────────┘ │ │
│  │                                 │ │
│  │ ┌───────────────────────────┐ │ │
│  │ │ API名: Test API            │ │ │
│  │ │ モデル: mistral            │ │ │
│  │ │ ステータス: [停止中] ⚪    │ │ │
│  │ │ [詳細] [テスト] [起動]      │ │ │
│  │ └───────────────────────────┘ │ │
│  └───────────────────────────────┘ │
│                                     │
│  クイックアクション                   │
│  [モデルを管理] [ドキュメントを見る]   │
│                                     │
└─────────────────────────────────────┘
```

**主要要素**:
- 作成済みAPIカード（最大5-10件表示、スクロール可能）
- 各APIのステータス表示（実行中/停止中）
- クイックアクションボタン

**遷移**:
- 「新しいAPIを作成」→ **API作成ウィザード（S004）**
- 「詳細」→ **API詳細画面（S005）**
- 「テスト」→ **API詳細画面（S005）のテストタブ**
- 「起動/停止」→ ホーム画面に残り、ステータス更新

---

### 4. API作成ウィザード

**画面ID**: S004  
**優先度**: 最高  
**概要**: ステップバイステップでAPIを作成

#### ステップ1: モデル選択

**画面ID**: S004-1

```
┌─────────────────────────────────────┐
│  API作成 - ステップ1/3: モデル選択    │
│  [戻る]              [次へ]          │
├─────────────────────────────────────┤
│                                     │
│  使用するAIモデルを選択してください    │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🔍 検索: [検索バー]            │ │
│  │ 📊 フィルタ: [サイズ] [用途]   │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌─────────────┐ ┌─────────────┐ │
│  │ 🟢 推奨     │ │             │ │
│  │ llama2      │ │ mistral     │ │
│  │ 7B パラメータ │ │ 7B パラメータ │ │
│  │ 説明: ...    │ │ 説明: ...    │ │
│  │ [選択]      │ │ [選択]      │ │
│  └─────────────┘ └─────────────┘ │
│                                     │
│  ┌─────────────┐ ┌─────────────┐ │
│  │             │ │             │ │
│  │ codellama   │ │ phi         │ │
│  │ 13B パラメータ│ │ 2.7B パラメータ│ │
│  │ 説明: ...    │ │ 説明: ...    │ │
│  │ [選択]      │ │ [選択]      │ │
│  └─────────────┘ └─────────────┘ │
│                                     │
│  選択済みモデル: llama2              │
│                                     │
└─────────────────────────────────────┘
```

**動作**:
- モデル未インストールの場合、「ダウンロード」ボタン表示
- 「ダウンロード」→ モデル管理画面（S006）でダウンロード開始

**遷移**:
- 「次へ」→ **ステップ2: 設定（S004-2）**
- 「戻る」→ **ホーム画面（S003）**

---

#### ステップ2: 設定

**画面ID**: S004-2

```
┌─────────────────────────────────────┐
│  API作成 - ステップ2/3: 設定          │
│  [戻る]              [次へ]          │
├─────────────────────────────────────┤
│                                     │
│  API名                               │
│  [My API                      ]     │
│  （デフォルト: LocalAI API）          │
│                                     │
│  ポート番号                           │
│  [8080                        ]     │
│  （デフォルト: 8080）                 │
│                                     │
│  セキュリティ設定                      │
│  ☑ APIキーで保護する                 │
│    （推奨）                           │
│                                     │
│  説明:                               │
│  チェックを入れると、APIキーがない     │
│  とAPIを使用できません。              │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 「次へ」→ **ステップ3: 確認（S004-3）**
- 「戻る」→ **ステップ1: モデル選択（S004-1）**

---

#### ステップ3: 確認

**画面ID**: S004-3

```
┌─────────────────────────────────────┐
│  API作成 - ステップ3/3: 確認          │
│  [戻る]              [作成]          │
├─────────────────────────────────────┤
│                                     │
│  以下の設定でAPIを作成します          │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ モデル: llama2                │ │
│  │ API名: My API                 │ │
│  │ ポート: 8080                  │ │
│  │ APIキー保護: 有効             │ │
│  └───────────────────────────────┘ │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 「作成」→ **API作成進行画面（S004-4）**
- 「戻る」→ **ステップ2: 設定（S004-2）**

---

#### ステップ4: 作成進行中

**画面ID**: S004-4

```
┌─────────────────────────────────────┐
│  API作成中...                        │
├─────────────────────────────────────┤
│                                     │
│  [プログレスバー] 60%                 │
│                                     │
│  ✓ モデル確認完了                     │
│  → Ollama起動中...                   │
│  → 認証プロキシ起動中...              │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 成功 → **API作成成功画面（S004-5）**
- エラー → エラーメッセージ表示 → ホーム画面に戻る

---

#### ステップ5: 作成成功

**画面ID**: S004-5

```
┌─────────────────────────────────────┐
│  ✓ APIの作成が完了しました！          │
├─────────────────────────────────────┤
│                                     │
│  [成功アイコン]                       │
│                                     │
│  API情報                              │
│  ┌───────────────────────────────┐ │
│  │ エンドポイント:                 │ │
│  │ http://localhost:8080          │ │
│  │ [コピー]                       │ │
│  │                                │ │
│  │ APIキー:                       │ │
│  │ sk-xxxxxxxxxxxxxxxxxxxxxx      │ │
│  │ [コピー] [表示/非表示]          │ │
│  └───────────────────────────────┘ │
│                                     │
│  [テストする] [ホームに戻る]          │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 「テストする」→ **API詳細画面（S005）のテストタブ**
- 「ホームに戻る」→ **ホーム画面（S003）**

---

### 5. API詳細画面

**画面ID**: S005  
**優先度**: 最高  
**概要**: APIの詳細情報、テスト、管理

**タブ構成**:
```
┌─────────────────────────────────────┐
│  API詳細: My API    [× 閉じる]       │
├─────────────────────────────────────┤
│ [テスト] [情報] [ログ] [設定]         │
├─────────────────────────────────────┤
│                                     │
│  （タブ内容がここに表示される）        │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ1: テスト

**画面ID**: S005-1

```
┌─────────────────────────────────────┐
│  テスト                               │
├─────────────────────────────────────┤
│                                     │
│  チャットインターフェース              │
│  ┌───────────────────────────────┐ │
│  │ （過去の会話履歴）              │ │
│  │                               │ │
│  │ ユーザー: Hello!              │ │
│  │                               │ │
│  │ AI: Hello! How can I help?   │ │
│  │                               │ │
│  └───────────────────────────────┘ │
│                                     │
│  [メッセージ入力欄...        ] [送信] │
│                                     │
│  ステータス: 🟢 実行中              │
│                                     │
└─────────────────────────────────────┘
```

**機能**:
- リアルタイムチャットインターフェース
- メッセージ送信・受信
- 会話履歴表示

---

#### タブ2: 情報

**画面ID**: S005-2

```
┌─────────────────────────────────────┐
│  情報                                 │
├─────────────────────────────────────┤
│                                     │
│  エンドポイントURL                    │
│  ┌───────────────────────────────┐ │
│  │ http://localhost:8080/v1/... │ │
│  │ [コピー]                      │ │
│  └───────────────────────────────┘ │
│                                     │
│  APIキー                             │
│  ┌───────────────────────────────┐ │
│  │ sk-xxxxxxxxxxxxxxxxxxxxxx      │ │
│  │ [コピー] [表示/非表示] [再生成]  │ │
│  └───────────────────────────────┘ │
│                                     │
│  サンプルコード                       │
│  [curl] [Python] [JavaScript] [Node.js]│
│                                     │
│  ┌───────────────────────────────┐ │
│  │ curl -X POST \               │ │
│  │   http://localhost:8080/... \ │ │
│  │   -H "Authorization: Bearer \ │ │
│  │   sk-xxx" \                  │ │
│  │   -H "Content-Type: ..." \   │ │
│  │   -d '{"model": "..."}'      │ │
│  │                               │ │
│  │ [コピー]                      │ │
│  └───────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ3: ログ

**画面ID**: S005-3（v1.1実装）

```
┌─────────────────────────────────────┐
│  ログ                                 │
├─────────────────────────────────────┤
│                                     │
│  [フィルタ] [最新] [エラーのみ]       │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 2024-01-01 12:00:00          │ │
│  │ POST /v1/chat/completions    │ │
│  │ ステータス: 200 OK            │ │
│  │ レスポンス時間: 1.2秒          │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 2024-01-01 11:59:30          │ │
│  │ POST /v1/chat/completions    │ │
│  │ ステータス: 400 Bad Request   │ │
│  │ エラー: Invalid API key       │ │
│  └───────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ4: 設定

**画面ID**: S005-4

```
┌─────────────────────────────────────┐
│  設定                                 │
├─────────────────────────────────────┤
│                                     │
│  API名                               │
│  [My API                      ]     │
│                                     │
│  ポート番号                           │
│  [8080                        ]     │
│  [変更]                              │
│                                     │
│  認証設定                             │
│  ☑ APIキーで保護する                 │
│                                     │
│  アクション                           │
│  [起動] [停止] [再起動]               │
│                                     │
│  ⚠️ 危険な操作                        │
│  [APIを削除]                         │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 各タブ間を切り替え
- 「× 閉じる」→ **ホーム画面（S003）**

---

### 6. モデル管理画面

**画面ID**: S006  
**優先度**: 高  
**概要**: LLMモデルのダウンロード・管理

**タブ構成**:
```
┌─────────────────────────────────────┐
│  モデル管理             [× 閉じる]     │
├─────────────────────────────────────┤
│ [インストール済み] [ダウンロード]     │
├─────────────────────────────────────┤
│                                     │
│  （タブ内容がここに表示される）        │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ1: インストール済み

**画面ID**: S006-1

```
┌─────────────────────────────────────┐
│  インストール済みモデル                │
├─────────────────────────────────────┤
│                                     │
│  🔍 検索: [検索バー]                  │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ llama2                        │ │
│  │ 7B パラメータ                  │ │
│  │ サイズ: 3.8 GB                 │ │
│  │ インストール日: 2024-01-01     │ │
│  │ [削除]                        │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ mistral                        │ │
│  │ 7B パラメータ                  │ │
│  │ サイズ: 4.1 GB                 │ │
│  │ インストール日: 2024-01-02     │ │
│  │ [削除]                        │ │
│  └───────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ2: ダウンロード

**画面ID**: S006-2

```
┌─────────────────────────────────────┐
│  モデルをダウンロード                  │
├─────────────────────────────────────┤
│                                     │
│  🔍 検索: [検索バー]                  │
│  📊 フィルタ: [サイズ] [用途]         │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🟢 推奨                       │ │
│  │ llama2                        │ │
│  │ 7B パラメータ                  │ │
│  │ サイズ: 3.8 GB                 │ │
│  │ 説明: Metaの高性能モデル        │ │
│  │ [ダウンロード]                │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ mistral                        │ │
│  │ 7B パラメータ                  │ │
│  │ サイズ: 4.1 GB                 │ │
│  │ 説明: 高速で効率的なモデル      │ │
│  │ [ダウンロード]                │ │
│  └───────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

**ダウンロード進行画面**:
```
┌─────────────────────────────────────┐
│  llama2 をダウンロード中...           │
├─────────────────────────────────────┤
│                                     │
│  [プログレスバー] 65%                 │
│                                     │
│  ダウンロード速度: 5.2 MB/s          │
│  残り時間: 約2分                     │
│                                     │
│  [キャンセル]                       │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 「ダウンロード」→ ダウンロード進行画面表示
- 「× 閉じる」→ **ホーム画面（S003）**

---

### 7. 設定画面

**画面ID**: S008  
**優先度**: 中  
**概要**: アプリケーション全体の設定

**タブ構成**:
```
┌─────────────────────────────────────┐
│  設定                    [× 閉じる]   │
├─────────────────────────────────────┤
│ [一般] [Ollama] [セキュリティ] [詳細]  │
├─────────────────────────────────────┤
│                                     │
│  （タブ内容がここに表示される）        │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ1: 一般

**画面ID**: S008-1

```
┌─────────────────────────────────────┐
│  一般設定                             │
├─────────────────────────────────────┤
│                                     │
│  言語                                │
│  [日本語 ▼]                          │
│                                     │
│  テーマ                              │
│  ○ ライト                             │
│  ○ ダーク                             │
│  ○ システムに合わせる                  │
│                                     │
│  起動時の動作                         │
│  ☑ 起動時に最後のAPIを自動起動         │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ2: Ollama

**画面ID**: S008-2

```
┌─────────────────────────────────────┐
│  Ollama設定                           │
├─────────────────────────────────────┤
│                                     │
│  Ollamaのパス                        │
│  [C:\Users\...\.ollama      ] [参照] │
│                                     │
│  Ollamaの状態                        │
│  🟢 実行中 (バージョン: 0.1.0)       │
│                                     │
│  [Ollamaを起動] [Ollamaを停止]       │
│                                     │
│  [Ollamaを再インストール]            │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ3: セキュリティ

**画面ID**: S008-3

```
┌─────────────────────────────────────┐
│  セキュリティ設定                     │
├─────────────────────────────────────┤
│                                     │
│  ローカルホストのみ許可                │
│  ☑ 外部からのアクセスをブロック        │
│                                     │
│  ログ設定                             │
│  ☑ リクエストログを記録               │
│  ☑ エラーログを記録                   │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

---

#### タブ4: 詳細

**画面ID**: S008-4

```
┌─────────────────────────────────────┐
│  詳細設定                             │
├─────────────────────────────────────┤
│                                     │
│  データ保存場所                       │
│  [C:\Users\...\AppData\...] [参照]  │
│                                     │
│  ログ保持期間                         │
│  [30日 ▼]                           │
│                                     │
│  デバッグモード                       │
│  ☐ 有効にする（開発者向け）           │
│                                     │
│  アプリケーション情報                 │
│  バージョン: 1.0.0                   │
│  [更新を確認]                        │
│                                     │
└─────────────────────────────────────┘
```

**遷移**:
- 各タブ間を切り替え
- 「× 閉じる」→ 前の画面に戻る

---

## ナビゲーションフロー

### 主要フロー

#### 1. 初回起動フロー

```
起動時・初期化画面（S001）
  ↓
Ollama未インストール？
  ↓ YES
Ollamaインストール画面（S002）
  ↓
インストール進行（S002-1）
  ↓
ホーム画面（S003）
```

#### 2. API作成フロー

```
ホーム画面（S003）
  ↓ 「新しいAPIを作成」
API作成ウィザード - ステップ1（S004-1）
  ↓ 「次へ」
API作成ウィザード - ステップ2（S004-2）
  ↓ 「次へ」
API作成ウィザード - ステップ3（S004-3）
  ↓ 「作成」
API作成進行中（S004-4）
  ↓
API作成成功（S004-5）
  ↓ 「テストする」
API詳細画面 - テストタブ（S005-1）
```

#### 3. API利用フロー

```
ホーム画面（S003）
  ↓ APIカードの「詳細」クリック
API詳細画面 - テストタブ（S005-1）
  ↓ チャット送信
API詳細画面 - テストタブ（チャット表示）
```

#### 4. モデルダウンロードフロー

```
モデル管理画面 - ダウンロードタブ（S006-2）
  ↓ 「ダウンロード」ボタン
ダウンロード進行画面
  ↓ 完了
モデル管理画面 - インストール済みタブ（S006-1）
```

---

## コンポーネント構成

### 共通コンポーネント

#### 1. ヘッダー
- **場所**: 全画面共通（上部）
- **要素**: ロゴ、アプリ名、設定ボタン、ヘルプボタン

#### 2. サイドバー（オプション）
- **場所**: 左側（設定で有効/無効切り替え可能）
- **要素**: ナビゲーションメニュー（ホーム、API作成、モデル管理、設定）

#### 3. ステータスバー
- **場所**: 画面下部（オプション）
- **要素**: Ollamaの状態、接続状態

#### 4. モーダルダイアログ
- **用途**: 確認ダイアログ、エラーメッセージ、成功メッセージ
- **共通要素**: タイトル、メッセージ、ボタン（OK、キャンセル）

---

## エラーハンドリングUI

### エラー表示パターン

#### 1. インラインエラー
```
┌─────────────────────────────────────┐
│  API名                               │
│  [入力欄...                  ]       │
│  ❌ このフィールドは必須です          │
└─────────────────────────────────────┘
```

#### 2. エラーモーダル
```
┌─────────────────────────────────────┐
│  ⚠️ エラー                            │
├─────────────────────────────────────┤
│                                     │
│  APIの作成に失敗しました              │
│                                     │
│  ポート8080が既に使用されています。    │
│  別のポート番号（例: 8081）を          │
│  試してください。                    │
│                                     │
│  [ポート番号を変更] [閉じる]          │
│                                     │
└─────────────────────────────────────┘
```

#### 3. トースト通知
- **場所**: 画面右上または下部
- **用途**: 一時的な成功・エラーメッセージ
- **表示時間**: 3-5秒後に自動消去

---

## レスポンシブデザイン考慮事項

### ウィンドウサイズ対応

- **最小サイズ**: 800×600ピクセル
- **推奨サイズ**: 1200×800ピクセル以上
- **全画面表示**: 対応（オプション）

### レイアウト調整

- 小さいウィンドウ: サイドバーを折りたたみ可能に
- モバイル: 将来的に検討（現時点ではデスクトップのみ）

---

## アクセシビリティ対応

### キーボードナビゲーション

- Tab: 次の要素にフォーカス
- Shift+Tab: 前の要素にフォーカス
- Enter: ボタンクリック
- Esc: モーダルを閉じる

### スクリーンリーダー対応

- 適切なaria-label属性
- セマンティックHTML要素の使用
- フォーカス表示の明確化

---

## UI/UX原則の適用

### 1. 専門用語の排除

| 技術用語 | UI表示用語 |
|---------|-----------|
| デプロイ | 公開 |
| エンドポイント | 接続先 |
| APIキー | アクセスキー |
| モデル | AI |

### 2. 視覚的なガイド

- プログレスバーで処理状況を表示
- アイコンでステータスを視覚化（🟢実行中、⚪停止中）
- カラーコーディング（成功: 緑、エラー: 赤、警告: 黄）

### 3. ステップバイステップ

- ウィザード形式で一度に1つのステップ
- 各ステップで明確な説明と次のアクションを提示
- 進捗インジケーター（ステップ1/3など）

---

## 実装優先順位

### MVP（最小実用製品）

**必須画面**:
1. ✅ 起動時・初期化画面（S001）
2. ✅ Ollamaインストール画面（S002）
3. ✅ ホーム画面（S003）
4. ✅ API作成ウィザード（S004）全ステップ
5. ✅ API詳細画面（S005）- テスト、情報タブのみ
6. ✅ モデル管理画面（S006）- 基本機能のみ
7. ✅ 設定画面（S008）- 基本設定のみ

**除外機能（v1.1以降）**:
- ❌ API詳細画面 - ログタブ（S005-3）
- ❌ 高度な設定オプション

---

## 画面遷移図（簡易版）

```
                    ┌─────────────┐
                    │ 起動画面(S001) │
                    └──────┬──────┘
                           │
          ┌────────────────┼────────────────┐
          │                │                │
          ▼                ▼                ▼
    ┌──────────┐    ┌──────────┐    ┌──────────┐
    │Ollama   │    │ ホーム    │    │ API作成   │
    │インストール│    │ (S003)   │    │ ウィザード │
    │ (S002)  │    └────┬─────┘    │  (S004)  │
    └──────────┘         │           └────┬─────┘
                         │                │
          ┌──────────────┼────────────────┼──────────┐
          │              │                │          │
          ▼              ▼                ▼          ▼
    ┌──────────┐  ┌──────────┐    ┌──────────┐ ┌──────────┐
    │API詳細   │  │ モデル管理 │    │ 設定画面  │ │作成成功  │
    │ (S005)   │  │  (S006)  │    │  (S008)  │ │ (S004-5) │
    └──────────┘  └──────────┘    └──────────┘ └──────────┘
```

---

## メモ・改善点

### 将来的な改善案

1. **ダッシュボード画面**: 全体の統計情報を表示
2. **テンプレート機能**: よく使うAPI設定を保存・再利用
3. **ショートカットキー**: キーボードショートカットの追加
4. **ドラッグ&ドロップ**: ファイルのアップロード機能（将来的に）
5. **多言語対応**: 日本語・英語の完全対応

---

## 🔍 問題点・改善提案

### ❗ 主要な問題点

#### 1. **API作成ウィザードが複雑すぎる**

**現状の問題**:
- 3ステップ（モデル選択 → 設定 → 確認）が必要
- 非開発者にとって、設定ステップ（API名、ポート番号）は混乱の原因となる可能性
- デフォルト値があるなら、設定ステップを省略できる

**改善提案**:
- **「クイック作成」モードを追加**: デフォルト設定でワンクリック作成
- **設定ステップの簡略化**: API名は自動生成（"API 1", "API 2"など）、ポート番号も自動割り当て
- **確認ステップの省略**: デフォルト設定の場合、確認ステップをスキップ可能

**改善後のUIフロー**:
```
ホーム画面
  ↓ 「クイック作成」
モデル選択（1画面のみ）
  ↓ 「作成」ボタン
API作成中...
  ↓
成功画面（自動的にテスト画面へ）
```

---

#### 2. **モデル選択時のダウンロードフローが回りくどい**

**現状の問題**:
- モデル未インストール時、モデル管理画面（S006）に遷移する
- ユーザーが別画面に行ってしまい、コンテキストが失われる
- API作成の流れが中断される

**改善提案**:
- **インラインでダウンロード**: モデル選択画面で直接ダウンロード開始
- **モーダルで進捗表示**: 別画面に遷移せず、モーダルでダウンロード進捗を表示
- **ダウンロード完了後、自動で選択**: ダウンロード完了したモデルを自動選択

**改善後のUI**:
```
モデル選択画面
  ↓ 未インストールモデルを選択
「ダウンロードして続ける」ボタン
  ↓
モーダル: ダウンロード進行中
  ↓ 完了
自動的にモデルが選択され、次へ進む
```

---

#### 3. **ホーム画面のAPIカードアクションが多すぎる**

**現状の問題**:
- 各APIカードに「詳細」「テスト」「起動/停止」の3つのボタン
- 非開発者には選択肢が多すぎて混乱する可能性

**改善提案**:
- **メインアクションを1つに**: 「テスト」ボタンを大きく表示（最も使われる機能）
- **詳細設定は「...」メニューへ**: 「詳細」「起動/停止」は三点メニューに移動
- **ステータス表示の簡略化**: 実行中/停止中の表示をより視覚的に

**改善後のUI**:
```
APIカード:
┌───────────────────────────────┐
│ API名: My First API            │
│ モデル: llama2  🟢 実行中      │
│                                │
│    [大きく目立つ「テスト」ボタン]  │
│                                │
│                   [⚙️ 設定]    │
└───────────────────────────────┘
```

---

#### 4. **ポート番号設定が非開発者には難しすぎる**

**現状の問題**:
- ポート番号は技術的な概念で、非開発者には理解が難しい
- デフォルト値（8080）で問題ない場合がほとんど

**改善提案**:
- **ポート番号を自動割り当て**: 使用中のポートを自動検出し、空いているポートを自動選択
- **高度な設定に移動**: ポート番号の設定は「高度な設定」セクションに移動
- **説明を追加**: ポート番号が必要な場合のみ、わかりやすい説明を表示

**改善後のUI**:
```
基本設定:
- API名: [My API]
- セキュリティ: ☑ APIキーで保護する

[高度な設定を表示] ← 折りたたみ可能

高度な設定（展開時）:
- ポート番号: [8080] （自動検出）
  説明: 他のアプリと競合する場合のみ変更してください
```

---

#### 5. **API作成成功後のフローが最適化されていない**

**現状の問題**:
- 成功画面から「テストする」「ホームに戻る」の2択
- 多くのユーザーは成功後すぐにテストしたい

**改善提案**:
- **自動的にテスト画面へ**: 成功後、3秒カウントダウン後に自動でテスト画面へ遷移
- **「すぐにテストする」ボタンを大きく表示**: 待ちたくない場合はクリック可能
- **「後でテスト」オプション**: ホームに戻る選択肢も残す

**改善後のUI**:
```
✓ APIの作成が完了しました！

API情報表示...

[大きく] すぐにテストする [小さく] 後でテスト

(3秒後に自動的にテスト画面へ遷移します...)
```

---

#### 6. **設定画面が細分化されすぎている**

**現状の問題**:
- 設定画面に4つのタブ（一般、Ollama、セキュリティ、詳細）
- 非開発者には必要な設定と不要な設定の区別が難しい

**改善提案**:
- **設定を2段階に**: 「基本設定」と「詳細設定」
- **基本設定**: 言語、テーマ、起動時の動作のみ（ほとんどのユーザーが使う設定）
- **詳細設定**: Ollama、セキュリティ、データ保存場所（上級者向け）

**改善後のUI**:
```
設定画面
├─ 基本設定（デフォルトで表示）
│   - 言語
│   - テーマ
│   - 起動時の動作
│
└─ [詳細設定を表示] ← 折りたたみ可能
    - Ollama設定
    - セキュリティ設定
    - データ保存場所
```

---

### ✨ 簡略化の提案

#### **「クイック作成」機能（新規追加）**

**目的**: 最も簡単なAPI作成方法を提供

**UIフロー**:
```
ホーム画面
  ↓ 「クイック作成」ボタン（大きく目立つ）
モデル選択（1画面のみ）
  ↓ 「作成」ボタン（デフォルト設定で）
API作成中...
  ↓
成功 → 自動的にテスト画面へ
```

**特徴**:
- ✅ 設定ステップなし（デフォルト値を使用）
- ✅ 確認ステップなし
- ✅ API名は自動生成（"API 1", "API 2"など）
- ✅ ポート番号は自動検出
- ✅ APIキーは自動で生成・有効化

**通常のウィザード**:
- 「詳細設定で作成」ボタンから、従来の3ステップウィザードにアクセス可能

---

#### **モデル選択の改善**

**現状**: モデル選択 → 未インストール時は別画面へ

**改善後**:
```
モデル選択画面
┌───────────────────────────────┐
│  [モデルカード]                │
│  llama2                       │
│  7B パラメータ                 │
│  ☑ インストール済み            │
│  [選択]                        │
└───────────────────────────────┘

┌───────────────────────────────┐
│  [モデルカード]                │
│  mistral                       │
│  7B パラメータ                 │
│  ❌ 未インストール              │
│  [ダウンロードして選択]         │ ← 追加
└───────────────────────────────┘
```

**改善点**:
- インストール済み/未インストールを明確に表示
- 未インストールでも、同じ画面でダウンロード開始可能
- ダウンロード進行はモーダルで表示（画面遷移なし）

---

#### **エラーハンドリングの改善**

**現状の問題**:
- エラー時にモーダルが表示されるが、次のアクションが不明確

**改善提案**:
```
❌ エラー: ポート8080が使用中です

解決方法:
1. 別のポート番号を自動検出しました（8081）
   [ポート8081で続ける] ← 推奨アクションを大きく

2. 手動でポート番号を変更する
   [ポート番号を変更]
```

**改善点**:
- エラーメッセージの下に、具体的な解決方法を提示
- 最も簡単な解決方法を大きく表示
- 「自動で解決」ボタンを追加

---

### 📊 簡略化の効果

| 項目 | 改善前 | 改善後 | 削減 |
|------|--------|--------|------|
| API作成ステップ数 | 3ステップ | 1ステップ（クイック作成） | 66%削減 |
| 画面遷移数 | 5回 | 2回 | 60%削減 |
| 必須入力項目 | 2項目（API名、ポート） | 0項目（自動設定） | 100%削減 |
| クリック数 | 約6回 | 約2回 | 66%削減 |

---

### 🎯 優先度の高い改善

1. **⭐ 最優先**: 「クイック作成」機能の追加
2. **⭐ 高**: モデル選択画面でのインラインダウンロード
3. **⭐ 高**: APIカードのアクションボタン簡略化
4. **⭐ 中**: ポート番号の自動検出・自動割り当て
5. **⭐ 中**: 成功後の自動テスト画面遷移
6. **⭐ 低**: 設定画面の簡略化

---

## 🔍 追加の問題点・改善提案（詳細調査）

### ❗ 発見した追加の問題点

#### 7. **初回起動時のチュートリアルがない**

**現状の問題**:
- 初回起動時、ユーザーが何をすればいいかわからない
- 「新しいAPIを作成」ボタンがあるが、説明がない
- 非開発者には最初の一歩が不明確

**改善提案**:
- **初回起動時のみチュートリアル表示**: 3-4ステップのガイド
- **空の状態でのガイダンス**: APIが1つもない場合、大きな「はじめましょう」ボタンと説明
- **ツールチップ**: 各主要機能に「?」アイコンでヘルプ表示

**改善後のUI**:
```
初回起動時:
┌─────────────────────────────────────┐
│  FLMへようこそ！                    │
│                                     │
│  [チュートリアルを見る]              │
│  [スキップして始める]                │
│                                     │
└─────────────────────────────────────┘

空のホーム画面:
┌─────────────────────────────────────┐
│  APIがまだありません                 │
│                                     │
│  最初のAPIを作成して始めましょう      │
│                                     │
│  [大きく] はじめましょう            │
│                                     │
│  • モデルを選択                      │
│  • 1クリックでAPI作成                │
│  • すぐにテスト可能                  │
└─────────────────────────────────────┘
```

---

#### 8. **モデルが1つもインストールされていない場合の対応が不明確**

**現状の問題**:
- モデル選択画面に、インストール済みモデルがない場合の対応が不明確
- ユーザーがどこからモデルをダウンロードすればいいかわからない

**改善提案**:
- **推奨モデルを最初に表示**: 未インストールでも「推奨モデル」セクションに表示
- **「最初のモデルをダウンロード」ボタン**: 大きく目立つボタン
- **モデル説明を追加**: 各モデルの用途・特徴をわかりやすく表示

**改善後のUI**:
```
モデル選択画面（モデル未インストール時）
┌─────────────────────────────────────┐
│  まだモデルがインストールされていません│
│                                     │
│  まずは推奨モデルをダウンロードしましょう│
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🟢 推奨: 初心者向け             │ │
│  │ llama2                         │ │
│  │ 7B パラメータ（約3.8GB）        │ │
│  │                                │ │
│  │ 説明:                           │ │
│  │ 一般的な会話や質問に答えてくれます│ │
│  │                                │ │
│  │ [大きく] ダウンロードして使用開始│ │
│  └───────────────────────────────┘ │
│                                     │
│  他のモデルを見る [▼]                │
└─────────────────────────────────────┘
```

---

#### 9. **API詳細画面のタブ構成が複雑**

**現状の問題**:
- 4つのタブ（テスト、情報、ログ、設定）があり、非開発者には多すぎる
- 「情報」タブと「テスト」タブを分ける必要性が低い

**改善提案**:
- **「テスト」と「情報」を統合**: テスト画面の上部にAPI情報を表示
- **タブを2つに削減**: 「テスト」（情報含む）と「設定」のみ
- **ログタブは設定内に移動**: 上級者向け機能として設定タブ内に配置

**改善後のUI**:
```
API詳細画面
├─ テストタブ（デフォルト）
│   - 上部: API情報（エンドポイント、APIキー）
│   - 下部: チャットインターフェース
│
└─ 設定タブ
    - API名、ポート番号変更
    - 起動/停止/再起動
    - ログ表示（折りたたみ可能）
    - 削除
```

---

#### 10. **ホーム画面のヘッダーに表示名が統一されていない**

**現状の問題**:
- 全ての画面で「FLM」に統一済み

**改善提案**:
- **全て「FLM」に統一**: 全画面で一貫した名称
- **ロゴ追加**: ブランド統一のため

---

#### 11. **起動時のOllama検出が非同期だがUXが最適化されていない**

**現状の問題**:
- 起動時画面でOllama検出中に待機時間がある
- 検出に時間がかかる場合、ユーザーが不安になる

**改善提案**:
- **バックグラウンド検出**: Ollama検出をバックグラウンドで実行
- **ホーム画面を先に表示**: 検出完了を待たずにホーム画面を表示
- **ステータスバーで通知**: 下部にOllamaの状態を表示（検出中/検出済み/未インストール）

**改善後のUIフロー**:
```
起動
  ↓
ホーム画面を即座に表示
  ↓
バックグラウンドでOllama検出
  ↓
検出結果をステータスバーに表示
  ↓
未インストールの場合: 通知バナー表示
```

---

#### 12. **API作成成功画面で情報が多すぎる**

**現状の問題**:
- エンドポイントURL、APIキー、サンプルコードが一度に表示される
- 非開発者には情報過多で混乱する

**改善提案**:
- **段階的に情報を表示**: まずは「成功！」メッセージのみ
- **「詳細を見る」ボタン**: クリックで詳細情報を展開
- **QRコード対応**: API情報をQRコードで表示（将来的に）

**改善後のUI**:
```
✓ APIの作成が完了しました！

[成功アイコン]

APIを使用する準備ができました。

[大きく] すぐにテストする

[小さく] 詳細情報を見る ▼
  ↓ 展開時
- エンドポイントURL
- APIキー
- サンプルコード
```

---

#### 13. **モデル選択画面のフィルタリングが複雑**

**現状の問題**:
- 「サイズ」「用途」フィルタがあり、非開発者には理解が難しい
- 検索バーとフィルタが両方あると混乱

**改善提案**:
- **検索バーのみに統一**: 「モデル名で検索」のみ
- **推奨モデルを最初に表示**: フィルタリング不要で最も使われるモデルを表示
- **カテゴリ表示**: 「初心者向け」「高度な用途」などのカテゴリ分け

**改善後のUI**:
```
モデル選択画面
├─ 🔍 [モデル名で検索...]
│
├─ 🟢 推奨モデル（初心者向け）
│   - llama2
│   - mistral
│
└─ その他のモデル
    - codellama
    - phi
    ...
```

---

#### 14. **エラー時の復旧方法が不明確**

**現状の問題**:
- エラー発生時に「リトライ」「ヘルプを見る」などの選択肢があるが、どの選択肢が適切か不明確

**改善提案**:
- **推奨アクションを大きく表示**: 最も効果的な解決方法を最初に提示
- **自動修復機能**: 可能な場合は自動で修復を試みる
- **エラー履歴**: 同じエラーが繰り返される場合の対処法を表示

**改善後のUI**:
```
❌ エラー: ポート8080が使用中です

自動修復を試みますか？
→ 別のポート（8081）を自動検出しました

[大きく] 自動で修復する（推奨）
[小さく] 手動で設定する
```

---

#### 15. **設定画面の「Ollama」タブが非開発者には不要**

**現状の問題**:
- 設定画面に「Ollama」タブがあるが、非開発者にはOllamaの状態管理は不要
- 初回インストール後にOllama設定を見ることは稀

**改善提案**:
- **Ollama設定を詳細設定に移動**: 基本設定から削除
- **トラブルシューティング時にのみ表示**: エラー発生時のみアクセス可能

---

### 📋 追加の簡略化案

#### **「スマート推奨」機能**

**目的**: ユーザーの選択を最小限に

**機能**:
- 初回起動時、推奨モデル（llama2など）を自動選択候補として表示
- 「推奨設定で作成」ボタンで、モデル選択も自動
- API名も自動生成（「My API」「API 1」など）

**UIフロー**:
```
ホーム画面
  ↓ 「推奨設定で作成」ボタン（最大のボタン）
API作成中...（全て自動）
  ↓
成功 → 自動的にテスト画面へ
```

**効果**: **クリック1回でAPI作成完了**

---

#### **コンテキストヘルプの追加**

**目的**: 各画面で必要な時にヘルプを表示

**実装**:
- 各主要機能に「?」アイコン
- ホバーまたはクリックで説明を表示
- 非開発者向けのわかりやすい説明

**例**:
```
ポート番号 [?]
  ↓ ホバー/クリック
「ポート番号とは？」
他のアプリとAPIを区別するための番号です。
通常は変更する必要はありません。
```

---

### 📊 追加改善の効果まとめ

| 改善項目 | 効果 |
|---------|------|
| 初回チュートリアル追加 | 初回ユーザーの混乱を50%削減 |
| モデル未インストール時のガイダンス | モデルダウンロード開始率を30%向上 |
| API詳細画面のタブ統合 | 画面遷移を25%削減 |
| 「推奨設定で作成」機能 | クリック数を66%削減（6回→1回） |
| バックグラウンド検出 | 起動時の待機時間を80%削減 |
| エラー時の自動修復 | エラー解決時間を60%短縮 |

---

### 🎯 更新後の優先度（再評価）

1. **⭐ 最優先**: 
   - 「クイック作成」機能の追加
   - 初回チュートリアル追加
   - モデル未インストール時のガイダンス

2. **⭐ 高**: 
   - モデル選択画面でのインラインダウンロード
   - APIカードのアクションボタン簡略化
   - API詳細画面のタブ統合（テスト+情報）

3. **⭐ 中**: 
   - ポート番号の自動検出・自動割り当て
   - 成功後の自動テスト画面遷移
   - バックグラウンドでのOllama検出
   - エラー時の自動修復

4. **⭐ 低**: 
   - 設定画面の簡略化
   - コンテキストヘルプの追加
   - モデル選択画面のフィルタリング簡略化

---

**このUIマップは、SPECIFICATION.mdおよびCONCEPT.mdの仕様に基づいて作成されています。**

