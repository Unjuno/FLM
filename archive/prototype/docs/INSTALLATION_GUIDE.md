# インストールガイド

## 📦 インストール方法

FLMをインストールする方法を説明します。

---

## 🎯 システム要件

### 必須要件

- **OS**: Windows 10以降（64bit）
- **メモリ**: 4GB以上（モデルサイズに応じて追加メモリが必要）
- **ストレージ**: 2GB以上の空き容量（モデルダウンロード用の追加容量が必要）
- **インターネット接続**: 初回起動時のOllama自動インストール、モデルダウンロード用

### 推奨要件

- **OS**: Windows 11（64bit）
- **メモリ**: 8GB以上
- **ストレージ**: 10GB以上の空き容量（モデルダウンロード用）
- **CPU**: 4コア以上

---

## 📥 インストール手順

### 方法1: インストーラーからインストール（推奨）

1. **ダウンロード**
   - [公式Webサイト](https://flm.github.io/download)から最新版のインストーラーをダウンロード
   - または、[GitHub Releases](https://github.com/Unjuno/FLM/releases)からダウンロード

2. **インストール**
   - ダウンロードした `.exe` ファイルを実行
   - インストールウィザードに従ってインストール
   - インストール先はデフォルトで `C:\Program Files\FLM\` にインストールされます

3. **起動**
   - インストール完了後、デスクトップまたはスタートメニューからFLMを起動

### 方法2: MSIインストーラー

1. **ダウンロード**
   - GitHub Releasesから `.msi` ファイルをダウンロード

2. **インストール**
   - 管理者権限で `.msi` ファイルを実行
   - インストールウィザードに従ってインストール

---

## 🚀 初回起動

### Ollama自動インストール & セルフリカバリ仕様

FLMは初回起動時にOllamaの状態をチェックし、必要に応じて以下のフローを自動実行します。

1. **検出フェーズ（フロント→Tauriコマンド）**
   - システム PATH・標準インストール先・ポータブル版の存在を検出。
   - インストール済みかつ実行中であれば、そのまま次工程へ進みます。

2. **自動ダウンロードフェーズ**
   - 未インストールの場合、GitHub Releases API から最新版をダウンロード。
   - 断線時は自動的に最大3回までリトライし、都度UIへ進捗・失敗理由を表示。

3. **インストールフェーズ**
   - ダウンロード完了後、自動的にサイレントインストールを実行。
   - 失敗した場合は手動インストールへのフォールバック手順とリンクを画面に提示します。

4. **起動フェーズ（セルフヒーリング）**
   - インストール済みだが停止中の場合、`start_ollama` コマンドで自動起動を試行。
   - 起動後は HTTP API (`http://localhost:11434/api/tags`) へ疎通確認を行い、成功するまで再試行します（最大3回、各2秒間隔）。

5. **ポートヘルスチェック**
   - 診断ツールと同じ仕組みで 11434 番ポートの占有状況を自動チェック。
   - 競合プロセスが存在する場合はユーザーにプロセス名と対処方針を提示します。

6. **完了通知**
   - すべて成功した場合は UI に「Ollamaが利用可能になりました」と表示し、API 作成など次のアクションへ誘導します。

> 💡 **ポイント**: これらの処理はユーザー操作なしで自動実行され、失敗した場合のみ手動対応の案内に切り替わるよう設計されています。

### エラーが発生した場合

自動インストールに失敗した場合：

1. **手動インストール**
   - [Ollama公式Webサイト](https://ollama.ai/)から手動でインストール
   - インストール後、FLMを再起動

2. **トラブルシューティング**
   - [トラブルシューティングガイド](./TROUBLESHOOTING.md)を参照
   - [FAQ](./FAQ.md)でよくある問題を確認

---

## 🔄 アップデート

### 自動アップデート（将来実装予定）

v1.1以降で自動アップデート機能を実装予定です。

### 手動アップデート

現在は、手動でアップデートする必要があります：

1. **現在のバージョンを確認**
   - FLMの「ヘルプ」→「バージョン情報」から確認

2. **最新版をダウンロード**
   - [公式Webサイト](https://flm.github.io/download)またはGitHub Releasesから最新版をダウンロード

3. **インストール**
   - 新しいバージョンのインストーラーを実行
   - 既存のインストールが自動的に更新されます

---

## 🗑️ アンインストール

### Windows

1. **コントロールパネルからアンインストール**
   - 「設定」→「アプリ」→「アプリと機能」
   - 「FLM」を選択して「アンインストール」

2. **インストーラーからアンインストール**
   - インストーラー（`.exe`）を再実行
   - 「アンインストール」を選択

### データの保存場所

アンインストールしても、以下のデータは残ります：

- **設定データ**: `%APPDATA%\FLM\` （手動で削除する必要があります）
- **モデルデータ**: Ollamaが管理するため、Ollamaをアンインストールしない限り残ります

---

## ✅ インストール確認

インストールが正常に完了したことを確認するには：

1. **FLMを起動**
   - デスクトップまたはスタートメニューから起動

2. **正常起動の確認**
   - アプリケーションウィンドウが表示される
   - エラーメッセージが表示されない

3. **機能確認**
   - ホーム画面が表示される
   - 「新しいAPIを作成」ボタンが表示される

---

## 🆘 問題が発生した場合

インストール時に問題が発生した場合：

1. **エラーメッセージを確認**
   - エラーメッセージの内容を確認

2. **トラブルシューティングガイドを参照**
   - [トラブルシューティングガイド](./TROUBLESHOOTING.md)を参照

3. **FAQを確認**
   - [FAQ](./FAQ.md)でよくある問題を確認

4. **問題を報告**
   - [GitHub Issues](https://github.com/Unjuno/FLM/issues)で問題を報告

---

## 📋 インストール後の次のステップ

インストールが完了したら：

1. **[ユーザーガイド](./USER_GUIDE.md)**を参照して、基本的な使い方を学習
2. 最初のAPIを作成してみる
3. [FAQ](./FAQ.md)でよくある質問を確認

---

**インストールで問題が発生した場合は、お気軽にお問い合わせください！**

