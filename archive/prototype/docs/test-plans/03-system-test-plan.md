# システムテスト計画書（System Test Plan）

## 文書情報

- **プロジェクト名**: FLM
- **テストタイプ**: システムテスト（System Test）
- **作成日**: 2024年
- **バージョン**: 1.0.0

---

## 1. 概要

### 1.1 目的

システムテストは、システム全体の動作を確認するテストです。UI操作やユーザーシナリオを再現し、システムが要件を満たしているかを検証します。

### 1.2 対象範囲

- システム全体の動作確認
- ユーザーシナリオの再現
- UI操作の検証
- エンドツーエンドの機能フロー
- システムの安定性と信頼性

### 1.3 テストフレームワーク

- **推奨ツール**: Cypress、Playwright、Autify
- **現状**: Jest + jsdom（基本的なUIテスト）

---

## 2. テスト対象とテスト項目

### 2.1 ユーザーシナリオテスト

#### 2.1.1 初回起動からAPI作成までのフロー

**シナリオ**: 新規ユーザーがアプリを起動してAPIを作成する

**テスト項目**:
1. アプリ起動
   - スプラッシュスクリーンの表示
   - ホーム画面の表示
2. Ollama検出
   - Ollamaがインストールされている場合の検出
   - Ollamaがインストールされていない場合の案内表示
3. モデル選択
   - モデル一覧の表示
   - モデル検索機能
   - モデル選択
4. API作成
   - 設定入力（名前、ポート番号、認証設定）
   - API作成ボタンのクリック
   - 作成進行状況の表示
   - 作成完了の確認

**期待結果**: 
- すべてのステップが正常に完了すること
- エラーメッセージが適切に表示されること

#### 2.1.2 API管理フロー

**シナリオ**: 作成したAPIを管理する

**テスト項目**:
1. API一覧表示
   - 作成済みAPIの一覧表示
   - API状態（起動中/停止中）の表示
2. API起動
   - 起動ボタンのクリック
   - 起動状態の確認
   - エンドポイント情報の表示
3. API停止
   - 停止ボタンのクリック
   - 停止状態の確認
4. API削除
   - 削除ボタンのクリック
   - 確認ダイアログの表示
   - 削除の実行と確認

**期待結果**: 
- APIの状態が正しく反映されること
- 削除時に適切な確認が行われること

#### 2.1.3 モデル管理フロー

**シナリオ**: モデルの検索・ダウンロード・削除

**テスト項目**:
1. モデル検索
   - 検索バーでのモデル検索
   - フィルタリング機能
   - ソート機能
2. モデルダウンロード
   - ダウンロードボタンのクリック
   - 進捗状況の表示
   - ダウンロード完了の確認
3. モデル削除
   - 削除ボタンのクリック
   - 確認ダイアログの表示
   - 削除の実行と確認

**期待結果**: 
- モデル操作が正常に完了すること
- 進捗状況が適切に表示されること

### 2.2 UI操作テスト

#### 2.2.1 画面遷移

**テスト項目**:
- ホーム画面から各画面への遷移
- ナビゲーションメニューの動作
- 戻るボタンの動作
- ブラウザの戻る/進むボタン（Web版の場合）

#### 2.2.2 フォーム操作

**テスト項目**:
- テキスト入力フィールドの入力
- 選択肢（Select）の選択
- チェックボックス/ラジオボタンの操作
- バリデーションエラーの表示
- フォーム送信

#### 2.2.3 モーダル・ダイアログ

**テスト項目**:
- モーダルの表示
- モーダルの閉じる操作
- 確認ダイアログの表示と操作
- エスケープキーでの閉じる操作

### 2.3 エラーハンドリングテスト

**テスト項目**:
- ネットワークエラー時の表示
- Ollama接続エラー時の表示
- データベースエラー時の表示
- 無効な入力値のエラー表示
- エラーメッセージの分かりやすさ

### 2.4 システム安定性テスト

**テスト項目**:
- 長時間動作の安定性
- メモリリークの有無
- 複数APIの同時管理
- 大量データの処理

---

## 3. テスト実装方針

### 3.1 テスト環境

- **開発環境**: ローカル開発環境
- **テスト環境**: 専用テスト環境（可能な場合）
- **本番環境**: 本番環境での動作確認（リリース前）

### 3.2 テストデータ

- テスト用のAPIデータ
- テスト用のモデルデータ
- エラーケース用のデータ

### 3.3 テスト実行方法

#### 3.3.1 手動テスト

- テストシナリオに基づいた手動テスト
- テスト結果の記録

#### 3.3.2 自動化テスト（推奨）

- CypressやPlaywrightを使用した自動化
- CI/CDへの統合

---

## 4. テストシナリオ一覧

### 4.1 基本機能シナリオ

| シナリオID | シナリオ名 | 優先度 | 状態 |
|-----------|----------|--------|------|
| ST-001 | 初回起動からAPI作成まで | 高 | 要実装 |
| ST-002 | API管理フロー | 高 | 要実装 |
| ST-003 | モデル管理フロー | 高 | 要実装 |
| ST-004 | ログ表示フロー | 中 | 要実装 |
| ST-005 | パフォーマンス監視フロー | 中 | 要実装 |

### 4.2 UI操作シナリオ

| シナリオID | シナリオ名 | 優先度 | 状態 |
|-----------|----------|--------|------|
| ST-101 | 画面遷移テスト | 高 | 要実装 |
| ST-102 | フォーム操作テスト | 高 | 要実装 |
| ST-103 | モーダル・ダイアログテスト | 中 | 要実装 |
| ST-104 | レスポンシブデザインテスト | 低 | 要実装 |

### 4.3 エラーハンドリングシナリオ

| シナリオID | シナリオ名 | 優先度 | 状態 |
|-----------|----------|--------|------|
| ST-201 | ネットワークエラーハンドリング | 高 | 要実装 |
| ST-202 | Ollama接続エラーハンドリング | 高 | 要実装 |
| ST-203 | データベースエラーハンドリング | 中 | 要実装 |
| ST-204 | 無効な入力値のエラー表示 | 中 | 要実装 |

---

## 5. テスト実行方法

### 5.1 手動テスト

1. テストシナリオに基づいて操作を実行
2. 期待結果と実際の結果を比較
3. テスト結果を記録

### 5.2 自動化テスト（推奨）

#### Cypressを使用する場合

```bash
# Cypressのインストール
npm install --save-dev cypress

# Cypressの起動
npx cypress open

# ヘッドレスモードで実行
npx cypress run
```

#### Playwrightを使用する場合

```bash
# Playwrightのインストール
npm install --save-dev @playwright/test

# Playwrightの実行
npx playwright test
```

---

## 6. テスト実装優先順位

### 優先度: 高

1. **初回起動からAPI作成までのフロー**
   - 最も重要なユーザーシナリオ
   - 新規ユーザーの最初の体験

2. **API管理フロー**
   - 基本的な機能の動作確認

3. **エラーハンドリング**
   - ユーザー体験に影響する重要な要素

### 優先度: 中

4. **モデル管理フロー**
   - 主要機能の動作確認

5. **UI操作テスト**
   - 操作性の確認

### 優先度: 低

6. **レスポンシブデザインテスト**
   - 様々な画面サイズでの動作確認

---

## 7. テスト品質基準

### 7.1 テストの品質指標

- **網羅性**: 主要なユーザーシナリオを網羅していること
- **再現性**: 同じ条件下で常に同じ結果が得られること
- **明確性**: テストの意図が明確であること
- **保守性**: コード変更に伴いテストも容易に更新できること

### 7.2 テスト結果の評価基準

- **合格**: すべてのテスト項目が期待通りに動作すること
- **不合格**: 1つ以上のテスト項目が期待通りに動作しないこと
- **要確認**: テスト結果が不明確な場合

---

## 8. CI/CDへの統合

### 8.1 自動実行

- プルリクエスト作成時に自動実行
- マージ前に必須チェック（オプション）

### 8.2 テストレポート

- テスト結果のレポート生成
- スクリーンショットの保存（失敗時）

---

## 9. トラブルシューティング

### 9.1 よくある問題

**問題**: テストが不安定に失敗する
- **解決策**: テストの待機時間を適切に設定、リトライロジックの実装

**問題**: UI要素が見つからない
- **解決策**: セレクタの確認、適切な待機時間の設定

---

## 10. 参考資料

- [Cypress公式ドキュメント](https://docs.cypress.io/)
- [Playwright公式ドキュメント](https://playwright.dev/)
- [Autify公式ドキュメント](https://docs.autify.com/)
